<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Hao Yin" />

<meta name="date" content="2022-12-07" />

<title>Review of Answers of Assignments</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Review of Answers of Assignments</h1>
<h4 class="author">Hao Yin</h4>
<h4 class="date">2022-12-07</h4>



<div id="assignment-01" class="section level2">
<h2>Assignment 01</h2>
<hr />
<div id="exercise-3.3" class="section level3">
<h3>Exercise 3.3</h3>
<p><strong>Problem.</strong> The Pareto<span class="math inline">\((a,b)\)</span> distribution has cdf <span class="math display">\[F(x)=1-\left(\frac{b}{x}\right)^a,\quad x\geq
b&gt;0,a&gt;0.\]</span> Derive the probability inverse transformation
<span class="math inline">\(F^{-1}(U)\)</span> and use the inverse
transform method to simulate a random sample from the Pareto<span class="math inline">\((2,2)\)</span> distribution. Graph the density
histogram of the sample with the Pareto<span class="math inline">\((2,2)\)</span> density superimposed for
comparison.</p>
<p><strong>Solution.</strong> Due to the fact that if <span class="math inline">\(X\)</span> is a continuous random variable with
cdf <span class="math inline">\(F_X(x)\)</span>, then <span class="math inline">\(U=F_X(X)\sim U(0,1)\)</span>, we conduct the
<strong>inverse transform algorithm</strong> to generate random number
with Pareto distribution.</p>
<p>It can be solved that the inverse of <span class="math inline">\(F(x)\)</span> is <span class="math display">\[F^{-1}(x)=b(1-x)^{-1/a},\quad
0&lt;x&lt;1.\]</span> Besides, the derirative of <span class="math inline">\(F(x)\)</span> (i.e.Â the pdf of <span class="math inline">\(X\)</span>) is <span class="math display">\[f(x)=F&#39;(x)=\dfrac{a\cdot b^a}{x^{a+1}},\quad
x\geq b&gt;0,a&gt;0.\]</span> The algorithm is shown below.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22035</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>pareto <span class="ot">&lt;-</span> <span class="cf">function</span>(a,b) {</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate random numbers with cdf F(x)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">10000</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> b<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>u)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>a)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Draw the histogram of random numbers generated</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&#39;Pareto(&#39;</span>,a,<span class="st">&#39;,&#39;</span>,b,<span class="st">&#39;)&#39;</span>))</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Draw the density function f(x)</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(x), <span class="fl">0.1</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(y, a<span class="sc">*</span>b<span class="sc">^</span>a<span class="sc">/</span>(y<span class="sc">^</span>(a<span class="sc">+</span><span class="dv">1</span>)))</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">pareto</span>(<span class="dv">2</span>, <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It can be shown that the histogram of random numbers well fit the
therotical density of Pareto distribution.</p>
<hr />
</div>
<div id="exercise-3.7" class="section level3">
<h3>Exercise 3.7</h3>
<p><strong>Problem.</strong> Write a function to generate a random
sample of size <span class="math inline">\(n\)</span> from the Beta<span class="math inline">\((a,b)\)</span> distribution by the
acceptance-rejection method. Generate a random sample of size 1000 from
the Beta<span class="math inline">\((3,2)\)</span> distribution. Graph
the histogram of the sample with the theoretical Beta<span class="math inline">\((3,2)\)</span> density superimposed.</p>
<p><strong>Solution.</strong> Suppose <span class="math inline">\(X\sim\)</span>Beta<span class="math inline">\((a,b)\)</span>, the density of <span class="math inline">\(X\)</span> is <span class="math display">\[f(x)=\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}x^{a-1}(1-x)^{b-1},\quad
0&lt;x&lt;1.\]</span> It can be obtained that <span class="math display">\[x_0=\underset{x\in(0,1)}{\arg\max}~f(x)=\frac{a-1}{a+b-2}.\]</span>
Let reference density be <span class="math inline">\(g(x)=\pmb
1_{\{0&lt;x&lt;1\}}\)</span>, then <span class="math display">\[\frac{f(x)}{g(x)}=\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}x^{a-1}(1-x)^{b-1}\leq
c=f(x_0).\]</span></p>
<p>Based on the <strong>acceptance-rejection algorithm</strong>, our
algorithm is shown below:</p>
<ul>
<li>Generate random numbers <span class="math inline">\(U\sim
U(0,1)\)</span> and <span class="math inline">\(Y\sim g(\cdot)\)</span>,
i.e.Â <span class="math inline">\(Y\sim U(0,1)\)</span>;</li>
<li>if <span class="math inline">\(U\leq\dfrac{f(Y)}{cg(Y)}\)</span>,
then accept <span class="math inline">\(Y\)</span> and return <span class="math inline">\(X=Y\)</span>; otherwise reject <span class="math inline">\(Y\)</span> and continue.</li>
</ul>
<p><strong>Remark.</strong> <span class="math inline">\(f(\cdot)\)</span> and <span class="math inline">\(c\)</span> have a common constant <span class="math inline">\(\dfrac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}\)</span>,
so in the algorithm, we just cancel and ignore the constant.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22035</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="cf">function</span>(a,b) {</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate constant c</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  x0 <span class="ot">&lt;-</span> (a<span class="dv">-1</span>)<span class="sc">/</span>(a<span class="sc">+</span>b<span class="dv">-2</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">&lt;-</span> x0<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x0)<span class="sc">^</span>(b<span class="dv">-1</span>)  <span class="co"># constant in pdf can be ignored</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate random numbers with pdf f(x)</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (k <span class="sc">&lt;</span> n) {</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="co"># random variate from g(x)</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (x<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span>(b<span class="dv">-1</span>) <span class="sc">/</span> c <span class="sc">&gt;</span> u) {</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>      <span class="co"># accept x</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>      y[k] <span class="ot">&lt;-</span> x</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Draw the histogram of random numbers generated</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(y, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&#39;Beta(&#39;</span>,a,<span class="st">&#39;,&#39;</span>,b,<span class="st">&#39;)&#39;</span>), <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Draw the density function f(x)</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.01</span>)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(z, z<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>z)<span class="sc">^</span>(b<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">gamma</span>(a<span class="sc">+</span>b)<span class="sc">/</span><span class="fu">gamma</span>(a)<span class="sc">/</span><span class="fu">gamma</span>(b))</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="fu">beta</span>(<span class="dv">3</span>, <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It can be shown that the histogram of random numbers well fit the
therotical density of Beta distribution.</p>
<hr />
</div>
<div id="exercise-3.12" class="section level3">
<h3>Exercise 3.12</h3>
<p><strong>Problem.</strong> Simulate a continuous Exponential-Gamma
mixture. Suppose that the rate parameter <span class="math inline">\(\Lambda\)</span> has Gamma<span class="math inline">\((r,\beta)\)</span> distribution and <span class="math inline">\(Y\)</span> has Exp<span class="math inline">\((\Lambda)\)</span> distribution. That is, <span class="math inline">\((Y|\Lambda=\lambda)\sim f_Y(y|\lambda)=\lambda{\rm
e}^{-\lambda y}\pmb 1_{\{y\geq 0\}}\)</span>. Generate 1000 random
observations from this mixture with <span class="math inline">\(r=4\)</span> and <span class="math inline">\(\beta=2\)</span>.</p>
<p><strong>Solution.</strong> According to the mixture model, we first
generate <span class="math inline">\(\Lambda\)</span> from Gamma<span class="math inline">\((r,\beta)\)</span> distribution, then generate
<span class="math inline">\(Y\)</span> from Exp<span class="math inline">\((\Lambda)\)</span> distribution. The code is shown
below.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22035</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>expgamma <span class="ot">&lt;-</span> <span class="cf">function</span>(r, beta) {</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate random numbers from the mixture</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, r, beta)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, x)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="dv">4</span>; beta <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>rnd <span class="ot">=</span> <span class="fu">expgamma</span>(r, beta)</span></code></pre></div>
<p>1000 random observations from the mixture are stored in the variable
<code>rnd</code>.</p>
<hr />
</div>
<div id="exercise-3.13" class="section level3">
<h3>Exercise 3.13</h3>
<p><strong>Problem.</strong> It can be shown that the mixture in
Exercise 3.12 has a Pareto distribution with cdf <span class="math display">\[F(y)=1-\left(\frac{\beta}{\beta+y}\right)^r,\quad
y\geq0.\]</span> (This is an alternative parameterization of the Pareto
cdf given in Exercise 3.3.) Generate 1000 random observations from the
mixture with <span class="math inline">\(r=4\)</span> and <span class="math inline">\(\beta=2\)</span>. Compare the empirical and
theoretical (Pareto) distributions by graphing the density histogram of
the sample and superimposing the Pareto density curve.</p>
<p><strong>Solution.</strong></p>
<p>Given the cdf <span class="math inline">\(F(y)\)</span>, the density
function of <span class="math inline">\(Y\sim F(y)\)</span> is <span class="math display">\[f(y)=\frac{r\cdot\beta^r}{(\beta+y)^{r+1}},\quad
y\geq0.\]</span> So we can draw the histogram of random numbers we got
before and the density function above.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw the histogram of random numbers generated</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(rnd, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&#39;Pareto(&#39;</span>,r,<span class="st">&#39;,&#39;</span>,beta,<span class="st">&#39;)&#39;</span>), <span class="at">xlab =</span> <span class="st">&quot;y&quot;</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw the density function f(y)</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(rnd), <span class="fl">0.01</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y, r<span class="sc">*</span>beta<span class="sc">^</span>r<span class="sc">/</span>(beta<span class="sc">+</span>y)<span class="sc">^</span>(r<span class="sc">+</span><span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It can be shown that the histogram of random numbers well fit the
therotical density of Pareto distribution.</p>
<p><strong>Appendix.</strong> Here I will give the proof of Exercise
3.13, you might go through it quickly if you are not so interested in
it. Given <span class="math inline">\(\Lambda\sim\Gamma(r,\beta)\)</span>, the density
of <span class="math inline">\(\Lambda\)</span> is <span class="math display">\[\pi(\lambda)=\frac{\beta^r}{\Gamma(r)}\lambda^{r-1}{\rm
e}^{-\beta\lambda},\quad\lambda&gt;0.\]</span></p>
<p>Hence, based on bayes formula, <span class="math display">\[f(y)=\int_0^{\infty}f_Y(y|\lambda)\pi(\lambda){\rm
d}\lambda=\int_0^{\infty}\frac{\beta^r}{\Gamma(r)}\lambda^{r}{\rm
e}^{-\lambda(\beta+y)}{\rm
d}\lambda=\frac{\beta^r}{\Gamma(r)}\cdot\frac{\Gamma(r+1)}{(\beta+y)^{r+1}}=\frac{r\cdot\beta^r}{(\beta+y)^{r+1}},\quad
y\geq0.\]</span> Q.E.D.</p>
<hr />
</div>
</div>
<div id="assignment-02" class="section level2">
<h2>Assignment 02</h2>
<hr />
<div id="fast-sort-algorithm" class="section level3">
<h3>Fast sort algorithm</h3>
<ul>
<li>For <span class="math inline">\(n=10^4, 2\times 10^4, 4\times 10^4,
6\times 10^4, 8\times 10^4\)</span>, apply the fast sorting algorithm to
randomly permuted numbers of <span class="math inline">\(1,\dots,n\)</span>.</li>
<li>Calculate computation time averaged over 100 simulations, denoted by
<span class="math inline">\(a_n\)</span>.</li>
<li>Regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n:=n\log(n)\)</span>, and graphically show the
results (scatter plot and regression line).</li>
</ul>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22035</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This part is copied from bb</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>quick_sort <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  num <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(num<span class="sc">==</span><span class="dv">0</span><span class="sc">||</span>num<span class="sc">==</span><span class="dv">1</span>){<span class="fu">return</span>(x)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> x[<span class="dv">1</span>]</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> x[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    lower <span class="ot">&lt;-</span> y[y<span class="sc">&lt;</span>a]</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    upper <span class="ot">&lt;-</span> y[y<span class="sc">&gt;=</span>a]</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">quick_sort</span>(lower),a,<span class="fu">quick_sort</span>(upper)))}<span class="co">#form a loop</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>test<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fl">1e4</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">quick_sort</span>(test))[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## user.self 
##      0.02</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">quick_sort</span>(test)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># show the result of fast sort algorithm</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>test[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>test[<span class="dv">9991</span><span class="sc">:</span><span class="dv">10000</span>]</span></code></pre></div>
<pre><code>##  [1]  9991  9992  9993  9994  9995  9996  9997  9998  9999 10000</code></pre>
<p>As is shown above, the fast sort algorithm is applied on the sequence
<code>test</code> successfully.</p>
<p>Then we write a function to calculate the computation time denoted by
<span class="math inline">\(a_n\)</span>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22035</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1e4</span>, <span class="fl">2e4</span>, <span class="fl">4e4</span>, <span class="fl">6e4</span>, <span class="fl">8e4</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>computation_time <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">22035</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    test <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    t[i] <span class="ot">&lt;-</span> <span class="fu">system.time</span>(<span class="fu">quick_sort</span>(test))[<span class="dv">1</span>]</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  t_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(t)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(t_mean)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>an <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">computation_time</span>(n[<span class="dv">1</span>]),<span class="fu">computation_time</span>(n[<span class="dv">2</span>]),<span class="fu">computation_time</span>(n[<span class="dv">3</span>]),</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>       <span class="fu">computation_time</span>(n[<span class="dv">4</span>]),<span class="fu">computation_time</span>(n[<span class="dv">5</span>]))</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>an</span></code></pre></div>
<pre><code>## [1] 0.0162 0.0347 0.0735 0.1093 0.1512</code></pre>
<p>Now we fit a linear model with control variable <span class="math inline">\(t_n\)</span> and response <span class="math inline">\(a_n\)</span>, and draw a scatter plot and the red
regression line.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>tn <span class="ot">&lt;-</span> n<span class="sc">*</span><span class="fu">log</span>(n)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>mylm <span class="ot">&lt;-</span> <span class="fu">lm</span>(an<span class="sc">~</span>tn)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">1e6</span>,<span class="at">length.out=</span><span class="dv">100</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coefficients</span>(mylm)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tn, an, <span class="at">main=</span><span class="st">&quot;Regression line&quot;</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, b[<span class="dv">1</span>]<span class="sc">+</span>b[<span class="dv">2</span>]<span class="sc">*</span>x, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<hr />
</div>
<div id="exercise-5.6" class="section level3">
<h3>Exercise 5.6</h3>
<p>In Example 5.7 the control variate approach was illustrated for Monte
Carlo integration of <span class="math display">\[
\theta=\int_0^1 e^x dx.
\]</span> Now consider the antithetic variate approach. Compute <span class="math inline">\(Cov(e^U,e^{1-U})\)</span> and <span class="math inline">\(Var(e^U+e^{1-U})\)</span>, where <span class="math inline">\(U\sim {\rm Uniform}(0,1)\)</span>. What is the
percent reduction in variance of <span class="math inline">\(\hat{\theta}\)</span> that can be achieved using
antithetic variates (compared with simple MC)?</p>
<p><strong>Solution.</strong> Since <span class="math inline">\(U\sim{\rm Uniform}(0,1)\)</span>, we have <span class="math inline">\(E(e^U)=e-1=E(e^{U-1})\)</span>, and <span class="math inline">\(E(e^{2U})=(e^2-1)/2\)</span>. Hence, we have <span class="math display">\[
\begin{aligned}
Cov\left(e^U,e^{1-U}\right)&amp;=E\left(e^Ue^{1-U}\right)-E\left(e^U\right)E\left(e^{1-U}\right)
\\
&amp;=e-(e-1)^2 \\
&amp;= -0.2342106,
\end{aligned}
\]</span> and <span class="math display">\[
\begin{aligned}
Var\left(e^U+e^{1-U}\right)&amp;=E\left(e^U+e^{1-U}\right)^2-\left[E\left(e^U+e^{1-U}\right)\right]^2
\\
&amp;=E\left(e^{2U}+e^{2-2U}+2e\right)-4(e-1)^2 \\
&amp;=e^2-1+2e-4(e-1)^2 \\
&amp;=-3e^2+10e-5 \\
&amp;=0.01564999.
\end{aligned}
\]</span></p>
<p>The simple MC estimator of <span class="math inline">\(\theta\)</span> is <span class="math inline">\(\hat\theta_1=\frac{1}{m}\sum_{i=1}^m
e^{u_i}\)</span>, where <span class="math inline">\(u_i,i=1,\dots,m\)</span> is an i.i.d sample of
<span class="math inline">\({\rm Uniform(0,1)}\)</span>. The antithetic
variates estimator is <span class="math inline">\(\hat\theta_2=\frac{1}{m}\sum_{i=1}^m
\left(\frac{e^{u_i}+e^{1-u_i}}{2}\right)\)</span>. By the i.i.d
condition, we derive that <span class="math inline">\(Var(\hat\theta_1)=Var(e^U)/m\)</span>, where <span class="math display">\[
\begin{aligned}
Var(e^U)&amp;=E\left(e^{2U}\right)-\left[E(e^U)\right]^2 \\
&amp;=(e^2-1)/2-(e-1)^2 \\
&amp;=0.2420356,
\end{aligned}
\]</span> and <span class="math inline">\(Var(\hat\theta_2)=Var(e^U+e^{1-U})/4m\)</span>.
Now we can compute the percent reduction <span class="math display">\[
\begin{aligned}
100\left(\frac{Var(\hat\theta_1)-Var(\hat\theta_2)}{Var(\hat\theta_1)}\right)&amp;=100\left(\frac{0.2420356-0.01564999/4}{0.2420356}\right)
\\
&amp;=98.38.
\end{aligned}
\]</span></p>
<hr />
</div>
<div id="exercise-5.7" class="section level3">
<h3>Exercise 5.7</h3>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach
and by the simple Monte Carlo method. Compute an empirical estimate of
the percent reduction in variance using the antithetic variate. Compare
the result with the theoretical value from Exercise 5.6.</p>
<p><strong>Solution.</strong> In this simulation, we generate an i.i.d
sample of <span class="math inline">\({\rm Uniform}(0,1)\)</span> with
size <span class="math inline">\(10^4\)</span>. Then we compute the
simple MC estimator <span class="math inline">\(\hat\theta_1\)</span>
and antithetic variables approach estimator <span class="math inline">\(\hat\theta_2\)</span>. Next, we compute the sample
variance and plug in to obtain the empirical estimator of percent
reduction in variance.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22035</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>theta1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">exp</span>(U))                <span class="co"># simple MC estimator</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>theta2 <span class="ot">&lt;-</span> <span class="fu">mean</span>((<span class="fu">exp</span>(U)<span class="sc">+</span><span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>U))<span class="sc">/</span><span class="dv">2</span>)   <span class="co"># antithetic variables estimator</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>var1 <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">exp</span>(U))                   <span class="co"># sample variance of simple MC</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>var2 <span class="ot">&lt;-</span> <span class="fu">var</span>((<span class="fu">exp</span>(U)<span class="sc">+</span><span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>U))<span class="sc">/</span><span class="dv">2</span>)      <span class="co"># sample variance of antithetic variables</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>theta1</span></code></pre></div>
<pre><code>## [1] 1.721064</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>theta2</span></code></pre></div>
<pre><code>## [1] 1.718899</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span><span class="sc">*</span>(var1<span class="sc">-</span>var2)<span class="sc">/</span>var1      <span class="co"># empirical estimator of percent reduction of variance</span></span></code></pre></div>
<pre><code>## [1] 98.36144</code></pre>
<p>As is shown above, we obtain <span class="math inline">\(\hat\theta_1=1.719891\)</span> and <span class="math inline">\(\hat\theta_2=1.71941\)</span>, both are closed to
the theoretical value <span class="math inline">\(e-1=1.71828\)</span>.
The empirical estimate of percent reduction is <span class="math inline">\(98.38075\)</span>, which is also closed to the
theoretical value <span class="math inline">\(98.3835\)</span> obtained
in exercise 5.6.</p>
<hr />
</div>
</div>
<div id="assignment-03" class="section level2">
<h2>Assignment 03</h2>
<hr />
<div id="exercise-5.13" class="section level3">
<h3>Exercise 5.13</h3>
<p>Find two functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are âcloseâ to <span class="math display">\[
g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},\quad x&gt;1.
\]</span> Which of your two importance functions should produce the
smaller variance in estimating <span class="math display">\[
\int_1^\infty \frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}\,dx
\]</span> by importance sampling? Explain.</p>
<p><strong>Solution.</strong> Firstly, let <span class="math inline">\(f_1\)</span> be the standard normal density, that
is <span class="math display">\[
f_1(x)=\frac{1}{\sqrt{2\pi}}e^{-x^2/2}.
\]</span> We apply the important sampling method by <span class="math inline">\(f_1\)</span> as below.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22035</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">dnorm</span>(x)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>theta.hat1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f1</span>(x))</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>var1 <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f1</span>(x))</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(theta.hat1, var1)</span></code></pre></div>
<pre><code>##      theta.hat1     var1
## [1,]  0.3887423 1.196787</code></pre>
<p>As is shown above, the variance is very large, which implies that the
standard normal density is not a good importance function.</p>
<p>Next, we choose gamma distribution as importance function, that is
<span class="math display">\[
f_2(x)=\frac{\lambda^r}{\Gamma(r)}x^{r-1}e^{-\lambda x},\quad x&gt;0,
\]</span> where we set <span class="math inline">\(\lambda=1\)</span>
and <span class="math inline">\(r=3\)</span> (we cannot guarantee that
this is the optimal setting, but it seems much better to cover <span class="math inline">\(x^2\)</span> than <span class="math inline">\(e^{-x^2/2}\)</span>, which would be shown in the
figures below).</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22035</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(m,<span class="at">shape =</span> <span class="dv">3</span>,<span class="at">rate =</span> <span class="dv">1</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">dgamma</span>(x, <span class="at">shape =</span> <span class="dv">3</span>, <span class="at">rate =</span> <span class="dv">1</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>theta.hat2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">g</span>(y)<span class="sc">/</span><span class="fu">f2</span>(y))</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>var2 <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">g</span>(y)<span class="sc">/</span><span class="fu">f2</span>(y))</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(theta.hat2, var2)</span></code></pre></div>
<pre><code>##      theta.hat2      var2
## [1,]  0.4006601 0.2082169</code></pre>
<p>We see that <span class="math inline">\(f_2\)</span> produces much
smaller variance than <span class="math inline">\(f_1\)</span>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="fl">0.05</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>gs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">g</span>(x)<span class="sc">==</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>e<span class="sc">^</span>{<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>}<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)),</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(f[<span class="dv">1</span>](x)<span class="sc">==</span>e<span class="sc">^</span>{<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>}<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)),</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">expression</span>(f[<span class="dv">2</span>](x)<span class="sc">==</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>e<span class="sc">^</span>{<span class="sc">-</span>x}<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co">#figure (a)</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d, <span class="fu">g</span>(d), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>),</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="dv">1</span>,<span class="at">main=</span><span class="st">&#39;(A)&#39;</span>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(d, <span class="fu">f1</span>(d), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(d, <span class="fu">f2</span>(d), <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> gs, <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">inset =</span> <span class="fl">0.02</span>,<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="co">#figure (b)</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d, <span class="fu">g</span>(d)<span class="sc">/</span><span class="fu">f1</span>(d), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>),</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">&quot;(B)&quot;</span>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(d, <span class="fu">g</span>(d)<span class="sc">/</span><span class="fu">f2</span>(d), <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="dv">3</span>)</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> gs[<span class="sc">-</span><span class="dv">1</span>], <span class="at">lty =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">inset =</span> <span class="fl">0.02</span>, <span class="at">col =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As is shown in the figure (B), <span class="math inline">\(g(x)/f_1(x)\)</span> tends to infinity, while
<span class="math inline">\(g(x)/f_2(x)\)</span> tends to zero. Thatâs
why <span class="math inline">\(f_2\)</span> performs much better than
<span class="math inline">\(f_1\)</span> in the importance sampling
procedure.</p>
<hr />
</div>
<div id="exercise-5.15" class="section level3">
<h3>Exercise 5.15</h3>
<p>Obtain the stratified importance sampling estimate in Example 5.13
and compare it with the result of Example 5.10</p>
<p><strong>Solution.</strong> In Example 5.10 our best result was
obtained with importance function <span class="math inline">\(f(x)=e^{-x}/(1-e^{-1}),0&lt;x&lt;1\)</span>. Now
divide the interval to five subintervals, such that each interval has
probability <span class="math inline">\(1/5\)</span> under the density
function <span class="math inline">\(f\)</span>.</p>
<p>Denote the partition points by <span class="math inline">\(a_i,i=0,1,\dots,5\)</span>, where <span class="math inline">\(a_0=0\)</span> and <span class="math inline">\(a_5=1\)</span>. Since <span class="math display">\[
\int_{a_i}^{a_{i+1}}\frac{e^{-x}}{1-e^{-1}}=\frac{1}{5},\quad
i=0,1,2,3,4,
\]</span> we have <span class="math display">\[
a_{i+1}=-\log\left(e^{-a_i}-\frac15+\frac15 e^{-1}\right),\quad
i=0,1,2,3.
\]</span> Hence we may compute the partition points with R code.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>a[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="fl">0.8</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>a[<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  a[i] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>a[i<span class="dv">-1</span>])<span class="sc">-</span><span class="fl">0.2</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>a</span></code></pre></div>
<pre><code>## [1] 0.1351603 0.2914869 0.4768628 0.7046055 1.0000000</code></pre>
<p>Next, we generate <span class="math inline">\(m=2000\)</span>
replicates in each subinterval by inverse transform method. Denote the
p.d.f. and c.d.f. on interval <span class="math inline">\([a_{i-1},a_i)\)</span> by <span class="math inline">\(f_i\)</span> and <span class="math inline">\(F_i\)</span>, <span class="math inline">\(i=1,\dots,5\)</span>. We can derive that <span class="math display">\[
f_i(x)=\frac{5e^{-x}}{1-e^{-1}},\quad a_{i-1}\le x&lt; a_i,
\]</span> and <span class="math display">\[
F_i(x)=\frac{5}{1-e^{-1}}\left(e^{-a_{i-1}}-e^{-x}\right){\rm
I}(a_{i-1}\le x&lt; a_i)+{\rm I}(x\ge a_i).
\]</span> Then <span class="math display">\[
F_i^{-1}(U)=-\log\left(e^{-a_{i-1}}-\frac{1-e^{-1}}{5}U\right),\quad
0&lt;U&lt;1.
\]</span> Here we omit the values <span class="math inline">\(\{0,1\}\)</span> since <span class="math inline">\(P(U\in\{0,1\})=0\)</span>.</p>
<p>Now we run R code to obtain the stratified importance sampling
estimate.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22035</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">runif</span>(M)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="sc">-</span>x <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> (x <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">*</span> (x <span class="sc">&lt;</span> <span class="dv">1</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co"># density function on each subinterval</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="dv">5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="co"># inverse of distribution functions</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>F1_inv <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>x<span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>F2_inv <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>a[<span class="dv">1</span>])<span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>x<span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>F3_inv <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>a[<span class="dv">2</span>])<span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>x<span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>F4_inv <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>a[<span class="dv">3</span>])<span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>x<span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>F5_inv <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>a[<span class="dv">4</span>])<span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>x<span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a><span class="co"># samples generated by inverse transform method</span></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">2000</span>, <span class="at">ncol =</span> <span class="dv">5</span>)</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>x[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">F1_inv</span>(U[<span class="dv">1</span><span class="sc">:</span><span class="dv">2000</span>])</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>x[,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">F2_inv</span>(U[<span class="dv">2001</span><span class="sc">:</span><span class="dv">4000</span>])</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>x[,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">F3_inv</span>(U[<span class="dv">4001</span><span class="sc">:</span><span class="dv">6000</span>])</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>x[,<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">F4_inv</span>(U[<span class="dv">6001</span><span class="sc">:</span><span class="dv">8000</span>])</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>x[,<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">F5_inv</span>(U[<span class="dv">8001</span><span class="sc">:</span><span class="dv">10000</span>])</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a><span class="co"># estimator of mean and variance on each subinterval</span></span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>sigma2.hat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>  theta.hat[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">g</span>(x[,i])<span class="sc">/</span><span class="fu">f</span>(x[,i]))</span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>  sigma2.hat[i] <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">g</span>(x[,i])<span class="sc">/</span><span class="fu">f</span>(x[,i]))</span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a><span class="co"># show the result</span></span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">sum</span>(theta.hat)</span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(sigma2.hat)</span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(sigma2)</span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(theta, sigma2,se)</span></code></pre></div>
<pre><code>##          theta       sigma2          se
## [1,] 0.5246916 8.766118e-05 0.009362755</code></pre>
<p>As is shown above, we obtain the estimator <span class="math inline">\(\hat{\theta}^{SI}=0.525\)</span> with variance
<span class="math inline">\(8.8\times 10^{-5}\)</span> and standard
error <span class="math inline">\(0.00938\)</span>. The best result
obtained in Example 5.10 is <span class="math inline">\(\hat\theta=0.525\)</span> with standard error
<span class="math inline">\(0.0966\)</span>. It is clear that the
standard error of the stratified importance sampling method is much
smaller than the importance sampling method, which shows the power of
the stratified sampling procedure.</p>
<hr />
</div>
</div>
<div id="assignment-04" class="section level2">
<h2>Assignment 04</h2>
<hr />
<div id="exercise-6.4" class="section level3">
<h3>Exercise 6.4</h3>
<p>Suppose that <span class="math inline">\(X_1,\dots, X_n\)</span> are
a random sample from a from a log normal distribution with unknown
parameters. Construct a <span class="math inline">\(95\%\)</span>
confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain
an empirical estimate of the confidence level.</p>
<p><strong>Solution.</strong></p>
<p>The log normal distribution has density <span class="math display">\[
f(x)=\frac{1}{\sqrt{2\pi}\sigma x}e^{-(\log(x)-\mu)^2/2\sigma^2},
\]</span> where <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> are the mean and standard
deviation of the logarithm. Moreover, if <span class="math inline">\(X\sim LN(\mu,\sigma^2)\)</span>, then <span class="math inline">\(\ln X\sim N(\mu,\sigma^2)\)</span>. Hence, the
confidence interval of level <span class="math inline">\(\alpha\)</span>
can be formulated by <span class="math display">\[
[\bar{Y}-t_{n-1}(\alpha/2)S_y/\sqrt{n},\bar{Y}+t_{n-1}(\alpha/2)S_y/\sqrt{n}]
\]</span></p>
<p>We first write functions to generate a sample and construct the
confidence interval based the sample and given confidence level.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sample generation function</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>sample_gen <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">mu=</span><span class="dv">0</span>, <span class="at">sigma=</span><span class="dv">1</span>){</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="at">n=</span>n, <span class="at">meanlog =</span> mu, <span class="at">sdlog =</span> sigma)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># data analysis function (constuct a confidence interval with level alpha)</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>CI <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">alpha=</span><span class="fl">0.05</span>){</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">log</span>(x)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  mu.hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  sigma2.hat <span class="ot">&lt;-</span> <span class="fu">var</span>(y)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  lower <span class="ot">&lt;-</span> mu.hat<span class="sc">+</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(sigma2.hat<span class="sc">/</span>n)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  upper <span class="ot">&lt;-</span> mu.hat<span class="sc">+</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(sigma2.hat<span class="sc">/</span>n)</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="st">&quot;lower.bound&quot;</span><span class="ot">=</span>lower,<span class="st">&quot;upper.bound&quot;</span><span class="ot">=</span>upper))</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Then we apply our function under the setting <span class="math inline">\(n=10,\mu=0,\sigma^2=1\)</span>, and repeat for
<span class="math inline">\(m=10000\)</span> times to estimate the
coverage probability (CP).</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22035</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> upper <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  Sample <span class="ot">&lt;-</span> <span class="fu">sample_gen</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">mu=</span><span class="dv">0</span>, <span class="at">sigma=</span><span class="dv">1</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  lower[i] <span class="ot">&lt;-</span> <span class="fu">CI</span>(<span class="at">x=</span>Sample)[<span class="dv">1</span>]</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  upper[i] <span class="ot">&lt;-</span> <span class="fu">CI</span>(<span class="at">x=</span>Sample)[<span class="dv">2</span>]</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>CP <span class="ot">&lt;-</span> <span class="fu">mean</span>((lower<span class="sc">&lt;</span><span class="dv">0</span>)<span class="sc">&amp;</span>(upper<span class="sc">&gt;</span><span class="dv">0</span>))</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;CP =&quot;</span>,CP)</span></code></pre></div>
<pre><code>## CP = 0.9541</code></pre>
<p>Finally, we clean the memory of the variables.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<hr />
</div>
<div id="exercise-6.8" class="section level3">
<h3>Exercise 6.8</h3>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the F
test of equal variance, at significance level <span class="math inline">\(\hat\alpha \doteq 0.055\)</span>. Compare the
power of the Count Five test and F test for small, medium, and large
sample sizes. (Recall that the F test is not applicable for non-normal
distributions.)</p>
<p><strong>Solution.</strong> At the beginning, we write the functions
of âCount Fiveâ test and F test.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The functions of &quot;Count Five&quot; test is copied from the book</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>maxout <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)))</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>count5test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.integer</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)) <span class="sc">&gt;</span> <span class="dv">5</span>))</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>F.test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">alpha=</span><span class="fl">0.05</span>){</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>  S1 <span class="ot">&lt;-</span> <span class="fu">var</span>(x)</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>  S2 <span class="ot">&lt;-</span> <span class="fu">var</span>(y)</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>  f <span class="ot">&lt;-</span> S2<span class="sc">/</span>S1</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.integer</span>(f<span class="sc">&gt;</span><span class="fu">qf</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df1 =</span> n<span class="dv">-1</span>,<span class="at">df2 =</span> m<span class="dv">-1</span>)<span class="sc">||</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>                           f<span class="sc">&lt;</span><span class="fu">qf</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df1 =</span> n<span class="dv">-1</span>,<span class="at">df2 =</span> m<span class="dv">-1</span>)))</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Then we write functions to compute the empirical power of âCount
Fiveâ test and F test.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>power_count5test <span class="ot">&lt;-</span> <span class="cf">function</span>(m, n1, n2, sigma1, sigma2){</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="fu">replicate</span>(m, <span class="at">expr=</span>{</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, <span class="dv">0</span>, sigma1)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2, <span class="dv">0</span>, sigma2)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count5test</span>(x, y)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  }))</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>power_F.test <span class="ot">&lt;-</span> <span class="cf">function</span>(m, n1, n2, sigma1, sigma2){</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="fu">replicate</span>(m, <span class="at">expr =</span> {</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, <span class="dv">0</span>, sigma1)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2, <span class="dv">0</span>, sigma2)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">F.test</span>(x, y, <span class="at">alpha =</span> <span class="fl">0.055</span>)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  }))</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now we compute the powers of the two tests under different sample
sizes, that is <span class="math inline">\(n_1=n_2=20,100,1000\)</span>,
and we summarize the results in the table below.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22035</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># generate samples under H1 to estimate power</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>result1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>result2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">100</span>,<span class="dv">1000</span>)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  result1[i] <span class="ot">&lt;-</span> <span class="fu">power_count5test</span>(m, <span class="at">n1=</span>n[i], <span class="at">n2=</span>n[i], sigma1, sigma2)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  result2[i] <span class="ot">&lt;-</span> <span class="fu">power_F.test</span>(m, <span class="at">n1=</span>n[i], <span class="at">n2=</span>n[i], sigma1, sigma2)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">data.frame</span>(<span class="st">&quot;size&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">100</span>,<span class="dv">200</span>),<span class="st">&quot;count five test&quot;</span><span class="ot">=</span>result1,</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;F test&quot;</span><span class="ot">=</span>result2),<span class="at">align=</span><span class="st">&quot;c&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">size</th>
<th align="center">count.five.test</th>
<th align="center">F.test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">20</td>
<td align="center">0.3183</td>
<td align="center">0.4243</td>
</tr>
<tr class="even">
<td align="center">100</td>
<td align="center">0.8542</td>
<td align="center">0.9822</td>
</tr>
<tr class="odd">
<td align="center">200</td>
<td align="center">0.9971</td>
<td align="center">1.0000</td>
</tr>
</tbody>
</table>
<p>From the table we can see that the power of F test is higher than the
power of âCount Fiveâ test when the sample is normal distributed.</p>
<p>Finally, we clean the memory of the variables.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<hr />
</div>
<div id="discussion" class="section level3">
<h3>Discussion</h3>
<ul>
<li>If we obtain the powers for two methods under a particular
simulation setting with <span class="math inline">\(10,000\)</span>
experiments: say, <span class="math inline">\(0.651\)</span> for one
method and <span class="math inline">\(0.676\)</span> for another
method. Can we say the powers are different at <span class="math inline">\(0.05\)</span> level?</li>
<li>What is the corresponding hypothesis test problem?</li>
<li>Which test can we use? Z-test, two-sample t-test, paired t-test or
McNemar test? Why?</li>
<li>Please provide the least necessary information for hypothesis
testing.</li>
</ul>
<p><strong>Solution.</strong> Denote the power of the two test by <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2\)</span>, then the corresponding hypothesis
test problem is <span class="math display">\[
H_0:p_2-p_1=0\leftrightarrow H_1:p_2-p_1\neq 0.
\]</span> Now from the simulation we obtain that <span class="math inline">\(\hat p_1=0.651\)</span> and <span class="math inline">\(\hat p_2=0.676\)</span>, where the number of
trials is <span class="math inline">\(n=10000\)</span>.</p>
<p>Naturally we may assume that the <span class="math inline">\(10000\)</span> experiments are independent.
However, in each experiment, the results of the two tests are based on
the same data and parameters, thus they are not independent with each
other. Namely, we have obtained <span class="math inline">\(10000\)</span> paired data in the simulation.</p>
<p>Consequently, we cannot use two-sample t-test and Z-test (the large
sample version of two-sample t-test), because the two samples
corresponding to the two tests are not independent. Unfortunately, if we
want to apply paired t-test or McNemar test (an equivalent of paired
t-test for binary response data), the result of each experiment, namely,
whether the two tests reject or accept <span class="math inline">\(H_0\)</span>, is required.</p>
<p>In conclusion, we can use paired t-test or McNemar test provided the
result of each experiment. That means we cannot say the powers are
different at <span class="math inline">\(0.05\)</span> level if we only
know that <span class="math inline">\(\hat p_1=0.651\)</span> and <span class="math inline">\(\hat p_2=0.676\)</span> with size <span class="math inline">\(n=10000\)</span>. Note that it is more complicated
than testing the equivalence of type-I error, since the <strong>real
distribution of the data is unknown</strong> under the alternative
hypothesis!</p>
<hr />
</div>
</div>
<div id="assignment-05" class="section level2">
<h2>Assignment 05</h2>
<hr />
<div id="exercises-7.4" class="section level3">
<h3>Exercises 7.4</h3>
<p><strong>Problem</strong> Refer to the air-conditioning data set
<strong>aircondit</strong> provided in the boot package. The 12
observations are the times in hours between failures of air-conditioning
equipment [63, Example 1.1]: <span class="math display">\[3, 5, 7, 18,
43, 85, 91, 98, 100, 130, 230, 487.\]</span> Assume that the times
between failures follow an exponential model Exp(<span class="math inline">\(\lambda\)</span>). Obtain the MLE of the hazard
rate <span class="math inline">\(\lambda\)</span> and use bootstrap to
estimate the bias and standard error of the estimate.</p>
<p><strong>Solution</strong> The <strong>aircondit</strong> data is a
data frame with 1 variable, so aircondit[1] extracts the 12
observations. As the times between failures follow an exponential model
Exp(Î»), the Log-likelihood function is <span class="math display">\[ln[l(X|\lambda)]=-\lambda\sum_{i=1}^nx_i+nln(\lambda)\]</span>
therefore we have</p>
<p><span class="math display">\[
\begin{aligned}
&amp; \frac{\partial ln[l(X|\lambda)]}{\partial
\lambda}=-\sum_{i=1}^nx_i+\frac{n}{\lambda} \\
&amp; \frac{\partial ln[l(X|\lambda)]}{\partial \lambda}=0 \\
&amp; \Rightarrow -\sum_{i=1}^nx_i+\frac{n}{\lambda}=0\\
&amp; \Rightarrow \hat{\lambda}=\frac{1}{\bar{x}}
\end{aligned}
\]</span></p>
<p>Hence the MLE of <span class="math inline">\(\lambda\)</span> is
<span class="math inline">\(1/\bar{x}\)</span>. We can use
<strong>boot</strong> package to print the estimates of bias and
standard error. As what we discussed in class, we can use separate
functions for data generation, data analysis and result reporting. In
this exercise, define function <strong>Sample1</strong> to extract data,
function <strong>Rate1</strong> to construct the statistic and function
<strong>Result1</strong> to report the result.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>Sample1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  samp <span class="ot">&lt;-</span> aircondit[x]</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  samp</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>Rate1 <span class="ot">&lt;-</span> <span class="cf">function</span>(samp, i) {</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  rat <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(<span class="fu">as.matrix</span>(samp[i, ]))</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  rat</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>Result1 <span class="ot">&lt;-</span> <span class="cf">function</span>(samp,func,Rr){</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  bo <span class="ot">&lt;-</span> <span class="fu">boot</span>(samp, <span class="at">statistic =</span> func, <span class="at">R =</span> Rr)</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(bo)</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22035</span>)</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>samp <span class="ot">&lt;-</span> <span class="fu">Sample1</span>(<span class="dv">1</span>)</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>resu <span class="ot">&lt;-</span> <span class="fu">Result1</span>(samp,Rate1,<span class="dv">2000</span>)</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = samp, statistic = func, R = Rr)
## 
## 
## Bootstrap Statistics :
##       original      bias    std. error
## t1* 0.00925212 0.001363932 0.004344902</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>boot)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>From the result above, we can see that the the bias of the estimate
is 0.001369 and standard error of the estimate is 0.004986.</p>
<hr />
</div>
<div id="exercises-7.5" class="section level3">
<h3>Exercises 7.5</h3>
<p><strong>Problem</strong> Refer to Exercise 7.4. Compute 95% bootstrap
confidence intervals for the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic,
percentile, and BCa methods. Compare the intervals and explain why they
may differ.</p>
<p><strong>Solution</strong> Similarly, use
<strong>aircondit[1]</strong> to extract the data. In this exercise,
define function <strong>Sample2</strong> to extract data, function
<strong>Meant2</strong> to construct the statistic and function
<strong>Result2</strong> to report the result.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>Sample2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  samp <span class="ot">&lt;-</span> aircondit[x]</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  samp</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>Meant2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, i) {</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  mea <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.matrix</span>(x[i, ]))</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  mea</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>Result2 <span class="ot">&lt;-</span> <span class="cf">function</span>(samp,func,Rr){</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  bo <span class="ot">&lt;-</span> <span class="fu">boot</span>(samp, <span class="at">statistic =</span> func, <span class="at">R =</span> Rr)</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>  re <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(bo, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;perc&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;bca&quot;</span>))</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(bo)</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(re)</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(bo<span class="sc">$</span>t, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(bo<span class="sc">$</span>t0, <span class="dv">0</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>  bo</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22035</span>)</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>samp <span class="ot">&lt;-</span> <span class="fu">Sample2</span>(<span class="dv">1</span>)</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>resu <span class="ot">&lt;-</span> <span class="fu">Result2</span>(samp,Meant2,<span class="dv">2000</span>)</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = samp, statistic = func, R = Rr)
## 
## 
## Bootstrap Statistics :
##     original     bias    std. error
## t1* 108.0833 -0.3279167    37.74485
## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = bo, type = c(&quot;norm&quot;, &quot;perc&quot;, &quot;basic&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 34.4, 182.4 )   ( 24.8, 170.0 )  
## 
## Level     Percentile            BCa          
## 95%   ( 46.2, 191.3 )   ( 56.5, 224.9 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAWlBMVEUAAAAAACsAAFUAK4AAVaorAAArACsrAFUrKysrgNRVAABVACtVK4BVgIBVqv+AKwCA1P+qVQCq/6qq///T09PUgCvU1IDU/6rU////qlX/1ID//6r//9T///8P/5lMAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHOklEQVR4nO2di5qiNgBGmXHc1um2I52lKzq+/2uWJKg4XP5EuQXO+fbbrpIbpyE3IiRn6CSZugBzB0ECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQYFJByZUpS9HNtIJ+lSCoJXMEicwRJDJfjaAHW9v1CHowOQSp0AgSoRHUGOYGghrD/Lp6QVBjGASJMAgSYRAkwiBIhEGQCIMgEQZBIgyCRBgEiTAIEmEQJMIgqPFIfQ6PoLsjdS0rEuSxJh29oNN78iZDp6+f5+M2SV72Krn6kdgFnc9ZUQF2nYGtnx97Y/Mfmdz3I52C5nsT+r5A3Y5O78Wx1NazbHPwSO7uSKeg21ePnMSQfC+QUVTUk0ZMvfn6sALzljALF5QXdoyDlupha0+22hpUtNKJO+226lEEef20VShva6UXLOj03to1VchdS9ra3y1Z0F/OT2v1CUuufmQpgjIE3VEWKL0NRLqGQl8fLkyrxMUKutWgLrKLvbxN44IFeVCOgQxr7OY1lQnG2gaKxSTCDIO62xdqkCRLyipEG9TCpZq1zUUWLcjM1bOOcw9MrnYkekHp5nDcvpXLGc8nVzsSuyDTReVFG9M51Vj1QLEQZFYMu6YarQPFp9ekIxBUXFun983h9N5+ia28my96qJf910dHE7TigaIfK69BHqx7oCh7qPPKB4rpUytlteRqR2IXZG969Zdc/Uj8glpuljbSNlpasKDODj48ufqR2AXZeUaPydWOxC7IY8EsJLn6kdgFebHmyaoPY9zVmNtGmEoxiotsc0g7OvtRphpzq0uVRvpln5nZfNf+oBEmq7MVZKqHqRcd60HrrkGmepjT7lpRHGOyOltBlxqUdq3ajzBZna2gsg3KHhou9rjkOl9Brnr47KLyS8597tpfH5ugIZLr1IKgRQly7e9z91WXLCh1jXMm9tr7Jnf9vBRB1329x+1Tix5LFVRZLev33vxSBFVmYP3ucl2OIDkNDUmu8hlBTclVPiOoKbnKZwQ1JVf5vBhBtzkTgu6Y8VRjHqvTMxY0j7qEIAGCBAgSIEjQz63n1g5nZYLCbz2vS9ADNw7XJeiBW8/rEkQNUoTfel6ZoPBbz2sTFJwcgkRy/Qiaclo/8B7FfgRNWZWiGCjGImiybj4WQQMMFMt9MQsR5F2DPHcFXVvfpQjyHij6nq+vx4YIT510CIMMFP3ONwkXdPvqydP2Z5BxEIJEcl7nmyRNhiIX5DlQHEHQaK1RPwPFb8VNZs1wgjy6+ZCcnyj1iPQ8UAzKOgY/E9agBQryGCiG5R2Bn74His15zJCBBD1Gax5tB0K/7y/CMyEfZ42CgjYLr1FQEAh6NA8EiTyWJ8jnIUwBeSxOkL6rEZbH0gQ9OtVYjaCeJ6txMOFkNQ6mnKxGwRiT1aiZ80rDLECQAEECBAkQJECQAEECBAkQJBhSkBt3m2eB5D6Ptjr+8RkQyS5N7UJyycrDYcUaUpB9Z63BPFum9b2RF8wbJv0jfX0UhzJzmr65mPsM9nBYsYYUdFkTcasA4rEyeblO6RnJPcbHnrRfBPv8FvuUm6BiDSooK/O+nUw7ebJzBQ+JZP//h0SwgoJyGFRQ+qdrJlydlmtsLkBQJPMc/pAImbmgwoo1oCDzopeiOLvyOpdXuy1qUCSzLBUQIbdeAos1eDdfnHaIoJBI+e2FuJ653N7S7F2swQUVV3rQJeYfqbqs6ZtL9Vltk19iZUl+7P1awztBHpHuHtjnm8v1GXbexRpQkCtAXr4/Wz89zgryjnRZH/eNcA0XWKxBezGTd7rzHJFdejG/SMftpf745mIec2ydhBVr0EvMvCC5fH6lx1SjvMT8ImXu7oHttj1zuYYLKhaTVQGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBNEIOv2c5jdqcxTU9J7FtNz0mz/1CsYHiERQ+vrvz/+Kryu/Kx6JOAQV3xSXWLo5IMhw3P69dReU2XdpN6RaQea/o/9edp6CXvZuh1SemKvqzexM/W0baWqQwe0eyy6b5HKry/26AkGGchfhS7nN0v1tfoKyQ5DF7c+97kN1Ukwj/fqJIENzDfp5KJQhyFC2QZvDtQ0q/hSCzN8IOpe9mOnA7nux3/YfYz80ZJ6CzDjIVpVyHOR+X2j3NzMOaoHJ6kxBkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBgv8BhI4qf4w6izkAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>boot)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>The 95% bootstrap confidence intervals for the mean time between
failures 1/Î» by the standard normal method is (33.0, 182.8), by the
basic method is (19.9, 170.0), by the percentile method is (46.2, 196.2)
and by BCa method is (58.5, 232.2). They differ from each other and the
length of intervals are -149.8, -150.1, -150 and -173.5
respectively.</p>
<p>The replicates are not approximately normal, so the normal and
percentile intervals differ. From the histogram of replicates, it
appears that the distribution of the replicates is skewed, although we
are estimating a mean. The reason is that the sample size is too small
for CLT to give a good approximation here. The BCa interval is a
percentile type interval, but it adjusts for both skewness and bias, so
the BCa interval differs from the others.</p>
<hr />
</div>
<div id="a" class="section level3">
<h3>7.A</h3>
<p><strong>Problem</strong> Conduct a Monte Carlo study to estimate the
coverage probabilities of the standard normal bootstrap confidence
interval, the basic bootstrap confidence interval, and the percentile
confidence interval. Sample from a normal population and check the
empirical coverage rates for the sample mean. Find the proportion of
times that the confidence intervals miss on the left, and the porportion
of times that the confidence intervals miss on the right.</p>
<p><strong>Solution</strong></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>skewness <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) {</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#computes the sample skewness coeff.</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  x_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(x[i])</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  x_bar</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>Sample3 <span class="ot">&lt;-</span> <span class="cf">function</span>(n, mea, sd){</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  samp <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, mea, sd)</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  samp</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>Analysis3 <span class="ot">&lt;-</span> <span class="cf">function</span>(m, func, Rr, n, mea, sd){</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(boot)</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  nornorm <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, m, <span class="dv">2</span>)</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  norbasi <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, m, <span class="dv">2</span>)</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>  norperc <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, m, <span class="dv">2</span>)</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>    Samp <span class="ot">&lt;-</span> <span class="fu">Sample3</span>(n, mea, sd)</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>    Skew <span class="ot">&lt;-</span> <span class="fu">boot</span>(Samp, <span class="at">statistic =</span> func, <span class="at">R=</span>Rr)</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>    Nor <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(Skew, <span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>    nornorm[i,] <span class="ot">&lt;-</span> Nor<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>    norbasi[i,] <span class="ot">&lt;-</span> Nor<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>    norperc[i,] <span class="ot">&lt;-</span> Nor<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Calculate the coverage probability of a normal distribution</span></span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>  norm <span class="ot">&lt;-</span> <span class="fu">mean</span>(nornorm[,<span class="dv">1</span>] <span class="sc">&lt;=</span> s <span class="sc">&amp;</span> nornorm[,<span class="dv">2</span>] <span class="sc">&gt;=</span> s)</span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>  basi <span class="ot">&lt;-</span> <span class="fu">mean</span>(norbasi[,<span class="dv">1</span>] <span class="sc">&lt;=</span> s <span class="sc">&amp;</span> norbasi[,<span class="dv">2</span>] <span class="sc">&gt;=</span> s)</span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>  perc <span class="ot">&lt;-</span> <span class="fu">mean</span>(norperc[,<span class="dv">1</span>] <span class="sc">&lt;=</span> s <span class="sc">&amp;</span> norperc[,<span class="dv">2</span>] <span class="sc">&gt;=</span> s)</span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Calculate the probability of the left side of the normal distribution</span></span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>  normleft <span class="ot">&lt;-</span> <span class="fu">mean</span>(nornorm[,<span class="dv">1</span>] <span class="sc">&gt;=</span> s )</span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>  basileft <span class="ot">&lt;-</span> <span class="fu">mean</span>(norbasi[,<span class="dv">1</span>] <span class="sc">&gt;=</span> s )</span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>  percleft <span class="ot">&lt;-</span> <span class="fu">mean</span>(norperc[,<span class="dv">1</span>] <span class="sc">&gt;=</span> s )</span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Calculate the right side probability of a normal distribution</span></span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>  normright <span class="ot">&lt;-</span> <span class="fu">mean</span>(nornorm[,<span class="dv">2</span>] <span class="sc">&lt;=</span> s )</span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>  basiright <span class="ot">&lt;-</span> <span class="fu">mean</span>(norbasi[,<span class="dv">2</span>] <span class="sc">&lt;=</span> s )</span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>  percright <span class="ot">&lt;-</span> <span class="fu">mean</span>(norperc[,<span class="dv">2</span>] <span class="sc">&lt;=</span> s )</span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a>  analyresu <span class="ot">&lt;-</span> <span class="fu">c</span>(norm, basi, perc, normleft, basileft, percleft, normright, basiright, percright)</span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a>  analyresu</span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a>Result3 <span class="ot">&lt;-</span> <span class="cf">function</span>(sd, analyresu){</span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a>  dnam <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;N ( 0 ,&quot;</span>, <span class="fu">as.character</span>(sd<span class="sc">^</span><span class="dv">2</span>),<span class="st">&quot;)&quot;</span>,<span class="at">seq=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a>  Distribution <span class="ot">&lt;-</span> <span class="fu">c</span>(dnam)</span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a>  Type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;basic&quot;</span>, <span class="st">&quot;norm&quot;</span>, <span class="st">&quot;perc&quot;</span>)</span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a>  Left <span class="ot">&lt;-</span> analyresu[<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a>  Right <span class="ot">&lt;-</span> analyresu[<span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>]</span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a>  P.coverage <span class="ot">&lt;-</span> analyresu[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Distribution, Type, Left, Right, P.coverage)</span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a>  result</span>
<span id="cb43-52"><a href="#cb43-52" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-53"><a href="#cb43-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-54"><a href="#cb43-54" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb43-55"><a href="#cb43-55" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb43-56"><a href="#cb43-56" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb43-57"><a href="#cb43-57" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb43-58"><a href="#cb43-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-59"><a href="#cb43-59" aria-hidden="true" tabindex="-1"></a>mea <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb43-60"><a href="#cb43-60" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">3</span> </span>
<span id="cb43-61"><a href="#cb43-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-62"><a href="#cb43-62" aria-hidden="true" tabindex="-1"></a><span class="co"># We can set n, m, R, mea, sd any way we want.</span></span>
<span id="cb43-63"><a href="#cb43-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-64"><a href="#cb43-64" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22035</span>)</span>
<span id="cb43-65"><a href="#cb43-65" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb43-66"><a href="#cb43-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-67"><a href="#cb43-67" aria-hidden="true" tabindex="-1"></a>Analyresu <span class="ot">&lt;-</span> <span class="fu">Analysis3</span>(m, skewness, R, n, mea, sd)</span>
<span id="cb43-68"><a href="#cb43-68" aria-hidden="true" tabindex="-1"></a>Resu <span class="ot">&lt;-</span> <span class="fu">Result3</span>(sd, Analyresu)</span>
<span id="cb43-69"><a href="#cb43-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-70"><a href="#cb43-70" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span> (Resu, <span class="at">align=</span><span class="st">&quot;c&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">Distribution</th>
<th align="center">Type</th>
<th align="center">Left</th>
<th align="center">Right</th>
<th align="center">P.coverage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">N ( 0 , 9 )</td>
<td align="center">basic</td>
<td align="center">0.027</td>
<td align="center">0.054</td>
<td align="center">0.919</td>
</tr>
<tr class="even">
<td align="center">N ( 0 , 9 )</td>
<td align="center">norm</td>
<td align="center">0.028</td>
<td align="center">0.054</td>
<td align="center">0.918</td>
</tr>
<tr class="odd">
<td align="center">N ( 0 , 9 )</td>
<td align="center">perc</td>
<td align="center">0.026</td>
<td align="center">0.054</td>
<td align="center">0.920</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>From the result above, we can find that in the case of the size of
sample is 20, the coverage probabilities of the 3 types of confidence
intervals (the standard normal bootstrap confidence interval, the basic
bootstrap confidence interval, and the percentile confidence interval.)
are very close to 0.9 in the normal distribution (skewness 0). And we
can get the probability that the confidence intervals miss on the left,
and the probability that the confidence intervals miss on the right from
the table. The two probability are both small, and the results of three
methods are very close.</p>
<hr />
</div>
</div>
<div id="assignment-06" class="section level2">
<h2>Assignment 06</h2>
<hr />
<div id="exercise-7.8" class="section level3">
<h3>Exercise 7.8</h3>
<p><strong>Problem.</strong> Refer to Exercise 7.7. Obtain the jackknife
estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<p><strong>Solution.</strong> Now I compute the jackknife estimates of
bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(scor)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(x))<span class="sc">$</span>values</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> <span class="fu">max</span>(lambda<span class="sc">/</span><span class="fu">sum</span>(lambda)) <span class="co"># original estimate</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>theta.jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  lambda.jack <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(x[<span class="sc">-</span>i, ]))<span class="sc">$</span>values</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  theta.jack[i] <span class="ot">&lt;-</span> <span class="fu">max</span>(lambda.jack<span class="sc">/</span><span class="fu">sum</span>(lambda.jack)) <span class="co"># jackknife estimate</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="co"># the jackknife estimates of bias</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>bias.jack <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack) <span class="sc">-</span> theta.hat) </span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="co"># the jackknife estimates of standard error</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>se.jack <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta.jack <span class="sc">-</span> <span class="fu">mean</span>(theta.jack))<span class="sc">^</span><span class="dv">2</span>)) </span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="at">est=</span>theta.hat, <span class="at">bias=</span>bias.jack, <span class="at">se=</span>se.jack)</span></code></pre></div>
<pre><code>##         est        bias          se 
## 0.619115038 0.001069139 0.049552307</code></pre>
<p>The jackknife estimate of bias of is 0.0010691 and the jackknife
estimate of standard error is 0.0495523.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<hr />
</div>
<div id="exercise-7.11" class="section level3">
<h3>Exercise 7.11</h3>
<p><strong>Problem.</strong> In Example 7.18, leave-one-out ( <span class="math inline">\(n\)</span>-fold) cross validation was used to
select the best fitting model. Use leave-two-out cross validation to
compare the models.</p>
<p><strong>Solution.</strong> Now I use leave-two-out cross validation
to compare the four models:</p>
<ol style="list-style-type: decimal">
<li><p>Linear: <span class="math inline">\(Y=\beta_0+\beta_1
X+\varepsilon\)</span>.</p></li>
<li><p>Quadratic: <span class="math inline">\(Y=\beta_0+\beta_1
X+\beta_2 X^2+\varepsilon\)</span>.</p></li>
<li><p>Exponential: <span class="math inline">\(\log (Y)=\log
\left(\beta_0\right)+\beta_1 X+\varepsilon\)</span>.</p></li>
<li><p>Log-Log: <span class="math inline">\(\log (Y)=\beta_0+\beta_1
\log (X)+\varepsilon\)</span>.</p></li>
</ol>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG); <span class="fu">attach</span>(ironslag)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic)  </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> n<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span> <span class="co"># all possible combination</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>h<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co"># leave-two-out cross validation</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)) {</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n) {</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    k<span class="ot">&lt;-</span><span class="fu">c</span>(i,j)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>k]</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>k]</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Model 1: Linear</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>    yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[k]</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>    e1[h] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> yhat1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Model 2ï¼Quadratic</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>    J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>    yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[k] <span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">3</span>]<span class="sc">*</span>chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>    e2[h] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> yhat2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Model 3: Exponential</span></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>    J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>    logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[k]</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>    yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>    e3[h] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> yhat3)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Model 4: Log-Log</span></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>    J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>    logyhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[k])</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>    yhat4 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4)</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>    e4[h] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> yhat4)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>    h<span class="ot">&lt;-</span>h<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a><span class="co"># the average squared prediction error by leave-two-out cross validation</span></span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="at">Linear=</span><span class="fu">sum</span>(e1), <span class="at">Quadratic=</span><span class="fu">sum</span>(e2), <span class="at">Exponential=</span><span class="fu">sum</span>(e3), <span class="at">LogLog=</span><span class="fu">sum</span>(e4))<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>N)</span></code></pre></div>
<pre><code>##      Linear   Quadratic Exponential      LogLog 
##    19.57227    17.87018    18.45491    20.46718</code></pre>
<p>As is shown above, the quadratic model is best according to the
minimum average squared prediction error by leave-two-out cross
validation.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<hr />
</div>
<div id="exercise-8.2" class="section level3">
<h3>Exercise 8.2</h3>
<p><strong>Problem.</strong> Implement the bivariate Spearman rank
correlation test for independence [255] as a permutation test. The
Spearman rank correlation test statistic can be obtained from function
cor with method = âspearmanâ. Compare the achieved signiï¬cance level of
the permutation test with the <span class="math inline">\(p\)</span>-value reported by cor.test on the same
samples.</p>
<p><strong>Solution.</strong> First, I define a function to implement
the bivariate Spearman rank correlation test for independence as a
permutation test, which returns the p-value.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define a function to conduct permutation test</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>spear.perm <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">R=</span><span class="fl">1e3</span>){</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  rho0<span class="ot">&lt;-</span><span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>estimate <span class="co"># the original test estimate</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="fu">length</span>(y)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    reps[i] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y[k], <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>estimate</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(rho0, reps) <span class="sc">&gt;=</span> rho0) <span class="co"># p-value of the permutation test</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p) <span class="co"># return p-value</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Then, I generate data from multi-normal distribution and conduct the
permutation test.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:DAAG&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate data from multi-normal distribution</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>); sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>), <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">30</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22035</span>)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n, mu, sigma)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span>xy[, <span class="dv">1</span>]; y<span class="ot">&lt;-</span>xy[, <span class="dv">2</span>]</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="co"># the p-value reported by cor.test on the same samples</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>(p0<span class="ot">&lt;-</span><span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>p.value)</span></code></pre></div>
<pre><code>## [1] 0.0005043414</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the achieved signiï¬cance level of the permutation test</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>(p.perm<span class="ot">&lt;-</span> <span class="fu">spear.perm</span>(x,y))</span></code></pre></div>
<pre><code>## [1] 0.000999001</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare the two p-value</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">p0=</span>p0,<span class="at">perm=</span>p.perm),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##    p0  perm 
## 5e-04 1e-03</code></pre>
<p>Comparing the achieved signiï¬cance level of the permutation test with
the <span class="math inline">\(p\)</span>-value reported by cor.test on
the same samples, we find that they are close and both signiï¬cant. We
can both reject the null hypothesis that <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are independent.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<hr />
</div>
</div>
<div id="assigment-07" class="section level2">
<h2>Assigment 07</h2>
<hr />
<div id="exercise-9.4" class="section level3">
<h3>Exercise 9.4</h3>
<p><strong>Problem.</strong> Implement a random walk Metropolis sampler
for generating the standard Laplace distribution, whose density function
is <span class="math display">\[f(x)=\dfrac{1}{2}\text{e}^{-|x|},\quad
x\in\mathbb R.\]</span> For the increment, simulate from a normal
distribution.</p>
<ul>
<li>Compare the chains generated when different variances are used for
the proposal distribution.</li>
<li>Compute the acceptance rates of each chain.</li>
<li>Use the Gelman-Rubin method to monitor convergence of the chain, and
run the chain until it converges approximately to the target
distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</li>
</ul>
<p><strong>Solution.</strong> Implementation of a random walk Metropolis
sampler for this problem is as follows.</p>
<ul>
<li>Set <span class="math inline">\(g(\cdot\mid X)\)</span> to the
density of <span class="math inline">\(N(X,\sigma^2)\)</span>.</li>
<li>Generate or initialize <span class="math inline">\(X_1\)</span>.</li>
<li>Repeat for <span class="math inline">\(t=2,\dots,N\)</span>:
<ul>
<li>Generate <span class="math inline">\(Y\)</span> from <span class="math inline">\(N(X_{t-1},\sigma^2)\)</span>.</li>
<li>Generate <span class="math inline">\(U\)</span> from <span class="math inline">\(U(0,1)\)</span>.</li>
<li>Compute accept probability <span class="math inline">\(\alpha(X_{t-1},Y)=\dfrac{f(Y)}{f(X_{t-1})}=\dfrac{\text{e}^{-|Y|}}{\text{e}^{-|X_{t-1}|}}=\text{e}^{|X_{t-1}|-|Y|}\)</span>.</li>
<li>If <span class="math inline">\(U\leq\alpha(X_{t-1},Y)\)</span>,
accept <span class="math inline">\(Y\)</span> and set <span class="math inline">\(X_t=Y\)</span>, otherwise set <span class="math inline">\(X_t=X_{t-1}\)</span>.</li>
<li>Increment <span class="math inline">\(t\)</span>, and back to the
first step in loop.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clear memory and set seed</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22035</span>)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>rl.metropolis <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sigma: sd of proposal distribution N(xt,sigma^2)</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># x0: initial value</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># N: length of chain</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># to calculate acceptance rate</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[t<span class="dv">-1</span>], sigma)</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (u[t] <span class="sc">&lt;=</span> <span class="fu">exp</span>(<span class="fu">abs</span>(x[t<span class="dv">-1</span>]) <span class="sc">-</span> <span class="fu">abs</span>(y))) { x[t] <span class="ot">&lt;-</span> y; k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span> }</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> { x[t] <span class="ot">&lt;-</span> x[t<span class="dv">-1</span>] }</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">mc =</span> x, <span class="at">acc.prob =</span> k <span class="sc">/</span> N))</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">16</span>)</span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> k, <span class="at">ncol =</span> N)</span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>acc.prob <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>  rl <span class="ot">&lt;-</span> <span class="fu">rl.metropolis</span>(sigma[i], x0[i], N)</span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>  X[i, ] <span class="ot">&lt;-</span> rl<span class="sc">$</span>mc</span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a>  acc.prob[i] <span class="ot">&lt;-</span> rl<span class="sc">$</span>acc.prob</span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>acc.prob</span></code></pre></div>
<pre><code>## [1] 0.8233 0.7053 0.3331 0.1002</code></pre>
<p>As we can see, only the acceptance rate of second chain is much more
favorable. Next we draw the sample path for each chain.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(X[i,], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="fu">bquote</span>(sigma <span class="sc">==</span> .(sigma[i])),</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&quot;X&quot;</span>, <span class="at">ylim =</span> <span class="fu">range</span>(X[i,]))</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Next we plot the histogram with the true density besides.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">6</span>, <span class="fl">0.01</span>)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>fx <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x)) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(X[i, <span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)], <span class="at">breaks =</span> <span class="st">&quot;Scott&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="fu">bquote</span>(sigma <span class="sc">==</span> .(sigma[i])), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">6</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(x, fx, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAwAAAAMACAMAAACkX/C8AAAAgVBMVEUAAAAAACsAAFUAKysAK1UAK4AAVaorAAArACsrAFUrKwArK4ArVVUrgNRVAABVACtVAFVVKwBVK4BVqv+AKwCAKyuAK1WAqtSA1P+qVQCqgCuqgICq1ICq1P+q///T09PUgCvUgFXUqqrU1IDU///fU2v/qlX/1ID//6r//9T///8PKNHBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVR4nO2dDXvjOtVFfQc6c3lheoHpC1M+bgJ3lKb+/z+Q2Ikdp5ETKfo4Z+vs9TxA6zGuvJVlS7IjdT0hhumkC0CIJBSAmIYCENNQAGIaCkBMQwGIaSgAMQ0FIKahAMQ0FICYhgIQ01AAYhoKQExDAYhpKAAxDQUgpqEAxDQUgJiGAhDTUABiGgpATEMBiGkoADENBSCmoQDENBSAmIYCENNQAGIaCkBMQwGIaSgAMQ0FIKahAMQ0FICYhgIQ01AAYhoKQExDAYhpKAAxDQUgpqEAxDQUgJiGAhDTUABiGgpATEMBiGkoADENBSCmoQDENBSAmIYCENNQAGIaCkBMQwGIaSgAMQ0FIKahAMQ0FICYhgIQ01AAYhoKQExDAYhpKAAxDQUgpqEAxDRBAux/+d73u67rvpYuDvHB/MsRLMDu8+GHLWtAAuZfjlAB3l++HX54+8OvhctDPDD/clAAAJh/OcIEeP7063a8BX8uXBzig/mXI3AUaP/c/fS9f336UbY0ZAXmXwoOgxLTUABimjgBlp2wbiJ3kZJw0gUoCvPPTnp8rABZmH8SzQkAVwOpMP8kAuN7Pd5tfQ8idVVAozD/UoTFN42/vXrGoVkB5cHIX1+PJIDwl+EGfE8i4U4ZD5D8u81mo6c0gbQmAFwbNASQ/AcB4PIPbAKdbr2+R5F6KmAArgKCwMi/YQH6LUonDK4CwoDIv2UBih4hIw5vIDoVPfkfBHAdWv6NCdADPopJRE/+Yye4c1hDQe0JYA09+Y8CbMCGgigAOnrypwDCdMP9V7oQ1dFzxmMfgALIMVYA+wBiHAVwFEAKCiALBRCGAshCAYShALJQAGGOL2NRACmOo0AUQAzItxGT0XPGHAYVZrj66ClNLfSc8Zg/BZDjJICxNpCy/DdgVyEKgI6y/CmAHBRAFgogDAWQhQIIcxoFogBCnEaBKIAUHAaVhcOgwlAAWSiAMN3pIaStNpCy/Dfj+yg4UAB0lOVPAeSgALJQAGEogCwUQJixAsx9L1LPyVIAYSBHIZLRc7KQ+VMAdPScLGT+LQngECsgGT0nC5l/TFm33lU69ZztVAFQbdAImH8Bgsq6f54WZPukeXpuyAoIgfmXI6ysb1+GeYlRrkCb5sZBmX8xQuPbHq49rAA5mH8hguPbP3/WXgGQoxChMP8yRJR117ECJGH+JWhpGBSyApLRcbJjFx0x/5YEgGyDJqMj/3H0BzH/uPiWqxROI3M6KuCA6xArIAq9+U9To8Pl39AdALMCktGRPwWQB7MCktGRf+sCvKIs03nshCHVQBDq85+yh8s/LL5pgeZpweb4I9QAchQiCP35XwogXZoIwt4F+uX78YdlJyzqCFWArIAQAPKnAPI4yAoIASD/iz6AjiKFEdgEOt16Xz3PIrWcrWu4D6A//2lqdLj8A+Pbau+EtS2A/vxbF6DoEfKwFMDSxBA68r8UACh/CoCOjvwvBeickgfU92lHgJ4CCHI5CgQ0Q3SjAhhCx8l+EACnDigAOjpOlgKI4yiAIJd9AKA6aEYAxz6AJNO0iOwDCDGMO1AAOSiAMJcVYGmGaI35A80N1IwAGwogycdOMAWoDAWQhQIIA/s6bjI6TpbDoMJ87APYQcfJfuwDwNQBBUBHx8lSAGEc+wCiOPYBZPkogB0DNOa/wZkZohUBLjthw0p50iWqhcb8KUB1YCsgGeafBAVAh/kn0YoAV21QHcWqgI4Thc2/EQHc1RVIRbFqoOJEcfOnAOioOFHc/NsVAKURmora/NVM3X6TRgTwvItCAWriyR/jNkAB0FGbPwWoCQWQhQLIwj6AYAGG5+6NC7B/7p5++9J1nunp5SugX84IATcKEYTq/IdX3zbX+W8wKiFwduiv/XZIf6t0gYbWBVCdvwEBhvnpxznqtc5P7xWgnTaQ7vzXBHAUoBoUQBADAswLNKi8BY80LYDu/C9aPY0K8P4yLs3gW6BEvgJG2hZAdf4WBCh7hBy0LcAtxPOnAOI4rwBGED/R40e96VGgmWUnrJvIXaR4zAigMv82BNg/+x6yxBxBkBUBkNpAwPmvCgAxQ+65iLuu++l70hHEaEAA4PxbEaAfBhu67pt3t1fVy3Q2IUCPmn8rArx9GdP3DrVNG181jkOP4AsAm//aKBCWAPvnU8a+h43jU8i1f9Rxkt5OMJABwPmvCgAxPVzwqxAjKitgpOlRIN35rwuAUAlxr0L47s/yJzlc6JsWQHf+nWtBgONFxneFGdkq7oQ1IQBw/i0IMHTARnw9sKAjCDK29LH7ANj5N9EHmJuZDx9BjHH+DWwBsPNvQgDJI6QWwF8BVqaI1pr/8ANA/mN8h8vP/nn8xHxaaYPeO4Ik2BUwwPzlaPcOANIJS0b8HG/lr+Flvds0IMB6G5QC1OBW/vrrYC7e7tOv24fexpI+QdfGHaDN/PXXwVS895dv++dvO8BhuJsVANAIPdJq/jACHPphh2vQ6oOYgCNI0YYAreYPI8DhCrR9+rEFvALd7ITBCNBq/jAC9LtDA/TtZ8A2aBsCgOY/PYNsQADBIyThGhHgYWQFOM2JRQHEuC2A/nHoZFQLgDMKNHwlFfJJ5G0B9FfABGb+7Qiwf/Z/GTX8CELcEQDia3k9bP53BVCfP/zboK0IgJl/OwJ4512NO4IU2BUwgZn/VeRw+Z+bQJBt0LEAN9ugCO+k97D53xVAff7oo0DungDar0DJyArg7gmgPX8KgA4FSGIu3vtL9/TbA6+iUIA8YObfjgDvL193gO+iuDuP4vW3QU+g5t9MH2B4G/HpB9zbiPc7YQhfy+uZvxiXdwDvxJSBRxABvwJOMH8hln2Ah6alYQXkgfnLAD4KdL8Nqr0TlgzzTwJbABdwBVJeAckw/yROxRtvwOt34OGfh3kptc1OHFQByu/BI8xfimN8u+PCJNuV9UnG2YmHDhoroAzMX4wxvveXU/ArsxIcX1Vc+dI2KyAZ5i/HNDXi8beVcejTv++8jyq1j0IArJjN/OUIEmBaoGHre1tRfwWoh/nLESbA+8upBlgBJWD+chwFeJ5WHcd6H901UAEDzeevY0l7L8jPAVwLbdBkEPI//iJW0FvElWp5i54uWvoroB0DUPNvRoAyR3gUewL4UJ9/11GAMlCAAfX5D98JgBfgVekynW10gu+DnP/8i2RBVwkr1fSe+qtn7g71FSBZvkxA59+AADfHqdVXQA/fBsLO//AfRwEKsFwgngLUJzT/BgSYb72+r+xJndfFAvG3RyE6B24AdP6DAA5cgH6rrxMWUwHK30i8D3z+6AIUPcJjRFWAUBlrIJb/tDqMgU5w4SOk/HEKIHVutz7qFKACXcwVCL0bfAMMAdSulQQrgIuqAAqQm7j8KUB2KMAJiPwpQG5c3C24Rx8IXQci/2EglALkJFaAdoHIf6O2ElAFiOyECZWxBhD5U4D8xArQahsIIv/N8E60yq9FggrwcV0MClD3b7oPyzIECaDyLkAB0JER4HZjhwIUZnoRkQII5X+ntU8BCnO1MlJIJ7hRA1AE2Oh8IQ5TgHvjDV4BGgUi/43aiqAA6EDkTwGycj0pcZAAbbaBIPIff1H5OgQFQAcifwqQE8+UlPcqoGvhi5F+IPI/CqDxfSA8AYaJxh6rgDZvATgCbChADkK7Wx4BmoSd4CQoADoUIAlAAdzjArTYBqr+mfJNCRoogKMA6VCASyhAEngCuKCoV5pADRpQPX/fXAShTSB9+VMAdHDy32j8UgCeAOwEX4KTv8qKoADo4OSvsiLQBHAuSYDOOWW34GRw8h/+47S9DxFUmJvLeFaugLQ7gOIJam7QSP7jf7TlH1gY39IkcUfIgzMpQCP5Iwvw/uKbmTvmCDm4mA70QQFUvpByFx35H/9emgDa8ofqA8R3ty5+mb9HWa/EFcC5AC2vRGrAEsDFRu3fqm0sOgnA/OuV+D4GBVA6PcGjAOav6QIUV5DlIm3TwESlUxm/0RJ9rfFWgM7pCUIQzH+gxfxh7gBjdFkqQOn8HI8CJ4Cu/BEEiFoLJmSrtqG4JHAGIVTmH/ocQHKVwoSo17cWL3VWRPM//6kG8w8ryLQ+re95TDUBnF0BZPM/4ewKILxS+em+mVEAp/CbGTdQsVK8yyiAovyBBMjZBNJTASHoECBnE0hP/oFNoNOtd7oVxx8hhRICYH0zRjb/I3kFUJN/YHxbdoJFEc3//KcazB9iGHQzPb5tsAKSqXMm4xW7xfy1CzA9AsgugJp7cCqgAmjJX70Ax8Bc/iaQlhpIpYoAx7By5j9McFmj5PcwK0CnaCguCVABtAyFggiQFPXq1qIlrwVoJ1hL/hACeKeiaaQCkqlwFlNrMXf+Gt6LRhDApUft3apnMDqF8p+gYwf447qEOfJXcBXSLMApc1dKgDbmSCl+Am4eAcqfPwW4eeRjUC5D1CtbFVRAMuUFOP6ZRvMHECBL1OtbixW/EhW/kNRi/uoF+PgKUGsVkEzhE3AFvpCkKX/tAjy0JnnE1rEbIF0JSZQt/ND+KZt/0eLfR7kArrQAGw0dsSSKFt6VFkDcAOUCZL3Z+rdSgLt/oWz+xct/++QUHMF30O40DUp5ATYUYI3TZ7Ns/uWKH4RWAY53xzoCOF1TNUVSrtyukgCirSDFAiTORB+xVcUjyUcpVu75Y1n8DiBpgGIBijR2VrYCdwTQ+wDjn5AzQKsAmaZhjdla4jwqUKbcy09k2fyFW5+6BJjnu3TVBZAejnuYIp+eOY2rd+CK5N/LNYN0CDBdBqZIXKZZKGO2ohpQQoDzsECd/I9/s8CJ3EeJAKcU6nzUV7aCfkmyYB8sZUnsaAGEOgJSAsyNnfH/vhTAuawzAIVvHZteyXFUJ7cAzmWdASho6/xBqJ+/mAAX9s8pjIPyxT/q61sB20GZBTi//V/9DtwfV7HNez73kBdgeaMt9tWX0K3jZAVYT8VyFrXUd7+CBag/aaK8AOcfXLnvfkVtdRvxwbkI8hXTlfvuV8jW6UJYtx1UW4C56e8ToPpHfWWrQ3o0nFGA0wGF859NrEJgfNkWaFg5eedp+ssJMNeEGkovkLH8yEnnf3H3LX4rDjt4vgUa/Cdf67W3mK01L0P3KL1AhnOLj5qK/Ccni1+Jgg6eZ376i+7ufM5u+eHXJMBx9j4Vt4GS6wO45TufmgTo5xnZQQWYnyV6m/3n66x01Le3OqfgTlBQAHfxzmfZb//GbD2/E1M4/8AmUNwCDecc+9Wnu+OZaYg6YGvdbpmHAgtkjPlftLY1JF0//8D4tsGdsMtrfX8twPGTLx5qzNbjpWj8r9S8HyQ8/7ssrqnzydV76+dBAfqQ/B/qMGcfBr3+6Jx+OX/wVYT60NZTFahoF00E1eDUmPgwxLI4sUpv/Ty0df4U3c5/kiV/fAFH8IwhnBo5UI2dgK3nM5/qQdaH1Ro8FcuTf98Xnuun5NYzk9JT/hfVE3o7iBNg2Qnrrrgo0PU/t4jnA1fyvV5v/vNvBvNfcj79xca7kaoY5iNECgpATJP+KgSpAPMvRfqrEKQ8zL8Y6U+CSXGYfzkoAADMvxzpr0KQ8jD/YqS/CkEqwPxLUWRaK+tkzJT5P0BUaDkrgPtG75sTDeeDti8FEN43JxrOB21fCiC8b040nA/avhRAeN+caDgftH0pgPC+OdFwPmj7UgDhfXOi4XzQ9qUAwvvmRMP5oO1LAYT3zYmG80Hbl98HILahAMQ0FICYhgIQ01AAYhoKQExDAYhpKAAxDQUgpqEAxDQUgJgmowDvLzHf2g6f4ePtS9d9Cy3Bp/xHHfcOLm1cCjlh/qcyROWfUYDXpx9vP38P3js0qv3zt373U9BxXz8Hz50WcdTxyMEVG5dCTpj/uGdk/vkEmGdvCmL3u1Cnd08/DlqHXCyGEoReKsKPOu4dXNq4FHLC/KcyRJFPgKhZy97/9q+Y3YfrRVgJYgIIO2ofVVq5uduY/1SGKPIJsHv6R3irbvs1qqTboBnRYisg7Kh9VGmjUsgK8x+Izj+jAIe+R2irbv/XHzEVsA1rAUZWQOBR40obk0JemP9AdP55BNh23efQVt2w7+u3sHvVsO/hvwNPKK4CQo966FcFlnYgrm2bC+Y/EZ1/3j5A4J/eP48z2AUWM/xKEdEJCz9qXGkjUsgM8x+Izj/nMOjh5hN8VuFJxQzthQ/DRQ5VhjcY4lLICfMfyxCZf+YHYQUebbyG+3+4VoSee8RRB+IexIh0gpn/SGz+fBWCmIYCENNQAGIaCkBMQwGIaSgAMQ0FIKahAMQ0FICYhgIQ01AAYhoKQExDAYhpKAAxDQUgpqEAxDQUgJiGAhDTUABiGgpATEMBiGkoADFNewIsJqkf5qAPnX+SZEZumuAo2hNgMTvTLnCWJpKf/bPM9GCxNCfAcn6+V5mlWsgwq+ifeAcQYTFD6/v/Sy1WQf4bNf20INgC/OfQyO8u2zkLAfa//F8nMlO5MTy10LMPUIPdp3/3/xxiHiaEPFXCQoBhAtb9nyGqARlfLfQUoAbbQxv/7Y+XwzwfJqmXW7PLDL5a6ClADbaHi814iV9cez5MUk8BiuOrhZ4C1ODt579fLzR1HgYd5on3XJpIXry1QAGq8PaX7vcfr/CnSeqHIdBtF75wM3kYXy1QAEIQoADENBSAmIYCENNQAGIaCkBMQwGIaSgAMQ0FIKahAMQ0FICYhgIQ01AAYhoKQExDAYhpKAAxDQUgpqEAxDQUgJiGAhDTUABiGgpATEMBiGkoADENBSCmoQDENBSAmIYCENNQAGIaCkBMQwGIaSgAMQ0FIKahAMQ0FICYhgIQ01AAYhoKQExDAYhpKAAxDQUgpqEAxDQUgJiGAhDTUABiGgpATEMBiGkoADENBSCmoQDENBSAmIYCENNQAGIaCkBMQwGIaSgAMQ0FIKahAMQ0FICYhgIQ01AAYhoKQExDAYhpKAAxDQUgpqEAxDQUgJiGAhDTUABiGgpATEMBiGkoADENBSCmoQDENBSAmIYCENNQAGIaCkBMQwGIaSgAMQ0FIKahAMQ0FICYhgIQ01AAYhoKQEwTJMD+l+99v+u67mvp4hAfzL8cwQLsPh9+2LIGJGD+5QgV4P3l2+GHtz/8Wrg8xAPzLwcFAID5lyNMgOdPv27HW/DnwsUhPph/OQJHgfbP3U/f+9enH2VLQ1Zg/qXgMCgxDQUgpokTYNkJ6yZyFykJJ12AojD/7KTHxwqQhfkn0ZwAcDWQCvNPIjC+1+Pd1vcgUlcFNArzL0VYfNP426tnHFpPBehrEecCI39Iwl+GG/A9idRTAd1ms9FTmoyA5A9JawLAtUFDAMl/AC7/wCbQ6dbrexSppwKaFQAk/wG4/APj2yJ0wtoVACP/Abj8WxoGPQjgOrQKSEZP/v3wGAAt/8YEOHSC0WogFT35HwHLvz0BrGHvjLNCAdCxd8ZZaUwAp6c0tVB1xmDtn75FAfDqIA09+fejAGD5UwB09OTfUwBZKIA4FEASCiAOBZCEzwE0AJZ/ewJYw94ZZ6UtARwFEAXs6j/QoACAtZCCnvxP0WPlTwHQ0ZM/BRCGAkhDAUShANJQAFHGUaCuc41+M34FdSdLAaQYBdhYGws1dbL5oQDomDrZ/DQlgDsKYOudaEUn6y7+BwMKgI6ik6UAslAAYSiALBRAGAogCwUQhgLIwlEgEg0FQMfUyeanJQEcBRAFqukzERPf1rtKp6IK2LTdB1Cf/4f/hSBsevTnaUG2T5qn525WAJT8P/wvBGHxvX0Z5iVWfwWamkBQNRACSP5XPwAQGt/2cO1RXwHNCgCS/9UPAATHt3/+rL0Cmh4FAsgfkoj4dp3yCmhaAID8IWlpGLRxAVYwdbL5aUmAlvsA6yjK/+oHAOLiW65SOI3MqakA1zUvgO78PT/pp6E7gAEBfOjJ3/OTfigAOnry9/ykn8D4XhGW6Tx3gpFqIAiI/M8A5R8W37RA87Rgc/wRatDuKBBG/pCEvQv0y/fjD8tOWNQRijNeIGcBNPUNMwCQPyzNCDC8AzcL0NhdACD/HqrdsyCwCXS69b56nkXqqIBxWsRzH6AtAQDyv/z8A7kQGN9WeyesbQH059+6AEWPkINLASytlKHlRN3qL6qhAOhoOVEKIMr04acAciwG3yhAbT4I0Fof4AZ6TnSOHWkYmgKgo+dEzwIA5d+OAI4CiOIogCTTtIjsA8gwrMuzEAAnfwqAjo4TnfMffwHKv1EB2psbaBUdJ/pBAJz8mxFgQwEk6TYUQBQKIMuc/+m1XJj8WxUApg2ajI4Thc2/GQEcaAUko+NE/fkDPBGjAOjoONEVAfRXRCsCuA37AJL486cA1fhYAXZmhtCcPwWoxlUnjAJUxZ8/BagGBZCFAghDAWShAMJctUF1FKsCOk7Unz9ARTQigLu6AqkoVg1UnOhK/gAVQQHQUXGiFEAYTwVY6QRozp8CVIMCyEIBhKEAslAAYSiALBRAFvYBBAtwoPU+wP65e/rtS9d5pqeXr4B+npGg2VEg1fkPr75t/PkDVERY8V6/9tsh/a3SBRpaF0B1/gYEGOanH+eo1zo/vVeAdtpAuvNfE8BRgGpQAEEMCDAv0KDyFjzStAC68z9H3q4A7y/j0gy+BUrkK2CkbQFU529BgLJHyEHbAtxCPH8KII7zCmAE8RMdJkJsfBRoZtkJ6yZyFykeMwKozH9FgHnhWuny3WYq3v7Z95Al5giCrAiA1AYCzn9FgHlsSLp8tzkXb9d1P31POoIYXgGG5/MKyhYMbP6tCNAPgw1d982726vqZTq9AmyA5ug+gZl/KwK8fRnT9w61TRtfNY5Dj+ALAJv/yigQmAD751PGvoeN41PItX/UcYK+CkCaHg44/1UBNg5IgJvoroARbwVoDz8U3fmvC4B0B7jNdOv13Z/lT3B+87xVAXTn37kWBDheZHxXmJGt4k5YEwIA59+CAEMHbMTXAws6giDnOchg+wDY+TfRB5ibmQ8fQYwGBMDOvwkBJI+QA/8tGOlZ8KOI53+jE+xABDhcfvbP4y3400ob9N4RxIEWADv/BgQQPkIO0DvBjyN+jhaGQcseIZH1PoD28LMgfo7rfQAoAXafft0+9DaW6AmOr7yNP6ALgJl/f5qSCV+A95dv++dvO7RhuO5iObbrCgDpBMDm398RYHhNTsN3FtZZDIMerkGrD2ICjiBCMwKA5t8HCKD7LrC4A2yffmzRrkBzuugCgOY/FqAJAfrdoQH69jNaG7QZAUDzHwvQhgCCR0j549NL//ACPIzwh8tRgAylePyP3xFAsmyVUC2A/pGgRRMI8UnkKMA8/8B1BegegViCmX87Auyf/V9GDT+CCN3pe3erFYDytUjQ/O8KoP5rkeBvg7YjAGb+7QjgnXc17ggSXN9sQQUAzX8sQBMCgL6NeFcAlO8E4OU/T0t3L38MASSPkPLH3T0BNIefBTEBjuOc998G1V0HFAAdYQGOA3ANCPD+0j399sCrKBQgD3D5XzzpuieA3vHo87tAX3eA76K4q6hB+wB4+Y8Bh+Q//yJU0Nss3wZ9+gH3NuL9TjDI1yLx8l+51l/njyHA8QrknZgy8AgiNCMAXv6NCTDOTPzItDQUIA9w+bcmgOARErjfBlWaez6U9wEWvwgV9Da4AnTj94EpgKQAQflDCDDegNfvwMM/D/NSapqdOLgCENpATecPIMDuuDDJdmV9knF24qGDhlkBQgWMoO389Qvw/nIKfmVWguOriitf2tZfAUIFDKfx/PULcHMBhvO/77yPKrWPQgAsltd2/vMb60IFvU2QANMCDVvf24r6K0Br9jPt548uwPvLqQZQK0CojIG0n792AZ6nVceR3keflyHEF6D5/JULIHyEB//ucnnae21QoTLWACL/VgRY3qKni5b+CkB5I/Q+sPm3IkCZIzz4dw0K4AMifwqQHwpwBCJ/eAFe9S3T2dAo0H3Q80cXYHpP/dUzdwdEBQiVMRfw+YMLcHOcGqEC9L8NcRP8/ClAfi4WKKcA1YnKH1yA+dbr+8qe1Hk5b9QrFQBuAH7+4AL0W32dsJgKAHgj9Dbw+aMLUPQIjxFVAUJlrAFE/uhNoLJHePDvUoARiPwpQH7iBEBvA60Dkf/40EyooLeBFcBRgCMQ+VOAvEwTQlAACpAIqAAfF4a5L0CzBsh8rlxsE0jrO+lWBGgXDAHUVgKqALejpgAV/i4FyHWEyL+3WBQ1RoBW20AoAih9Jx1QgCHQj+syUIC6fFwZiQLU4yEBxmGjygWtBAVIAlOAq0mJcSsgGYnTGu6mjeRvRwD0d6LXQBFAaf6YAkR3gsdfKhe0EiidYKX5UwB0KEASkAJcT0ocVAE678GpCHyu3DQUHZ2/vvVSKQA6IgI8mr++WwGiAJ4pKcMqoEkD6n+cXPyT+Cl/CpDO4wK0+SwMR4CeAuSAneBLIN7FmvLXVxEUAB0KkASgAL4pKQMroMU2UPWPk3tcAIWThFIAdChAEngCeCckC70FN2hA9fz7hCaQviniKAA6FCAJPAHYCb6EneAkLAmg7Sl8HnAEmN+fECjxKmgCOPe4AMN/2nsaXDv/8W8m5I8owM1lPCuezvi9rjQBIHsBWvLvp07U4/mrmyAosDC+pUnijpCD4/Qy9gRQk//hAt5NTXlbAry/+GbmjjlCDuKi9guAaYCm/PskAbSt2gzVB8ggQHs9YTQBMO8ARY8Q/qdcbNT6KyCZSmczXjmmdS4ayt+gAEqnJ3iUWgIM6WURQFf+cYVZLtI2DUxUPB0XGfVKBUD2AkYE8x+Tm67fDeUPdQfII4DS+TkepboAj0xNqTd/KAHiW5v+rapqIJWaTaB8+asZjAh9DqBilcJcFVCvxLmQzz+nANPh6pT8NmGFmNan9T2PqTYK4bqMFYCFhvw/LslgSQANK5V3LmMF6OqH3aXB/ClALFcTQiddgShALJnzx0M9QHMAAAdVSURBVBJgvvVOt+L4IySTuQKwDGgwfywB+m1TnTAtIxDhtJX/dDgNFYEyDHo9G19CBWi5+mQBMP9+6VOV4q9jVgCsNtANAPPvly2qKsVfB0QAz2x8qXeAVgwAzH98ljwNKtUo/g0MC9CIAaD5b5yOSYJABMjbCVOQez7Kn0nnff0nVQA2gcLxTkWTLoCKUYhkKgjgnYqJAmQ7wj1ciSvQ8PUONYPRKVTIP9NH/eMPKvIHEMCVqgB9c3Q8AvNPAkGAXDfb660KKiAZ5p8EgAAPrEcYs7V48QvD/NNOTsERbuIar4BkmH8SSgWYB2geWpM8Yiv+04Cyn6Dm89cqwOni4EpXgHwNpFJUgPbzVy3ARMkKgH8pKHv+V09Hms5ftQAPL4YUs7VE8WuSX4A5FXfe0Gz+mgVwlQSQvgunUU4AV0kA0fwVC5C4EkDo1vGRcK9ooo5IignglhuK3gEkDVAsQPao17fOKx+WOJfCFGwCLTYUbgLJGaBVgEzT4IYK0FOA8wGHINyHDUXvwMf8Ze7ASgVwdQVAfjOuiACungCn2KXy1ymAyzQLaMxWDW9mPULOMk+jzufPf/lh6NMFSOrNOJ0C1O4DHH9QtnZJIFkFWF6T5y1N569PAOc+vn5SqwI24k9lHiG3AO7iUtx8/roEGO+E06wZIgLgGZAr/7n1MwYxdUmbz1+XABcrMEgIgDZpYp9RgM20AMCcSPJKAAD5axLAuYsVGCQEGK97WA7kE8CV++5XuAB9ZQd0CDB98CpGvb711A1BIaMAtZP2CjA2g+vlHxhf4QUahlO+avlICTA3fy9+yHCWCZTLvzuNQV5P/SYlwGazqTgcFPaXSi/QMA48VBlxDt06fiYWVSIrQMH8x9Ot89phnACXt4FiU9gEHbPk/PTzqKeKCrj8ZaGlqACF81eQ9PTDfBH82BmbtMiOtADuYtIf8Qq42uqck39JImP+H9t3Es/cQ7cO5R3z76UFKLFAw3hmguM9cVud7BvT+fKfPlnd5SdLT9KLXxZ333JXocBjbuM7YWuflmPy3fLCLx51wNbRVif1tsQD+fvpNqf8N5MJ6pK+3tqPwm4un5NluhqVGwadin78petOl/zFvyqM+u7WkwfegTqZG8T5L/o7iufGzvTBvxhrUZDp3a1zQ+H03ZnjR2n6l+7iTB+P71FWBTh9TLq5Gb2Zi6xpvOehrdPY4YUPF8pX4/gXP3Qfr/Kft158oGCaoB8+PMctpw/WZf4fjAiML5RlJ6y74uIDcf3PrXM+/cXGqHgfy3/+jfk/kD/iC8CEZIMCENOkvwpBKsD8S5H+KgQpD/MvRvqTYFIc5l8OCgAA8y9H+qsQpDzMvxjpr0KQCjD/UuSfVYZIDS1Ln7YaokLLWQHcN3rfnGg4H7R9KYDwvjnRcD5o+1IA4X1zouF80PalAML75kTD+aDtSwGE982JhvNB25cCCO+bEw3ng7YvBRDeNycazgdtXwogvG9ONJwP2r78PgCxDQUgpqEAxDQUgJiGAhDTUABiGgpATEMBiGkoADENBSCmoQDENBkFeH+J+dZ2+Awfb1+67ltoCT7lP+q4d3Bp41LICfM/lSEq/4wCvD79ePv5e/DeoVHtn7/1u5+Cjvv6OXjutIijjkcOrti4FHLC/Mc9I/PPJ8A8e1MQu9+FOr17+nHQOuRiMZQg9FIRftRx7+DSxqWQE+Y/lSGKfAJEzVr2/rd/xew+XC/CShATQNhR+6jSys3dxvynMkSRT4Dd0z/CW3Xbr1El3QbNiBZbAWFH7aNKG5VCVpj/QHT+GQU49D1CW3X7v/6IqYBtWAswsgICjxpX2pgU8sL8B6LzzyPAtus+h7bqhn1fv4Xdq4Z9D/8deEJxFRB61EO/KrC0A3Ft21ww/4no/PP2AQL/9P55nMEusJjhV4qITlj4UeNKG5FCZpj/QHT+OYdBDzef4LMKTypmaC98GC5yqDK8wRCXQk6Y/1iGyPwzPwgr8GjjNdz/w7Ui9NwjjjoQ9yBGpBPM/Edi8+erEMQ0FICYhgIQ01AAYhoKQExDAYhpKAAxDQUgpqEAxDQUgJiGAhDTUABiGgpATEMBiGkoADENBSCmoQDENBSAmIYCENNQAGIaCkBMQwGIadoVQG6aWjJmL7dSQgztChA+pTzJzP55yF5upYQYmhUgfEp5kplt96fIeaIFaVWAyAnwSUb+O07mDNIEbUGA/3zpxlmMl0ROgE8exJf9sQ8gt1JCFA0IsPv07/6fw4d96HWdqiNyAnzyIL7s+5MAYislRNGAANuvh8T/eLnYSMyU8uRxfNn30x1AYqWEaFoQ4HDZ2f/51+VVKG4CfPIwnuwHpj4ABajB289/9y03xTtABW5lL7dSQgwNCNC//aX7/XVbkwLU4Eb2cislxNCCAIQ8DAUgpqEAxDQUgJiGAhDTUABiGgpATEMBiGkoADENBSCmoQDENBSAmIYCENNQAGIaCkBMQwGIaSgAMQ0FIKahAMQ0FICY5n+LhgLjn29DhAAAAABJRU5ErkJggg==" /><!-- --></p>
<p>From the plots above, we can draw to the same conclusion to the
previous part, that is, the second chain is more suitable. Next, we
compare the quantiles.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fu">rev</span>(z), z) <span class="co"># generate laplace random numbers</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.1</span>), <span class="fl">0.95</span>)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>Q <span class="ot">&lt;-</span> <span class="fu">quantile</span>(z, p)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>mc <span class="ot">&lt;-</span> X[, <span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)]</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>Qmc <span class="ot">&lt;-</span> <span class="fu">apply</span>(mc, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">quantile</span>(x, p))</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>QQ <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">round</span>(<span class="fu">cbind</span>(Q, Qmc), <span class="dv">3</span>))</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(QQ) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;True&#39;</span>, <span class="st">&#39;sigma=0.5&#39;</span>, <span class="st">&#39;sigma=1&#39;</span>, <span class="st">&#39;sigma=4&#39;</span>, <span class="st">&#39;sigma=16&#39;</span>)</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(QQ)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">True</th>
<th align="right">sigma=0.5</th>
<th align="right">sigma=1</th>
<th align="right">sigma=4</th>
<th align="right">sigma=16</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">5%</td>
<td align="right">-2.196</td>
<td align="right">-3.170</td>
<td align="right">-1.880</td>
<td align="right">-2.232</td>
<td align="right">-2.279</td>
</tr>
<tr class="even">
<td align="left">10%</td>
<td align="right">-1.711</td>
<td align="right">-2.106</td>
<td align="right">-1.298</td>
<td align="right">-1.557</td>
<td align="right">-1.538</td>
</tr>
<tr class="odd">
<td align="left">20%</td>
<td align="right">-1.037</td>
<td align="right">-1.184</td>
<td align="right">-0.737</td>
<td align="right">-0.931</td>
<td align="right">-0.889</td>
</tr>
<tr class="even">
<td align="left">30%</td>
<td align="right">-0.498</td>
<td align="right">-0.636</td>
<td align="right">-0.394</td>
<td align="right">-0.509</td>
<td align="right">-0.471</td>
</tr>
<tr class="odd">
<td align="left">40%</td>
<td align="right">-0.147</td>
<td align="right">-0.298</td>
<td align="right">-0.153</td>
<td align="right">-0.221</td>
<td align="right">-0.186</td>
</tr>
<tr class="even">
<td align="left">50%</td>
<td align="right">0.000</td>
<td align="right">-0.068</td>
<td align="right">0.049</td>
<td align="right">-0.015</td>
<td align="right">0.115</td>
</tr>
<tr class="odd">
<td align="left">60%</td>
<td align="right">0.147</td>
<td align="right">0.156</td>
<td align="right">0.263</td>
<td align="right">0.211</td>
<td align="right">0.315</td>
</tr>
<tr class="even">
<td align="left">70%</td>
<td align="right">0.498</td>
<td align="right">0.459</td>
<td align="right">0.556</td>
<td align="right">0.492</td>
<td align="right">0.656</td>
</tr>
<tr class="odd">
<td align="left">80%</td>
<td align="right">1.037</td>
<td align="right">0.853</td>
<td align="right">0.970</td>
<td align="right">0.902</td>
<td align="right">1.007</td>
</tr>
<tr class="even">
<td align="left">90%</td>
<td align="right">1.711</td>
<td align="right">1.607</td>
<td align="right">1.557</td>
<td align="right">1.601</td>
<td align="right">1.605</td>
</tr>
<tr class="odd">
<td align="left">95%</td>
<td align="right">2.196</td>
<td align="right">2.225</td>
<td align="right">2.154</td>
<td align="right">2.351</td>
<td align="right">2.181</td>
</tr>
</tbody>
</table>
<p>As we can see, the quantiles of the second or third chain are close
to the true quantiles of standard Laplace distribution.</p>
<hr />
<p>Finally, we use the Gelman-Rubin method to monitor convergence of the
chain. Suppose we are interested in the mean, i.e.Â <span class="math inline">\(\phi_{it}\)</span> denotes the sample mean until
the <span class="math inline">\(t\)</span>-th replicates in the <span class="math inline">\(i\)</span>-th chain.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(phi) {</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  phi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(phi)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(phi); n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(phi)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  phi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(phi)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(phi.means)</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  phi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(phi, <span class="dv">1</span>, var)</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(phi.w)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n <span class="sc">+</span> B <span class="sc">/</span> n</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a><span class="co"># ergodic mean plot</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>phi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(phi)) {</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>  phi[i,] <span class="ot">&lt;-</span> phi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(phi))</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>((b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N, phi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>),</span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="st">&#39;Index&#39;</span>, <span class="at">ylab =</span> <span class="fu">bquote</span>(phi))</span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> { <span class="fu">lines</span>(phi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">col =</span> i) }</span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot of R_hat</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N) {</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(phi[, <span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;R&quot;</span>)</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">1.2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAATlBMVEUAAAAAACsAAFUAK4AAVaorAAArACsrKysrK4ArgNRVAABVqv+AKwCAVQCA1P+qVQCq///UgCvUgIDU1P/U////qlX/1ID//6r//9T////5pzgHAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAGj0lEQVR4nO2dbVfbOBBGvQvslpbdNFtC8f//o2vHxAQS51rSjDzYz/3Q5pzIo3DR61g4TStu0iz9AaIjQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBBgLKj5MiwlyDacHxIESBAgQZM0Z//OLm5ce2BOw7MEXeV99nIR9Pv7Y/fvoavlz58G4apzPrn7CdrfPfevfpSHq82HtY+boDc1R02F4SrzcW3oJujl4SjoMNHJwgr6vHZWC/rA5dbCSVC/iblvT8N1Ybh6XNl5eU3znaM//u0msgk/MQVd25lqHTRyfeMuQScmEhvegvZfZRabSvxUbkHpeag6TH8gdbGeG78vCWpv+pGg9rYfCQI/nivpgfCzGMwXPi3o9WkyEZQTzhOaT5262OvTvWU4P3C94TUGHZqJTFleOC94PbbtQXrGenXLgmYt5zcsaN52Z7uCZm4HNyto7nZ5q4JmpxM2Ksjh2M+qBCWkozYpKCVdt0VBSenMDQpKS/duLyedWPXmWlDqr2ZrgpKb7sYEpXftbQnKGPo2JShnatiSoKypc0OC8pYW2xGUufTyFHRo+kNUZuHKyF2aOgnaNc3jy7fnOMeAs5fuPoJ2d8/t7th6ghzizN/aON167trNy1+9oBjHgAu2fgWC/pu8uzycbX391UZpQQW1JQvav51HuHn7fTx4F+MYcEllqYIO3cjSjzDdDDV1wrdnP0xf0zegawoqyq0kCjoeSuiGmP30BG5cbzGFuadEQccu8/r0dwOHN+zqLaU0NZcsqO8zu5vd6wNLHwMuTl3mCZqYmmZEqZxyLa8nT1BpB6vVggx+D6sWZNFO1yzIpB8nC8Lzq8b1FlRhUofTXizAMWCjecBnNx/gGLDVPOmUD1r8GLDZOsIro7jwMWC7ddayOWkvTYbr0IWT9j6GLNfpaxRkuo9ZoSDbfd76BBnvg1cnyDpPsLQga0P2Ac0LpoWzDmveJNclyCEPtypBHnnKdQmyDJYa0yh58Pkxqab/N8bx2pRG6TV7Gu6afJbl5gUTw9ltu532deYFE8OZ5W2cMgPLC6qd+fOK67aCtxr9TcJcCWxeMDWczc0Ztwzl8oJMbn/6ZXADCGpLT6h4+okhaFiXmQUzJYigtqQZuR4VcRGUeWc19yy8p59Yd1azflLno0ZOXSzvzmrWnyv5+gl2ZzXjDwKd/QQapPNq8fYTTlBiNf5nHYMJSqymwllQb0Gpx4DTHhvh72e5lKtBPVXOEkfrYilJ4Bp+4gmaXVGls+gBBc2qqd5ZffOCxeHm/Oj1nh4TabM6vod1VXy6TqjN6ty6aj59KNRmdXwT3q3oJ9hmdXz31hheU0/IQfr49sTXpNTWE1bQtUa0gJ02sKBPjWgZO21kQecbt6XstLEFhUCCAAkCJAhYTNCXYSFBs4NGKuJ6fW7QSEVcr88NGqmI6/W5QSMVcb0+N2ikIq7X5waNVMT1+tygkYq4Xp8bNFIR1+tzg0Yq4nr96pEgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCLAXdOt7SYjhgc1jhMsXzL5phjNMRVHeMRfUPx3/kGno0PSCxgiXL5j+qfvHU15FUc6wFvT61D/VPO+5wr+/94LGCJcv5lR/P3Vx5iezFvTy0LfvqT/luM3+7p9O0Bjh8gWHGAUVRTnHXNDNL26hS/sxaIxw+WJGkFMXK4tyhrWgoZPnDEJ9Fzh+tccpwuWLWR9gGIkLo7wTR1D/bTjlgnZdC3l5eIwrKLuLHS8s7mLvI07ULpY9SO/fjqX8KBpex2YSdpAumeaHFlQ0QQ8WumYSdpovWigOK+miJd5pDAq7UDz2lcKtxhjh8sWMEM3bF1wVRXlHm1VAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAv4H3ccNpYdzRFAAAAAASUVORK5CYII=" /><!-- --></p>
<p>Either from the ergodic mean plot, or from the plot of <span class="math inline">\(\hat{R}\)</span>, we could know the chain has
converged.</p>
<hr />
</div>
<div id="exercise-9.7" class="section level3">
<h3>Exercise 9.7</h3>
<p><strong>Problem.</strong> Implement a Gibbs sampler to generate a
bivariate normal chain <span class="math inline">\((X_t,Y_t)\)</span>
with zero means, unit standard deviations, and correlation <span class="math inline">\(0.9\)</span>.</p>
<ul>
<li>Plot the generated sample aftering discarding a suitable burn-in
sample.</li>
<li>Use the Gelman-Rubin method to monitor convergence of the chain, and
run the chain until it converges approximately to the target
distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</li>
<li>Fit a simple linear regression model <span class="math inline">\(Y=\beta_0+\beta_1X\)</span> to the sample and
check the residuals of the model for normality and constant
variance.</li>
</ul>
<p><strong>Solution.</strong> To generate a bivariate normal chain <span class="math inline">\((X_t,Y_t)\)</span> from <span class="math inline">\(N(\mu_1,\mu_2,\sigma_1^2,\sigma_2^2,\rho)\)</span>,
we notice that <span class="math display">\[\begin{align*}
X\mid Y=y&amp;\sim
N\left(\mu_1+\rho\dfrac{\sigma_1}{\sigma_2}(y-\mu_2),(1-\rho^2)\sigma_1^2\right),\\
Y\mid X=x&amp;\sim
N\left(\mu_2+\rho\dfrac{\sigma_2}{\sigma_1}(x-\mu_1),(1-\rho^2)\sigma_2^2\right).
\end{align*}\]</span></p>
<p>So we implement the Gibbs sampler below and plot the generated sample
aftering discarding a suitable burn-in sample.</p>
<ul>
<li>Set initial value <span class="math inline">\(X_1\)</span>, <span class="math inline">\(Y_1\)</span>.</li>
<li>Repeat for <span class="math inline">\(t=2,\dots,N\)</span>:
<ul>
<li>Generate <span class="math inline">\(X_t\sim f_{X|Y}(x\mid
Y_{t-1})\)</span>.</li>
<li>Generate <span class="math inline">\(Y_t\sim f_{Y|X}(y\mid
X_t)\)</span>.</li>
<li>Increment <span class="math inline">\(t\)</span>, and back to the
first step in the loop.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clear memory and set seed</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="co">#rm(list = ls())</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22035</span>)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>rbn.metropolis <span class="ot">&lt;-</span> <span class="cf">function</span>(mu, sigma, rho, initial, N) {</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mu, sigma, rho: parameter of bivariate normal distribution.</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># initial: initial value</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># N: length of chain</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> Y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> rho<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> sigma</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>] <span class="ot">&lt;-</span> initial[<span class="dv">1</span>]; Y[<span class="dv">1</span>] <span class="ot">&lt;-</span> initial[<span class="dv">2</span>]</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> Y[i<span class="dv">-1</span>]</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>    m1 <span class="ot">&lt;-</span> mu[<span class="dv">1</span>] <span class="sc">+</span> rho <span class="sc">*</span> (y <span class="sc">-</span> mu[<span class="dv">2</span>]) <span class="sc">*</span> sigma[<span class="dv">1</span>] <span class="sc">/</span> sigma[<span class="dv">2</span>]</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>    X[i] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s[<span class="dv">1</span>])</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> X[i]</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>    m2 <span class="ot">&lt;-</span> mu[<span class="dv">2</span>] <span class="sc">+</span> rho <span class="sc">*</span> (x <span class="sc">-</span> mu[<span class="dv">1</span>]) <span class="sc">*</span> sigma[<span class="dv">2</span>] <span class="sc">/</span> sigma[<span class="dv">1</span>]</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>    Y[i] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s[<span class="dv">2</span>])</span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">X =</span> X, <span class="at">Y =</span> Y))</span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a>XY <span class="ot">&lt;-</span> <span class="fu">rbn.metropolis</span>(mu, sigma, rho, mu, N)</span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> XY<span class="sc">$</span>X[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)]; Y <span class="ot">&lt;-</span> XY<span class="sc">$</span>Y[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)]</span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X, Y, <span class="at">xlab =</span> <span class="fu">bquote</span>(X[t]), <span class="at">ylab =</span> <span class="fu">bquote</span>(Y[t]),</span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">cex =</span> <span class="fl">0.5</span>, <span class="at">ylim =</span> <span class="fu">range</span>(Y))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(<span class="fu">cbind</span>(X, Y))</span></code></pre></div>
<pre><code>##           X         Y
## X 1.0155773 0.9153026
## Y 0.9153026 1.0155647</code></pre>
<p>From the result above, we can conclude that the chain has converged
for the sample covariance matrix is close to the truth. Next, we use
different initial values to monitor the convergence of two chains
(i.e.Â <span class="math inline">\(X_t\)</span> and <span class="math inline">\(Y_t\)</span>), with <span class="math inline">\(\phi_{it}\)</span> denotes the sample mean until
the <span class="math inline">\(t\)</span>-th replicates in the <span class="math inline">\(i\)</span>-th cain, respectively. Notice that we
calculate the sample mean of <span class="math inline">\(X_tY_t\)</span>
for monitering the convergence of covariance.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> k)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>Xmc <span class="ot">&lt;-</span> Ymc <span class="ot">&lt;-</span> XYmc <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> k, <span class="at">ncol =</span> N)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  XY <span class="ot">&lt;-</span> <span class="fu">rbn.metropolis</span>(mu, sigma, rho, x0[,i], N)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  Xmc[i,] <span class="ot">&lt;-</span> XY<span class="sc">$</span>X; Ymc[i,] <span class="ot">&lt;-</span> XY<span class="sc">$</span>Y</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  XYmc[i,] <span class="ot">&lt;-</span> Xmc[i,] <span class="sc">*</span> Ymc[i,]</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="co"># ergodic mean plot</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>cal_phi <span class="ot">&lt;-</span> <span class="cf">function</span>(X) {</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>  phi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(phi)) {</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>    phi[i,] <span class="ot">&lt;-</span> phi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(phi))</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(phi)</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>phiX <span class="ot">&lt;-</span> <span class="fu">cal_phi</span>(Xmc)</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>phiY <span class="ot">&lt;-</span> <span class="fu">cal_phi</span>(Ymc)</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>phiXY <span class="ot">&lt;-</span> <span class="fu">cal_phi</span>(XYmc)</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>plot_erg_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(phi, rg) {</span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot</span>((b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N, phi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> rg,</span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab =</span> <span class="st">&quot;Index&quot;</span>, <span class="at">ylab =</span> <span class="fu">bquote</span>(phi))</span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> { <span class="fu">lines</span>(phi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">col =</span> i) }</span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_erg_mean</span>(phiX, <span class="at">rg =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_erg_mean</span>(phiY, <span class="at">rg =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_erg_mean</span>(phiXY, <span class="at">rg =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">1.1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA2AAAAGACAMAAAD8l/E9AAAAulBMVEUAAAAAACsAAFUAK1UAK4AAVaoil+YrAAArACsrAFUrKwArKysrK1UrK4ArVVUrVaorgNRVAABVACtVAFVVKwBVKytVK4BVVStVVVVVVYBVgIBVgKpVqv9h0E+AKwCAKyuAK1WAVVWAVaqAgCuAqtSAqv+A1KqA1NSA1P+qVQCqVSuqgFWqgICq1NSq/6qq///UgCvUqoDU1IDU1KrU1NTU1P/U///fU2v/qlX/1ID/1NT//6r//9T///8RQlEIAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAeDUlEQVR4nO2daYPbyHFAIWVFWXF2Le3GsZMI0to5LMWJpcQbcSYz+P9/K8TRF9CoAoFuHOR7H2Z4AA2gWK8vgGBRAUA2iq13AOCWQTCAjCAYQEYQDCAjCAaQEQQDyAiCAWQEwQAygmAAGUEwgIwgGEBGEAwgIwgGkBEEA8gIggFkBMEAMoJgABlBMICMIBhARhAMICMIBpARBAPICIIBZATBADKCYAAZQTCAjCAYQEYQDCAjCAaQEQQDyAiCAWQEwQAygmAAGUEwgIwgGEBGEAwgIwgGkBEEA8gIggFkBMEAMoJgABlBMICMIBhARhAMICMIBpARBAPICIIBZATBADKCYAAZQTCAjMwRrLg90sb09iA+MsLBzgnQ7NDulcQJlLS0PUB8ZBBMgQSSIT4yCKZAAskQHxkEUyCBZIiPDIIpkEAyxEcGwRRIIJmZR/T0rp1je/klRWk7BsEUEExm7hE9/fgpYWn7BcEUEExm9hE9fPctYWm7BcEUEEyG+MggmAIJJLPsiJ5+MmMw9bqHg4JgCggmQ3xkEEyBBJIhPjIIpkACyRAfGQRTIIFkiI8MgimQQDKcaJZBMAUEk+FEswyCKSCYDCeaZRBMAcFkiI8MgimQQDLERwbBFEggGeIjg2AKJJAM8ZFBMAUSSIb4yCCYAgkkQ3xkEEyBBJIhPjIIpkACyRAfGQRTIIFkiI8MgimQQDLERwbBFEggGeIjs0iw54/9CzbvKkAqxGfb0vbAXMH4uoEM8dlBaXtgdgv2+PotNbQA8dm+tD2woIv49cWfSCAB4rN1aXtgyRjs+cMLEkiA+Gxc2h5gFlGBBJIhPjILBbvrG0dOgPhsWdoeoAVTIIFkiI8MgimQQDLER2a2YA9Nj6c/ir+rAIkQn+1L2wNzBXv+8L7+9/h9eGuguwqQBPHZQWl7YPaVHO3o3Q3iJ6xzSOZeyUF8ti9tDyxtwd6QQFGIzw5K2wMLLpVijCFBfLYvbQ8wi6hAAskQHxkEUyCBZIiPDIIpkEAyxEcGwRRIIBniI4NgCiSQDPGRQTAFEkiG+MggmAIJJEN8ZBBMgQSSIT4yCKZAAskQHxkEUyCBZIiPDIIpkEAyxEcGwRRIIBniI4NgCiSQDPGRQTAFEkiG+MggmAIJJLNGfM5Jt7EuCKaAYDIIJoNgCggms0J8zgi2aJ19g2AyCCaDYAoIJpM/PmcEW7bOvkEwmVUEO7BhCKaAYDIIJoNgCggms4ZgR55GRDAFBJNZR7DjGoZgCggmM/eIpt+7/3zoeUQEU0AwmZlHdMW9+8/VkU81I5gCgsnMPKIr7t3fCHbYcRiCKSCYzMIWbMK9+1vBjtpLRDAFBJOZe0RT793fNV0INn+dfYNgMrnj05l12CYMwRQQTGbZEek/Em8FO+ggDMEUEEwm7RENJTKCHXWuHsEUEExmJcEqBJu9zr5BMJnEgg0k8sZehzQMwRQQTAbBZBBMAcFk5p5oftdOarwMz4NFBKsQbOE6+wbBZOYe0dOPnyKvqoIdbrJjtmCPr4tX0y51OTYLTqQSH4mH774NX4wJFrx7uEvr5wpWX+ry8PILCTQC8ZnFQJ5z7+27EazJnKef/kICxSE+s0Aww/PHugv99NsJF2sem7ktGPGZwwTBDnbN1IIxWH059MNLEigO8ZlVmizYAQ1jFlGBWUSZlQU73FWJCwXTL9Y8OrkvZj066wrWvXigNowWTCFPC3Y7cUIwGQRTyCXYrUQqdXyGfcIhRxqGzRZs+l2Bjs3cI5Lj03QWbyJYyQVz6ozf7eYOBFPuClSoBRyFhfecGLtrEoKNlBYINj6fcRjDFp1oHr8UqOkC3XMCaXdNagS7hQDlFWzco1sXTLsr0L0nEPGZWRqCdSh3Bbr7BNLumnQJzl3HJ87J7/zdt2DKOncvmFrajZwVyymYNFt4lEFYNsFIIKU04hPhIphTR74q6s4FI4G00ohPhJ5g0qIR+U5J9yUNCKaQUbCbmGbNIpi9F6LAQLDTBVvIbsgr2A1kUL6LfW9jlJpesGqaYIO3jWDtv71YlvFSKRJILY349LCCTfnNop5hp84w8zfpjs0GwRQQTCaHYOdpgoW9RNNuXf7fiWAVCaSWRnxCTtawap5gTSt2OiHYYcgs2OEDlDg+rgmb8L3KoWDdQOxkOorbk1cwEkgp7fjzQFsK5hq5k22xTifTTbwTwUggqbTjz7TmEcyOw2RLTqYJO4UNVivYLgxDMIW8gh2/jc8hWDVZsJMTrPfGXoZhmQU7vmH5BTt2gLIIVrXdRLUVsqeWByOuuxGMBNJKIz5+aU6w6qzPB168atu5wYjrZP5sLVl2wUggpbSD10CpBXM6nc2cuyrYeWQRZe1VWEMwEkgujfi40jwhTpbRxWuB2r7kyPvi2quQXzASSCvt0DVQ6viEgimKNKe8TqJgW4/EEExhBcEOHaCcgnUnjEcNaUdop7OdTBwucNp6FLaGYNFXj5JUqwtW5NhuPrYRzPteStPGSRfeb9uEIZjCRoIdptuYW7CeYWZa3ntSPxN/E+LOBCuqQ11nv75gxaFuiJNRsGr4yDZavniqYFsatoFgXQJNLb5ZcLupyAyCDRKhCB53vxJx1Ya30zG5YOYU1qDZah/aRi0QTL6ddqzMtcghmJxA5mdGJjpTWLa5ci+5YJFM8G0qWsem1yldLLeqgdJXQN7Xkju8x13bVZ36gzPvpy8H8XXzkes7ll6waAIFjwcJ5H7ap+iPQOzt325KsF6AvOMyAQhelQ7br65uIj6Vmdtwrw4Eq6KCVWOCeafUVj8vllywWG/Y/9wLN0/mJVBlBfPzxGrnFj98AkVHCwPBwle9Cqi/1M3Fx42wvJcDwdwILHDFCBaLr73g6viCxX/jM55AvSnpbnDmOpGxkf7qv2OXOIHi39X1q5rIxl2lUxT+4mEkTA217t2qcglWaYLFVj+b30kfvjV6WXBmEgs28mVvT7DIJoKekNeUjXi0rmJpNzSMT/PcNk+9rRmfzJ64oehYc1WsfcfXDJNAgmD24kJBsOoc6SR6p86OLVjXTHuvuASqhjV0EWzITyc5T9bLocSCdf+8XzioH9vmqb81b1xq+4BaBVQpsUvLqoKdvL5ebPV2puMs3/EtXRM25fbdyQXrb1lJoGFHsBg8iO9dYGM+MiRQ1VVEZsjQvRHr3AXxCU9YyA7ZpZLstrSh9KW1FxCG31B2Wol62NFJJPXt7QXs9P6VOzfoem4g2EgCFdW4YHMd0WanxzuYV7V/mQQ7n+3E17nbreh+DeMz0tserKjO3qc5skyC9dLfzLFPF2x461I3NvPPn02mN7nQfeladSyXYGbW1ByVmU0erjD7Ewom9t0L7kk4TLHT2ZbBTsTSMZtg7e017eTyuGCzt9XvNoTFxzYWxGfiVubu3nhpkYmIqYIFvxzhhdm/C4GbRrnKsHMglL13o2ZYPsHOXg19eTyWQIs7eUUxkMZOavfe68+6jRI5ojTY0sznbbNg5DdBF8THG7oN4uMaOG9E5x+6i5mbVYqalyU+kmATsYJ1Kpz9O+m409XTsUKZaarxzqhPJsH6CVQ/HBFsxlb6RYSnhYreC1Jt7A1xCntKKcy0xfvX257Bq1ylrsbi7Qe9cFfvdE+9uqe/tdBKq2Kv47mWYHOE6KJrsrGyET9NF/bcf9BmtT/JIK6fSzB/R6xg0XnlGVuRdkDS6aqCev/TEMTH1oru9w7ENZLsQKfT8lLMw8W7FBTc/hsm/vWC2UuKbJzNi61i5/iGggIqd4VIOG/nf1qyYYkFK8Ptemd91vpFwtTTZtkEa/B/zrH5m3Rr0T1IbWyO0qKCXX1/jeC3MqvwsfmOplBk0L0Ip0uu+KBmC/bQ1IX93yAuY/toHlfehYoJMqlUl0hxUnFuAsXjI5RmBuTJ4rMOc+Pz/KGOz9t4abGPTb6/lEJvOtFTRhXMdSxnMVew5w/v63+P338LXi7H17ADzkmTLzplg7SEcm2nvLJhZgKNxEcRLHF8tEWE+JRtgPXNzBXsPz5Vj7+pvr6KlpZcsBCvYzUs0/W5TF9QOXEtM1ewp5++eP8spbSOn0BhFS0M8kcpjWNjeXDqvjsUrNMtellF9bNlZgKNxEcsrWu74vG5eg9KG56RT2V4UW0blfZR6Z6ILIjP88dPI/EZESnhNRiVE6xXqpt2TFLP6YL98r+xN00N/aYnWKlv0rTQrqb2O7nBZOgovhwxU7wZIu9bCqXNm24VIf0MagJdFZ8p6Tjs9AfTjIO4jASqbP+O10De5a8XnI3+Cno3YW58Pn6qnn/+ckULX6UUrKYLaa8Zt9mZaFCsCfbw6x9+/+t/i7z7+Do6xij1TZ4Dq9yheKcD/abOLVF/0pE2K/x6q3mpSRmjUFl2z8ueVPU7ixLoyviIm+rwppcHs0RifPztBCFqngyujBjGxyw9YSctc+Pz9K4o3j/+avoYNT3utLPJns6uKknb1SIL9n9//eMvF/7zv6K1UGydUl8mPNnuZlPDzPFeadfxq1hb1inEvlrZXmD7yuW/efs0XFU8IunNq+NTqks4+nVpIFcVRqv54xrnaAUUfIOx8anshbK3AydxlNaRNj6rChYY5s7Xtm+l2oYo2PMffvd3v7/w2x/+8Vt8GdeH7s5J9qq/sr9CQDhjZgaU3rk9N7w8D3oqoR2Xt89nm0qnaD1s7+fgnWdUr72RPvLr4zPcKYGwAqpM7RpWULZ2quQKqHStvBYfp1b9ZOy+1Oa4hPdm5I+0qfR0Vxudmsw52wRMidZF/PM///LXP/9menHe59Z+2JNGyiFWHK+ZrlPn7L3vj7LMEt3dzE+jE2BGK+dlMLqJH5G8r1fGJ7ZX4/T2zDy1vy7nv9/UMP7Svda5Dt/ZvObFx1+p3xs46+FJHJ+1BevqqHNdOQ+O1NQ1i1AnOf77D7//12uK600+9PorU2Q7tfc0sb+N0fX36gDYmzEMOy7nc2m6U8EWTY/Ke6V7PUkCXRmfqyubCNHjbyog23k8VYMK6Fxv+mz8Mi+6rmZ4XnVCzdORNj4rC2ZOPlZt76fHafyr09NJfKK5cJW0ab8qM5puXyz9xaMNjffdbtvglCeveo188m0XqX3UpZp3En5IugQaYyQ+5XDJqZ+gHTy6+3HaTm8zxqya27SfYwL68Tl38bHVy2DmxO98aqx2Ij4PZ3OsZ78rbE7wRIeg1xmX+ERzYc81NR+n0cKMp5v5u7AXWba50R2Kq3fN9c51hesPmdxn7xLEtVylqcntXJzZVHD+dppbehTGGYtP2V+w9xmG73cVkPdRu/i4gWS/AmoG7KdejVJ5XYpgaNcxd9ZstRPx2bA9bzcZbTuHMcMizgkkPtFcBGd/T+5jL83AqBuHdyeKq3qCuDcX6Jd3ka9q55gjZwOrIH3a5Z29ieZZE59oDvvLp3IwUir9xetguVHjKXJatO3x2QrIYKqXMD5Bh32f8Vm8Pwtwow/7ocQ6ib0sVXxb2oINT6S6c5VBJesE8wdnQfYM64v+EM6R6jSFysIaehCf0j4ujV1l18mr7MRQQx2yk1GwfSXWY4n3s1cjdXw2pOtDmb6UjXRfMPdBaD+vVC0Yg42caK7MNTpVUN2W7aPSLOf7V3rdwjIozY3dtmPuRz4an7J7WHZeNXN69rSva+Gj8ekzWgGtRvL4bMjJr+U9wU6DhaaeRc35fbAqmOSMztF0LZd/YY59u1QvYlqH5F/HMIdVNuKYK7bs3Llt3W18xg3y27utyPt1ni0Yfg8zvErIvTplNJZZsLFnYe+2NLli/5on25NeMGeQ+bSaoahp98vu+ansmn3Pod4ZD7P8ltyeYBE8l/zR15RV8wl26gt2cjvVc98aFZ48K2fsQHIyCFY5wQz2met/VO4TLP0KyK5xoxXQPrGTSEHeTug/ZBSs/1539YWZf/ffGlTFu8idhlyCDWafTuPxcRWQq3/KW62A9oqZ/LAv2M9BJJtg8UGXPbd1GPIkUBmrgLwp4t5bZeWdqe8a+qT7NZ+7EczUgPZ5O0mgfRK5BItI5F15MKPkrciVQCOzPtF3hpQJ92kZdyWYOx/r9SFkw1YUrLJTnDMK3owVBVt+4dsGHEiwcsIoJPqiw6b15OnbdQU7IJkSiPhMKC1t2W522ns6XEgupD2dcsUcQTbBZqy8SxBM5oiCmcHT8Lo0bUjVfAH+qvnbLIL1JwmPTC7Bkha7IQcSrArOArVPvXfN62V0bVtGbz0NBFPIkkDEZ1Jpab/gXDZ/ur/deKx073rWCdfO9P7rZBLsVjpAeRKICmhaaUkFC6wxEvlX6fkP/WXHyphGesFOp1uqoDMJRgUkl9b+zyeYfepmPMJ3J5UxhRyC3VIFnUcw4qOUlkOw3tOy++fPLPbf7RcRfVUmi2A3NIZPn0BUQBNKSy7YUCH3RqxLaPuQZvqjUmcY4yQX7Ja6PzU5BKMC0kpL/gvcohzR82HeZL6berye9IId8XIEgTyC3Q4ZBbvux7Rl5tjhTptVV1y60SODYLdF6gSihZ9UWiLBysGDq1Yu/S8tIFgWkguWtLztySVYkU6wsponWJXia1MIpoBgMlkFWzoK86+O2ojUgt1W/6dCMI3cgi0qf9n8RBKSCzZ7T3YKgsmsLtgVGzT3oJg3wZ6GxILdXAOWOoFuLkC5LpXqBBuWf6Vg7YPtvqGKYAqpBUta3A5YS7BiuIjGLm6rgGAKaROI+EwtreiemD4igjXcXP4gmEJuwaqBYJO3WCbaqUWkvxbxxkAwmZUEK64VrESwY5ArgW6FbIIVCwXbcGLDB8EUEEwmn2BFKFh4HbDKlue+fBBMAcFk8gvWznVUVwmm3lxjNRBMAcFkNhBM3mTZ/DnCrcURrAbBZLLFZ0SwQmvCyubPPpqvCsFUEExmfcHkTbZqIdhhQDCZ7IJVRjA751H0F3V01/XuRq8Fgj2+Ll7t7EesszD3iIjPwtL6gtmmrHc/gWAHNv92yoC5gtU/Yv3w8gsJNALxWVqam5fvnhTNqbHCqBdO43eUzZ9bEKzJnKef/kICxSE+S0uLC1aYZ4FgpVmpeZDga8jpbrczuwX7WP8+/NNv35BAUYjP0tIGglWBYPZ+AvWrI7cPnb0TOxDsMsZ4f/l76QVdsc4RmT8GIz7LSgsEax4UhS/Y5V/ZvlomEqwoek2ldzpudpmz3kq6zr5hFlEmf3y8aY2icI/qf2X7uGweLPvicitVUXSSVeGWguWuK3fWWxYG8TLEZ3lpJuWtYKWd57gY1TRgtWBLbr1ROLzZy7bpLALHrm7RaMEUaMFk0h5RGd2E35p0N9y1gpW1X8Xk+27Ed9fI5TWX3mNfqqJnWGH/XLVB7S1xH2+LVEdEfKZQRjcRCtaeSbaC1c+LySe/op/AyI26vc/LjcjCKcZC/VhnC/bQFPzi0zXrHJG5R0R85lBGN+H32uytDitfsKKc+P0vQbDohoOHznQz01ioFefsafoP9SRZ9fj9t+nrHJK50/TEZw5ldBN+p8381GuzZNM5rB8WU09+xQWbtKKvW9B0FeOKzhesG70ziB+B+MzC+5ZJ6TbhCWYvhWqW7PqMzRvTNhBpbqZ13EPB3Gyj3bOx9YQipe2ZGpoTqXGIzyx8wUq7CW8bZWF+56RZMpjxUynMZHzw4uSRsTjUGpvNnz0Ge3zNGEOC+MzB+ybyiGD+o6sFawdSoVPpZrGCweJiwdKts2+YppeZXwG9+Pd3Re9CF/9k1kCw0v4x75du81N7ee6hffWKnVaLL4rBiTNhBbXIh1fXr3M0lhwR8Rnl+ecvTz9+qp7+IZwECgQrzSaK9nlVBVMZwbShvhtN7ntPuvmJhGdO3LmEKYMzBGtBMJn5k0D1BFB/EigqWOWejwsmnuztThcHL/VPIaeiPxgTllTLIoFkiM8oXQvWP41RmmnC/g82xL6qHDwZV6UIzmF5LyduwEa2PuutpOvsG8ZgMvNPxMfGYIUmWBW85q8pCzZ8uyjcVY4ZQTAFBJNJHR93outqweK7UnTXXcTeWOHjQDAFBJNZdkRuDGbm4NyP5vUEi1xuGD4buwwq1j8cXz41CKaAYDLJ41Mam3x/zL3YyuhaZuW4YKNvrfJpIJgCgslkik9MMO16w/Aq9/DFzQKPYAoIJjN/kkO+0iUmmHbBYUSwzb8hhGAKCCYzd5pe+7ZB6TdYky+Vdxd2tKe51hlnSSCYAoLJzD/R7P2LlFZWrsGa9l3Kym+4zP0FNg84gikgmMzCFmz02wZl5Qt27e50M4cItn8QTGbuEU35tkHZ+z9ld+ycRuSbKVuAYAoIJpMzPmXv/5QCwgugEGz3IJhMZsHK7v/0EoJ7ZGwfbwRTQDCZrIK5Ly9fUYRym6eVQTAFBJPJGp/SXJZ4TRHFsJwNQTAFBJPZnWAVgh0KBJPZn2D7AsEUEEwmt2DqJb47B8EUEEwms2A7+73K60EwBQSTyS/YoXuICKaBYDJ5BUta+CYgmAKCyRAfGQRTIIFkiI8MgimQQDLERwbBFEggGeIjg2AKJJAM8ZFBMAUSSIb4yCCYAgkkQ3xkEEyBBJIhPjIIpkACyRAfGQRTIIFkiI8MgimQQDLER2aRYM8fezcFuq8AqRCfbUvbA3MFe3rX3vvg5dh97W6FmUdEfHZQ2h6Y3YI9vn5LDS1AfLYvbQ8s6CJ+ffEnEkiA+Gxd2h5YMgZ7/tC/Met9BUiD+Gxc2h5gFlGBBJIhPjILBRv/dYxbYdkREZ8tS9sDtGAKJJAM8ZFJJlixs1sWpyLVERGf9UvbA7MF034C9FaYe0TEZ/vS9sBcwdSfAL0VZh4R8dlBaXtg9pUc2k+A3gpzr+QgPtuXtgeWtmCjPwF6KyxswYjPhqXtgQWXSjHGkCA+25e2B5imVyCBZIiPzCLBHl5dv87RWHJExGfb0vYAgikgmAyCySCYAoLJIJgMYzAFEkiG+MggmAIJJEN8ZBBMgQSSIT4yCKZAAskQHxkEUyCBZIiPDIIpkEAyxEcGwRRIIBniI4NgCiSQDPGRQTAFEkiG+MggmAIJJDP3+3Lv3iYsbccgmAKCycz+Quq/9O4qvqS0HYNgCggmM/8b30/viveJStsxCKaAYDLzBbv8/XzXP46BYDUIJrNIsFSl7RgEU0AwGeIjg2AKJJDMsiNyDdkd3pgVwWoQTIb4yCCYAgkkQ3xkEEyBBJKZe0TcWhzBGhBMZuYRcWtxBGtBMJll0/R3fWtxBKtBMJmFLdg931ocwWoQTGbuEXFrcQRrQDAZ4iODYAokkAzxkUkt2O0xO7TEh/gUUnzS1yZXlHikRZOx+ZEQnzUXRbC12fxIiM+aiyLY2mx+JMRnzUURbG02PxLis+aiCLY2mx8J8VlzUQRbm82PhPisuejtnZMA2BEIBpARBAPICIIBZATBADKCYAAZQTCAjCAYQEYQDCAjaQR7/lAUr5q7dL0P/0b5+nbiol+nlzp50eYOLMPlhN1NAPGRueH4pBHs66v6BidPP356fPPF/xtd+PH122rSoo/ff5ta6uRFn969/BLZurC7KSA+Mjccn3RdxK9v6738+Mn/G1vu+ePv3laTFv3a/D7ipEWHC8UXff75L5caaOrSSSE+Mjcan2SCXZrOh0sj+/m9/ze24Ne3lwOftOjnf3p9abenlfr4+sWnSYvWTfxwufGCU0F8ZG41PqkEu7SR0w7l4vrkAH33bepxPHxXN/E7TiDiI3Oz8Ukk2OOvPk1sjL/W9wiZ1huo93hix6EZ976asujTJl0g4iNzu/FJI1g7wJs6Kv46cZDaVgvTFq0rq7dTFq0DtPognvjI3HB80gj2ualWckyzTl30866noYmPzA3HhxPNABlBMICMIBhARhAMICMIBpARBAPICIIBZATBADKCYAAZQTCAjCAYQEYQDCAjCAaQEQQDyAiCAWQEwQAygmAAGdmbYI/ffzMPnz9kvY3RMSE+MruLD4IdC+Ijs7v47E+w//nhXX17hK/F3/z9+/pWB6/q2289f3i79Z7tA+Ijs7v47FCwN1+efvry+ObL4+v3dX30+X31+e3nV1vv2E4gPjK7i88OBWtuMVffOejz+4f2bkPPH777pq96FxAfmd3FZ+eCtRVPc19jqCE+MruLz14Fq2/m+O79468+XYaq9U2NqaJbiI/M7uKzV8Eug9QXf9sOUp8/1HdoZZDRQHxkdhefvQkGcFMgGEBGEAwgIwgGkBEEA8gIggFkBMEAMoJgABlBMICMIBhARhAMICMIBpARBAPICIIBZATBADKCYAAZ+X/8CMSzUKgSuAAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(phi) {</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  phi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(phi)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(phi); n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(phi)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  phi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(phi)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(phi.means)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  phi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(phi, <span class="dv">1</span>, var)</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(phi.w)</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n <span class="sc">+</span> B <span class="sc">/</span> n</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a><span class="co"># plot of R_hat</span></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>plot_R_hat <span class="ot">&lt;-</span> <span class="cf">function</span>(phi) {</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>  rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N) {</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>    rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(phi[, <span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;R&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.25</span>))</span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">1.2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_R_hat</span>(phiX)</span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_R_hat</span>(phiY)</span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_R_hat</span>(phiXY)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
Either from the ergodic mean plot, or from the plot of <span class="math inline">\(\hat{R}\)</span>, we could know the chain has
converged.</p>
<hr />
<p>Finally, we fit the simple linear regression model.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>lm.fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.fit)</span></code></pre></div>
<pre><code>
Call:
lm(formula = Y ~ X)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.6735 -0.2936 -0.0031  0.2880  1.8174 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.003977   0.004604  -0.864    0.388    
X            0.901263   0.004567 197.323   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.4366 on 8998 degrees of freedom
Multiple R-squared:  0.8123,    Adjusted R-squared:  0.8123 
F-statistic: 3.894e+04 on 1 and 8998 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The coefficients of the fitted model <span class="math inline">\(0.9012633\)</span> is close to the true value
<span class="math inline">\(0.9\)</span>. Then we check the residuals of
the model for normality and constant variance. Theoritically, the
variance of <span class="math inline">\(e\)</span> is <span class="math display">\[\textsf{Var}(e)=\textsf{Var}(Y-0.9X)=\textsf{Var}(Y)+0.9^2\textsf{Var}(X)-2\times0.9\textsf{Cov}(X,Y)=0.19.\]</span></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> lm.fit<span class="sc">$</span>residuals</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>qx <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.01</span>)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(e, <span class="at">breaks =</span> <span class="st">&quot;Scott&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(qx, <span class="fu">dnorm</span>(qx, <span class="dv">0</span>, <span class="fu">sqrt</span>(<span class="fl">0.19</span>)), <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(e)</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(e, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the histogram and QQ-plot, we can say that the residual is from
the normal distribution with constant variance.</p>
<hr />
</div>
</div>
<div id="assignment-07" class="section level2">
<h2>Assignment 07</h2>
<hr />
<div id="exercise-9.4-1" class="section level3">
<h3>Exercise 9.4</h3>
<p><strong>Problem.</strong> Implement a random walk Metropolis sampler
for generating the standard Laplace distribution, whose density function
is <span class="math display">\[f(x)=\dfrac{1}{2}\text{e}^{-|x|},\quad
x\in\mathbb R.\]</span> For the increment, simulate from a normal
distribution.</p>
<ul>
<li>Compare the chains generated when different variances are used for
the proposal distribution.</li>
<li>Compute the acceptance rates of each chain.</li>
<li>Use the Gelman-Rubin method to monitor convergence of the chain, and
run the chain until it converges approximately to the target
distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</li>
</ul>
<p><strong>Solution.</strong> Implementation of a random walk Metropolis
sampler for this problem is as follows.</p>
<ul>
<li>Set <span class="math inline">\(g(\cdot\mid X)\)</span> to the
density of <span class="math inline">\(N(X,\sigma^2)\)</span>.</li>
<li>Generate or initialize <span class="math inline">\(X_1\)</span>.</li>
<li>Repeat for <span class="math inline">\(t=2,\dots,N\)</span>:
<ul>
<li>Generate <span class="math inline">\(Y\)</span> from <span class="math inline">\(N(X_{t-1},\sigma^2)\)</span>.</li>
<li>Generate <span class="math inline">\(U\)</span> from <span class="math inline">\(U(0,1)\)</span>.</li>
<li>Compute accept probability <span class="math inline">\(\alpha(X_{t-1},Y)=\dfrac{f(Y)}{f(X_{t-1})}=\dfrac{\text{e}^{-|Y|}}{\text{e}^{-|X_{t-1}|}}=\text{e}^{|X_{t-1}|-|Y|}\)</span>.</li>
<li>If <span class="math inline">\(U\leq\alpha(X_{t-1},Y)\)</span>,
accept <span class="math inline">\(Y\)</span> and set <span class="math inline">\(X_t=Y\)</span>, otherwise set <span class="math inline">\(X_t=X_{t-1}\)</span>.</li>
<li>Increment <span class="math inline">\(t\)</span>, and back to the
first step in loop.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clear memory and set seed</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22034</span>)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>rl.metropolis <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sigma: sd of proposal distribution N(xt,sigma^2)</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># x0: initial value</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># N: length of chain</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># to calculate acceptance rate</span></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[t<span class="dv">-1</span>], sigma)</span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (u[t] <span class="sc">&lt;=</span> <span class="fu">exp</span>(<span class="fu">abs</span>(x[t<span class="dv">-1</span>]) <span class="sc">-</span> <span class="fu">abs</span>(y))) { x[t] <span class="ot">&lt;-</span> y; k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span> }</span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> { x[t] <span class="ot">&lt;-</span> x[t<span class="dv">-1</span>] }</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">mc =</span> x, <span class="at">acc.prob =</span> k <span class="sc">/</span> N))</span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">16</span>)</span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb77-27"><a href="#cb77-27" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> k, <span class="at">ncol =</span> N)</span>
<span id="cb77-28"><a href="#cb77-28" aria-hidden="true" tabindex="-1"></a>acc.prob <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb77-29"><a href="#cb77-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb77-30"><a href="#cb77-30" aria-hidden="true" tabindex="-1"></a>  rl <span class="ot">&lt;-</span> <span class="fu">rl.metropolis</span>(sigma[i], x0[i], N)</span>
<span id="cb77-31"><a href="#cb77-31" aria-hidden="true" tabindex="-1"></a>  X[i, ] <span class="ot">&lt;-</span> rl<span class="sc">$</span>mc</span>
<span id="cb77-32"><a href="#cb77-32" aria-hidden="true" tabindex="-1"></a>  acc.prob[i] <span class="ot">&lt;-</span> rl<span class="sc">$</span>acc.prob</span>
<span id="cb77-33"><a href="#cb77-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb77-34"><a href="#cb77-34" aria-hidden="true" tabindex="-1"></a>acc.prob</span></code></pre></div>
<pre><code>## [1] 0.8246 0.7034 0.3394 0.0975</code></pre>
<p>As we can see, only the acceptance rate of second chain is much more
favorable. Next we draw the sample path for each chain.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(X[i,], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="fu">bquote</span>(sigma <span class="sc">==</span> .(sigma[i])),</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&quot;X&quot;</span>, <span class="at">ylim =</span> <span class="fu">range</span>(X[i,]))</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Next we plot the histogram with the true density besides.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">6</span>, <span class="fl">0.01</span>)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>fx <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x)) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(X[i, <span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)], <span class="at">breaks =</span> <span class="st">&quot;Scott&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="fu">bquote</span>(sigma <span class="sc">==</span> .(sigma[i])), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">6</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),)</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(x, fx, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the plots above, we can draw to the same conclusion to the
previous part, that is, the second chain is more suitable. Next, we
compare the quantiles.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fu">rev</span>(z), z) <span class="co"># generate laplace random numbers</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.1</span>), <span class="fl">0.95</span>)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>Q <span class="ot">&lt;-</span> <span class="fu">quantile</span>(z, p)</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>mc <span class="ot">&lt;-</span> X[, <span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)]</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>Qmc <span class="ot">&lt;-</span> <span class="fu">apply</span>(mc, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">quantile</span>(x, p))</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>QQ <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">round</span>(<span class="fu">cbind</span>(Q, Qmc), <span class="dv">3</span>))</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(QQ) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;True&#39;</span>, <span class="st">&#39;sigma=0.5&#39;</span>, <span class="st">&#39;sigma=1&#39;</span>, <span class="st">&#39;sigma=4&#39;</span>, <span class="st">&#39;sigma=16&#39;</span>)</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(QQ)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">True</th>
<th align="right">sigma=0.5</th>
<th align="right">sigma=1</th>
<th align="right">sigma=4</th>
<th align="right">sigma=16</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">5%</td>
<td align="right">-2.243</td>
<td align="right">-2.555</td>
<td align="right">-2.115</td>
<td align="right">-2.232</td>
<td align="right">-2.264</td>
</tr>
<tr class="even">
<td align="left">10%</td>
<td align="right">-1.708</td>
<td align="right">-1.543</td>
<td align="right">-1.516</td>
<td align="right">-1.602</td>
<td align="right">-1.660</td>
</tr>
<tr class="odd">
<td align="left">20%</td>
<td align="right">-0.936</td>
<td align="right">-0.777</td>
<td align="right">-0.854</td>
<td align="right">-0.903</td>
<td align="right">-0.857</td>
</tr>
<tr class="even">
<td align="left">30%</td>
<td align="right">-0.572</td>
<td align="right">-0.402</td>
<td align="right">-0.464</td>
<td align="right">-0.511</td>
<td align="right">-0.524</td>
</tr>
<tr class="odd">
<td align="left">40%</td>
<td align="right">-0.278</td>
<td align="right">-0.135</td>
<td align="right">-0.191</td>
<td align="right">-0.229</td>
<td align="right">-0.220</td>
</tr>
<tr class="even">
<td align="left">50%</td>
<td align="right">0.000</td>
<td align="right">0.078</td>
<td align="right">0.015</td>
<td align="right">-0.010</td>
<td align="right">-0.027</td>
</tr>
<tr class="odd">
<td align="left">60%</td>
<td align="right">0.278</td>
<td align="right">0.329</td>
<td align="right">0.224</td>
<td align="right">0.193</td>
<td align="right">0.202</td>
</tr>
<tr class="even">
<td align="left">70%</td>
<td align="right">0.572</td>
<td align="right">0.660</td>
<td align="right">0.491</td>
<td align="right">0.464</td>
<td align="right">0.527</td>
</tr>
<tr class="odd">
<td align="left">80%</td>
<td align="right">0.936</td>
<td align="right">1.093</td>
<td align="right">0.881</td>
<td align="right">0.881</td>
<td align="right">0.966</td>
</tr>
<tr class="even">
<td align="left">90%</td>
<td align="right">1.708</td>
<td align="right">1.853</td>
<td align="right">1.530</td>
<td align="right">1.636</td>
<td align="right">1.581</td>
</tr>
<tr class="odd">
<td align="left">95%</td>
<td align="right">2.243</td>
<td align="right">2.657</td>
<td align="right">2.197</td>
<td align="right">2.448</td>
<td align="right">2.333</td>
</tr>
</tbody>
</table>
<p>As we can see, the quantiles of the second or third chain are close
to the true quantiles of standard Laplace distribution.</p>
<hr />
<p>Finally, we use the Gelman-Rubin method to monitor convergence of the
chain. Suppose we are interested in the mean, i.e.Â <span class="math inline">\(\phi_{it}\)</span> denotes the sample mean until
the <span class="math inline">\(t\)</span>-th replicates in the <span class="math inline">\(i\)</span>-th chain.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(phi) {</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  phi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(phi)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(phi); n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(phi)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  phi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(phi)</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(phi.means)</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>  phi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(phi, <span class="dv">1</span>, var)</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(phi.w)</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n <span class="sc">+</span> B <span class="sc">/</span> n</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a><span class="co"># ergodic mean plot</span></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>phi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(phi)) {</span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>  phi[i,] <span class="ot">&lt;-</span> phi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(phi))</span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>((b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N, phi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>),</span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="st">&#39;Index&#39;</span>, <span class="at">ylab =</span> <span class="fu">bquote</span>(phi))</span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> { <span class="fu">lines</span>(phi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">col =</span> i) }</span>
<span id="cb82-23"><a href="#cb82-23" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot of R_hat</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N) {</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(phi[, <span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;R&quot;</span>)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">1.2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Either from the ergodic mean plot, or from the plot of <span class="math inline">\(\hat{R}\)</span>, we could know the chain has
converged.</p>
<hr />
</div>
<div id="exercise-9.7-1" class="section level3">
<h3>Exercise 9.7</h3>
<p><strong>Problem.</strong> Implement a Gibbs sampler to generate a
bivariate normal chain <span class="math inline">\((X_t,Y_t)\)</span>
with zero means, unit standard deviations, and correlation <span class="math inline">\(0.9\)</span>.</p>
<ul>
<li>Plot the generated sample aftering discarding a suitable burn-in
sample.</li>
<li>Use the Gelman-Rubin method to monitor convergence of the chain, and
run the chain until it converges approximately to the target
distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</li>
<li>Fit a simple linear regression model <span class="math inline">\(Y=\beta_0+\beta_1X\)</span> to the sample and
check the residuals of the model for normality and constant
variance.</li>
</ul>
<p><strong>Solution.</strong> To generate a bivariate normal chain <span class="math inline">\((X_t,Y_t)\)</span> from <span class="math inline">\(N(\mu_1,\mu_2,\sigma_1^2,\sigma_2^2,\rho)\)</span>,
we notice that <span class="math display">\[\begin{align*}
X\mid Y=y&amp;\sim
N\left(\mu_1+\rho\dfrac{\sigma_1}{\sigma_2}(y-\mu_2),(1-\rho^2)\sigma_1^2\right),\\
Y\mid X=x&amp;\sim
N\left(\mu_2+\rho\dfrac{\sigma_2}{\sigma_1}(x-\mu_1),(1-\rho^2)\sigma_2^2\right).
\end{align*}\]</span></p>
<p>So we implement the Gibbs sampler below and plot the generated sample
aftering discarding a suitable burn-in sample.</p>
<ul>
<li>Set initial value <span class="math inline">\(X_1\)</span>, <span class="math inline">\(Y_1\)</span>.</li>
<li>Repeat for <span class="math inline">\(t=2,\dots,N\)</span>:
<ul>
<li>Generate <span class="math inline">\(X_t\sim f_{X|Y}(x\mid
Y_{t-1})\)</span>.</li>
<li>Generate <span class="math inline">\(Y_t\sim f_{Y|X}(y\mid
X_t)\)</span>.</li>
<li>Increment <span class="math inline">\(t\)</span>, and back to the
first step in the loop.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clear memory and set seed</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="co">#rm(list = ls())</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22034</span>)</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>rbn.metropolis <span class="ot">&lt;-</span> <span class="cf">function</span>(mu, sigma, rho, initial, N) {</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mu, sigma, rho: parameter of bivariate normal distribution.</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># initial: initial value</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># N: length of chain</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> Y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> rho<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> sigma</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>] <span class="ot">&lt;-</span> initial[<span class="dv">1</span>]; Y[<span class="dv">1</span>] <span class="ot">&lt;-</span> initial[<span class="dv">2</span>]</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> Y[i<span class="dv">-1</span>]</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>    m1 <span class="ot">&lt;-</span> mu[<span class="dv">1</span>] <span class="sc">+</span> rho <span class="sc">*</span> (y <span class="sc">-</span> mu[<span class="dv">2</span>]) <span class="sc">*</span> sigma[<span class="dv">1</span>] <span class="sc">/</span> sigma[<span class="dv">2</span>]</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>    X[i] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s[<span class="dv">1</span>])</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> X[i]</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>    m2 <span class="ot">&lt;-</span> mu[<span class="dv">2</span>] <span class="sc">+</span> rho <span class="sc">*</span> (x <span class="sc">-</span> mu[<span class="dv">1</span>]) <span class="sc">*</span> sigma[<span class="dv">2</span>] <span class="sc">/</span> sigma[<span class="dv">1</span>]</span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>    Y[i] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s[<span class="dv">2</span>])</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">X =</span> X, <span class="at">Y =</span> Y))</span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a>XY <span class="ot">&lt;-</span> <span class="fu">rbn.metropolis</span>(mu, sigma, rho, mu, N)</span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> XY<span class="sc">$</span>X[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)]; Y <span class="ot">&lt;-</span> XY<span class="sc">$</span>Y[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)]</span>
<span id="cb84-31"><a href="#cb84-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X, Y, <span class="at">xlab =</span> <span class="fu">bquote</span>(X[t]), <span class="at">ylab =</span> <span class="fu">bquote</span>(Y[t]),</span>
<span id="cb84-32"><a href="#cb84-32" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">cex =</span> <span class="fl">0.5</span>, <span class="at">ylim =</span> <span class="fu">range</span>(Y))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(<span class="fu">cbind</span>(X, Y))</span></code></pre></div>
<pre><code>##           X         Y
## X 1.0016672 0.9038199
## Y 0.9038199 1.0079449</code></pre>
<p>From the result above, we can conclude that the chain has converged
for the sample covariance matrix is close to the truth. Next, we use
different initial values to monitor the convergence of two chains
(i.e.Â <span class="math inline">\(X_t\)</span> and <span class="math inline">\(Y_t\)</span>), with <span class="math inline">\(\phi_{it}\)</span> denotes the sample mean until
the <span class="math inline">\(t\)</span>-th replicates in the <span class="math inline">\(i\)</span>-th cain, respectively. Notice that we
calculate the sample mean of <span class="math inline">\(X_tY_t\)</span>
for monitering the convergence of covariance.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> k)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>Xmc <span class="ot">&lt;-</span> Ymc <span class="ot">&lt;-</span> XYmc <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> k, <span class="at">ncol =</span> N)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  XY <span class="ot">&lt;-</span> <span class="fu">rbn.metropolis</span>(mu, sigma, rho, x0[,i], N)</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  Xmc[i,] <span class="ot">&lt;-</span> XY<span class="sc">$</span>X; Ymc[i,] <span class="ot">&lt;-</span> XY<span class="sc">$</span>Y</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>  XYmc[i,] <span class="ot">&lt;-</span> Xmc[i,] <span class="sc">*</span> Ymc[i,]</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a><span class="co"># ergodic mean plot</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>cal_phi <span class="ot">&lt;-</span> <span class="cf">function</span>(X) {</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>  phi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(phi)) {</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>    phi[i,] <span class="ot">&lt;-</span> phi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(phi))</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(phi)</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>phiX <span class="ot">&lt;-</span> <span class="fu">cal_phi</span>(Xmc)</span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>phiY <span class="ot">&lt;-</span> <span class="fu">cal_phi</span>(Ymc)</span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>phiXY <span class="ot">&lt;-</span> <span class="fu">cal_phi</span>(XYmc)</span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a>plot_erg_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(phi, rg) {</span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot</span>((b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N, phi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> rg,</span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab =</span> <span class="st">&quot;Index&quot;</span>, <span class="at">ylab =</span> <span class="fu">bquote</span>(phi))</span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> { <span class="fu">lines</span>(phi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">col =</span> i) }</span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb87-30"><a href="#cb87-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-31"><a href="#cb87-31" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb87-32"><a href="#cb87-32" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_erg_mean</span>(phiX, <span class="at">rg =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb87-33"><a href="#cb87-33" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_erg_mean</span>(phiY, <span class="at">rg =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb87-34"><a href="#cb87-34" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_erg_mean</span>(phiXY, <span class="at">rg =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">1.1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(phi) {</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  phi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(phi)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(phi); n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(phi)</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  phi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(phi)</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(phi.means)</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  phi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(phi, <span class="dv">1</span>, var)</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(phi.w)</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n <span class="sc">+</span> B <span class="sc">/</span> n</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a><span class="co"># plot of R_hat</span></span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>plot_R_hat <span class="ot">&lt;-</span> <span class="cf">function</span>(phi) {</span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>  rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N) {</span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>    rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(phi[, <span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;R&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.25</span>))</span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">1.2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_R_hat</span>(phiX)</span>
<span id="cb88-24"><a href="#cb88-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_R_hat</span>(phiY)</span>
<span id="cb88-25"><a href="#cb88-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_R_hat</span>(phiXY)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
Either from the ergodic mean plot, or from the plot of <span class="math inline">\(\hat{R}\)</span>, we could know the chain has
converged.</p>
<hr />
<p>Finally, we fit the simple linear regression model.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>lm.fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.fit)</span></code></pre></div>
<pre><code>
Call:
lm(formula = Y ~ X)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.90005 -0.29586  0.00312  0.29640  1.76383 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 0.002772   0.004626   0.599    0.549    
X           0.902316   0.004620 195.288   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.4387 on 8998 degrees of freedom
Multiple R-squared:  0.8091,    Adjusted R-squared:  0.8091 
F-statistic: 3.814e+04 on 1 and 8998 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The coefficients of the fitted model <span class="math inline">\(0.9023155\)</span> is close to the true value
<span class="math inline">\(0.9\)</span>. Then we check the residuals of
the model for normality and constant variance. Theoritically, the
variance of <span class="math inline">\(e\)</span> is <span class="math display">\[\textsf{Var}(e)=\textsf{Var}(Y-0.9X)=\textsf{Var}(Y)+0.9^2\textsf{Var}(X)-2\times0.9\textsf{Cov}(X,Y)=0.19.\]</span></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> lm.fit<span class="sc">$</span>residuals</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>qx <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.01</span>)</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(e, <span class="at">breaks =</span> <span class="st">&quot;Scott&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(qx, <span class="fu">dnorm</span>(qx, <span class="dv">0</span>, <span class="fu">sqrt</span>(<span class="fl">0.19</span>)), <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(e)</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(e, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the histogram and QQ-plot, we can say that the residual is from
the normal distribution with constant variance.</p>
<hr />
</div>
</div>
<div id="assignment-08" class="section level2">
<h2>Assignment 08</h2>
<hr />
<div id="mediating-effect" class="section level3">
<h3>Mediating Effect</h3>
<p><strong>Problem.</strong></p>
<p>Consider the model :</p>
<p><span class="math inline">\(M=a_M+\alpha X+e_M\)</span></p>
<p><span class="math inline">\(Y=a_Y+\beta M+\gamma X+e_Y\)</span></p>
<p><span class="math inline">\(e_M,e_Y\sim N(0,1)\)</span></p>
<p>Conduct a simulation study to test mediation effect.</p>
<p><span class="math inline">\(H_0:\alpha \beta =0 \leftrightarrow
\alpha \beta \neq 0\)</span></p>
<p>Under what parameters can the permutation be performed to ensure type
one error?</p>
<p>(1)<span class="math inline">\(\alpha =0\)</span></p>
<p>(2)<span class="math inline">\(\beta =0\)</span></p>
<p>(3)<span class="math inline">\(\alpha =0 \quad and\quad \beta
=0\)</span></p>
<p>Consider three parameter comboos</p>
<p>1.<span class="math inline">\(\alpha =0\quad \beta =0\quad
\gamma=1\)</span></p>
<p>2.<span class="math inline">\(\alpha =0\quad \beta =1\quad
\gamma=1\)</span></p>
<p>3.<span class="math inline">\(\alpha =1\quad \beta =0\quad
\gamma=1\)</span></p>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co">#data generation</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha,beta,gamma,N){</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  e_M <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  e_Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> alpha<span class="sc">*</span>x<span class="sc">+</span>e_M</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> beta<span class="sc">*</span>m<span class="sc">+</span>gamma<span class="sc">*</span>x<span class="sc">+</span>e_Y</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(x,m,y))</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="cf">function</span>(x,m,y){              <span class="co">#Test statistics</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x,m,y)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  f1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(m<span class="sc">~</span>x,<span class="at">data=</span>data)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  f2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>m<span class="sc">+</span>x,<span class="at">data=</span>data)</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  s_alpha <span class="ot">&lt;-</span> <span class="fu">summary</span>(f1)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  s_beta <span class="ot">&lt;-</span> <span class="fu">summary</span>(f2)<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">&lt;-</span> f1<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>f2<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sqrt</span>(f1<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>s_alpha<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>f2<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>s_beta<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.numeric</span>(t))</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Under <span class="math inline">\(\alpha =0\)</span> we permutate
x,under <span class="math inline">\(\beta =0\)</span> we permutate
y,under <span class="math inline">\(\alpha =0 \quad and\quad \beta
=0\)</span> we permutate m.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">499</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>N</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>test1 <span class="ot">&lt;-</span> <span class="cf">function</span>(data){</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>  reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">sample</span>(K,<span class="at">size =</span> N,<span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> data[k,<span class="dv">1</span>]</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>  reps[i] <span class="ot">&lt;-</span> <span class="fu">t</span>(x,data<span class="sc">$</span>m,data<span class="sc">$</span>y)</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>p_hat <span class="ot">&lt;-</span> (<span class="fu">sum</span>(<span class="fu">abs</span>(reps)<span class="sc">&gt;</span><span class="fu">abs</span>(<span class="fu">t</span>(data<span class="sc">$</span>x,data<span class="sc">$</span>m,data<span class="sc">$</span>y)))<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>R)</span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(p_hat<span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>test2 <span class="ot">&lt;-</span> <span class="cf">function</span>(data){</span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>  reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)</span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">sample</span>(K,<span class="at">size =</span> N,<span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> data[k,<span class="dv">3</span>]</span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a>  reps[i] <span class="ot">&lt;-</span> <span class="fu">t</span>(data<span class="sc">$</span>x,data<span class="sc">$</span>m,y)</span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a>  p_hat <span class="ot">&lt;-</span> (<span class="fu">sum</span>(<span class="fu">abs</span>(reps)<span class="sc">&gt;</span><span class="fu">abs</span>(<span class="fu">t</span>(data<span class="sc">$</span>x,data<span class="sc">$</span>m,data<span class="sc">$</span>y)))<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>R)</span>
<span id="cb94-22"><a href="#cb94-22" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(p_hat<span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb94-23"><a href="#cb94-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb94-24"><a href="#cb94-24" aria-hidden="true" tabindex="-1"></a>test3 <span class="ot">&lt;-</span> <span class="cf">function</span>(data){</span>
<span id="cb94-25"><a href="#cb94-25" aria-hidden="true" tabindex="-1"></a>  reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)</span>
<span id="cb94-26"><a href="#cb94-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb94-27"><a href="#cb94-27" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">sample</span>(K,<span class="at">size =</span> N,<span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb94-28"><a href="#cb94-28" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> data[k,<span class="dv">2</span>]</span>
<span id="cb94-29"><a href="#cb94-29" aria-hidden="true" tabindex="-1"></a>  reps[i] <span class="ot">&lt;-</span> <span class="fu">t</span>(data<span class="sc">$</span>x,m,data<span class="sc">$</span>y)</span>
<span id="cb94-30"><a href="#cb94-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb94-31"><a href="#cb94-31" aria-hidden="true" tabindex="-1"></a>  p_hat <span class="ot">&lt;-</span> (<span class="fu">sum</span>(<span class="fu">abs</span>(reps)<span class="sc">&gt;</span><span class="fu">abs</span>(<span class="fu">t</span>(data<span class="sc">$</span>x,data<span class="sc">$</span>m,data<span class="sc">$</span>y)))<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>R)</span>
<span id="cb94-32"><a href="#cb94-32" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(p_hat<span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb94-33"><a href="#cb94-33" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>stimulation <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha,beta,<span class="at">gamma=</span><span class="dv">1</span>,<span class="at">N=</span><span class="dv">50</span>){</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>type_1_error <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> <span class="dv">3</span>,<span class="at">ncol =</span> <span class="dv">200</span>)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>) {</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">model</span>(alpha,beta,gamma,N)</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  type_1_error[<span class="dv">1</span>,i] <span class="ot">&lt;-</span> <span class="fu">test1</span>(data)</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  type_1_error[<span class="dv">2</span>,i] <span class="ot">&lt;-</span> <span class="fu">test2</span>(data)</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>  type_1_error[<span class="dv">3</span>,i] <span class="ot">&lt;-</span> <span class="fu">test3</span>(data)</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">mean</span>(type_1_error[<span class="dv">1</span>,]),<span class="fu">mean</span>(type_1_error[<span class="dv">2</span>,]),<span class="fu">mean</span>(type_1_error[<span class="dv">3</span>,])))</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">stimulation</span>(<span class="at">alpha=</span><span class="dv">0</span>,<span class="at">beta=</span><span class="dv">0</span>)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">stimulation</span>(<span class="at">alpha=</span><span class="dv">0</span>,<span class="at">beta=</span><span class="dv">1</span>)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>s3 <span class="ot">&lt;-</span> <span class="fu">stimulation</span>(<span class="at">alpha=</span><span class="dv">1</span>,<span class="at">beta=</span><span class="dv">0</span>)</span></code></pre></div>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model1=</span>s1,<span class="at">model2=</span>s2,<span class="at">model3=</span>s3)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(result) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;test1&quot;</span>,<span class="st">&quot;test2&quot;</span>,<span class="st">&quot;test3&quot;</span>)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>result</span></code></pre></div>
<pre><code>##       model1 model2 model3
## test1  0.130  0.230  0.060
## test2  0.465  1.000  0.005
## test3  0.025  0.445  0.395</code></pre>
<hr />
</div>
<div id="logistic-regression" class="section level3">
<h3>Logistic Regression</h3>
<p><strong>Problem.</strong></p>
<p>Consider the model <span class="math inline">\(P(Y=1|X_1,X_2,X_3)=expit(a+b_1X_1+b_2X_2+b_3X_3)\)</span></p>
<p><span class="math inline">\(X_1\sim P(1),X_2\sim Exp(1),X_3\sim
B(1,0.5)\)</span></p>
<p>(1)Write a function to realize these above.Input <span class="math inline">\(N,b_1,b_2,b_3,f_0\)</span> then output alpha.</p>
<p>(2)Use the function,inputs are<span class="math inline">\(N=10^6,b_1=0,b_2=1,b_3=-1,f_0=0.1,0.01,0.001,0.0001\)</span>.</p>
<p>(3)plot <span class="math inline">\(f_0\)</span> vs alpha</p>
<p><strong>Solution.</strong></p>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(f0,<span class="at">N=</span><span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>,<span class="at">b1=</span><span class="dv">0</span>,<span class="at">b2=</span><span class="dv">1</span>,<span class="at">b3=</span><span class="sc">-</span><span class="dv">1</span>){</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(N,<span class="dv">1</span>)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(N,<span class="dv">1</span>)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(N,<span class="dv">1</span>,<span class="fl">0.5</span>)</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha){</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">exp</span>(alpha<span class="sc">+</span>b1<span class="sc">*</span>x1<span class="sc">+</span>b2<span class="sc">*</span>x2<span class="sc">+</span>b3<span class="sc">*</span>x3)</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>tmp)</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(p) <span class="sc">-</span> f0</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(g,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">100</span>,<span class="dv">100</span>))</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> solution<span class="sc">$</span>root</span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(alpha)</span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>f0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>,<span class="fl">0.0001</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">4</span>)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  alpha[i] <span class="ot">&lt;-</span> <span class="fu">f</span>(f0[i])</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="sc">-</span><span class="fu">log</span>(f0),alpha)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAWlBMVEUAAAAAACsAAFUAKysAK4AAVaorAAArACsrAFUrKysrgNRVAABVACtVqv+AKwCAVQCAgFWA1P+qVQCqqlWq1ICq/6qq///UgCvU////qlX/1ID//6r//9T///9yv819AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAG3klEQVR4nO2dC3OjNhRGiRtn23jjNrQbltj+/3+zSPIrIPEZ8RCEc2ac2SEyis9KVxK+iOwErWSp/4C5gyABggQIEiBIgCABggQIEiBIgCABggQIEiBIgCABggQIEiBIgCABggQIEiBIgCABggQIEiBIgCABggQIEiBIgCABggQIEiBIgCABggQIEiBIgCABggQIEiBIgCABggQIEiBIgCABggQIEiBIgCABggQIEiBIgCABggQIEiBIgCABggQIEiBIgCABggQIEiBIgCABggQIEiBIgCABggQIEiBIgCABggQIEiBIMLCgbDGkEjTs6Ubg7AZBAbK718NvGLj+OZNdfiLID4IECFIQgxRpRrHu04vU0IIECBIgSIAgAYIECBIgSIAgAYIECBKMJCjPsu1xX60o3gY5XULGEVQ8/64cbU+nw+51gNOlZBRBx32lpXx6PzlVfU+XlFEEHXZVzyo3H6fLz9tZWM0baEGKawyyqnqfLiWMYgLmQQIECRAkQJAAQQIECRAkQJAAQYJ1COqxOF6FoE5ZGp73dix42LkLFl8vZDx4lhSXO7K7n5Fv7lQwf/5dbE+fL6F16LD1DsDEgsxV1PL5d/BKz8D1DsDkgt5On39+2Fc83zgGmWtgh5/vSxI08ShWVNE5f11QF+tFzDCfb81IFjOIRdSbmlXMg/qAIEGEIHsxPnKi2L3e1MRMFPtFn471piZuoigxEj9fssx+edir3tTETRQV1s+P95bC31jQcb9VZW0jy22xNX71rJeppt2cv3ReW/LC5VKHGMVM6ylW24Ie4LDbfNylePQ9XUrGmiiWrpUFw9W3FmT7Wa+l6vcWdM6MCk5xhq03NTHDvBvEci53+Auai2WGkrWYv+ClBXHBLFSwtHl1RTC7bth6UxOzFntorjhUvanhgpkAQQIECcZZrA5Yb2ombkHf/nLH9PWmZuL0l+71pmZ56S8Td8/Fpb/0ydSIra9bwbTpL71yfeIr7FIwbfrLAgSlTX9ZgqC06S/zj0ET19t859xHsYnrTQ2CBKMKaplMrlvQA2v+dQs6lZnNXKAFBTnszCypKYjLHVfyp3daUCtF9oqgVj5f/kBQK8d9+MtFBE17uvFAkABBAgQJECRAkABBAgQJECQgeUFACxIgSIAgAYIECBIgSIAgAYIESQUtYb6YUtDUmSxRJBQ0eS5UFCMJKi6bkRfh7+bXLMjc0HrYmVueEeTD7bpw3Jtk4ZbsjvXGoMuWJiblvG1ritWOYteHReTbtha0CEaKQWct4WTYbDGMIuh6y+9x3ylbOFBJp8MjnqOVSfoEguIqQZCoBEGiEgSJShAkKkGQqARBohIEfQcQJECQAEECBAkQJECQAEECBAkQJECQAEECBAnGF1QEnzLh2XjY3Zrf2M/bPKqicfC8+Xfz9sfCd7Dl72hldEHmuzT/Du+lZ3dv+1CKZsmqoMsJaOA5bDIIyoYhcbt2kLEF2UdNeB9JUTWWpiDvZs3uG13/l7nNo66yvFaje65KxOZIk8Qgr6Di+e/mn1v4mom/WblfvTSeJ+MX5Bpx8GEFYSYR5NsHvvrUnhiU/1XFj/pnLje/ds2jrrynWXm72FlQ982gJxBU+j6c6TZNQW7ri7xWvDCZAIFu6tNWesKxCz8Ru2VP1MUaKkw0CG2fXw9ErgH6wpO3y7gnNNXNuSA9U0HND2LDSkhQfbBxgdg3BPnOcG4rDZ15lm1+/ZxnDGp+uCI0h7Gla0HZtR1PqPb2sLZwHLEH4tiCnBr/oxaa///+0i6zzXMO77ymrcY5DvPGwjU1rfmr+iE7RNdLF4Fz+JuJNwbZCWXEKD9BF8tDPckbQfylS8/gfwrm2ua+0mYRM8ulxtJBkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBgrkJuuxRVOO4fzMpM6+X7LFD90SfSBYiqNi6ZCCTn2FzNMpeD/PswDIEmaPm5XJgTI6MaVKTMEtB12yXvOpQ/5hGs/kwyfab/27pdf2eB/s4cxRkknVtwpNJhSpNzDFtxj5r+cc1nTMmGSqGGQpy/agS4JLp8qd3G36sulv+Yc/Hmj/MDAW5j179dHmGpRH01hDkT5EentkKqv5RXATZI7UutkJBJjX4tb0F3eVAr1CQpRmDirsYdBvm1xyDWkax20RxzaPY13nQ5l9jqXq5KeT1vsG1zoOa3OTcE1iSDM+cBZ0HL3urYP1eqNWuxb5QXu93qS+91ruanx0IEiBIgCABggQIEiBIgCABggQIEiBIgCABggQIEiBIgCABggQIEiBIgCABggT/A6kYFNnjC2sKAAAAAElFTkSuQmCC" /><!-- --></p>
<hr />
</div>
</div>
<div id="assignment-09" class="section level2">
<h2>Assignment 09</h2>
<hr />
<div id="em-algorithm" class="section level3">
<h3>EM algorithm</h3>
<p><strong>Problem.</strong></p>
<p><span class="math display">\[X_1, \dots, X_n
\overset{iid}{\sim}Exp(\lambda)\]</span></p>
<p>For some reasons, we only know that <span class="math inline">\(X_i\)</span> belongs to an interval <span class="math inline">\((u_i,v_i),i=1,\dots,n\)</span>, where <span class="math inline">\(u_i&lt;v_i\)</span> and both are known
constants.</p>
<p>(1). Obtain the estimators by observed likelihood function and ME
algorithm, then prove that they are equivalents.</p>
<p>(2). Suppose that we have observations of intervals <span class="math display">\[(11,12),(8,9),(27,28),(13,14),(16,17),(0,1),(23,24),(10,11),(24,25),(2,3)\]</span>
Now program to compute the numerical solutions of both methods.</p>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">gc</span>())</span></code></pre></div>
<p>rm(list=ls()) invisible(gc())</p>
<p><strong>Solution 1.1.</strong></p>
<p>(1). MLE</p>
<p><span class="math display">\[\begin{gather}
L_o\left(\lambda;u,v\right)=\prod_{i=1}^{n}{P_\lambda\left(u_i\le x_i\le
v_i\right)}=\prod_{i=1}^{n}{(e^{-\lambda u_i}-e^{-\lambda v_i})}\\

l_o\left(\lambda;u,v\right)=logL_o\left(\lambda;u,v\right)=\sum_{i=1}^{n}log\left(e^{-\lambda
u_i}-e^{-\lambda v_i}\right)\\

\frac{\partial
l_o\left(\lambda;u,v\right)}{\partial\lambda}=\sum_{i=1}^{n}\frac{v_ie^{-\lambda
v_i}-u_ie^{-\lambda u_i}}{e^{-\lambda u_i}-e^{-\lambda v_i}}

\end{gather}\]</span></p>
<p>Now, letâs compute its second order derivative.</p>
<p><span class="math display">\[\begin{align}
\frac{\partial^2l_o\left(\lambda;u,v\right)}{\partial\lambda^2}&amp;=\sum_{i=1}^{n}{-\frac{\left(v_ie^{-\lambda
v_i}-u_ie^{-\lambda u_i}\right)^2}{\left(e^{-\lambda u_i}-e^{-\lambda
v_i}\right)^2}}
+\sum_{i=1}^{n}\frac{u_i^2e^{-\lambda u_i}-v_i^2e^{-\lambda
v_i}}{e^{-\lambda u_i}-e^{-\lambda v_i}}\\

&amp;=\sum_{i=1}^{n}\frac{-\left(v_ie^{-\lambda v_i}-u_ie^{-\lambda
u_i}\right)^2+\left(e^{-\lambda u_i}-e^{-\lambda
v_i}\right)(u_i^2e^{-\lambda u_i}-v_i^2e^{-\lambda
v_i})}{\left(e^{-\lambda u_i}-e^{-\lambda v_i}\right)^2}\\

&amp;=\sum_{i=1}^{n}\frac{-\left(v_i^2e^{-2\lambda v_i}+u_i^2e^{-\lambda
u_i}-2u_iv_ie^{-\lambda\left(u_i+v_i\right)}\right)+u_i^2e^{-2\lambda
u_i}-u_i^2e^{-\lambda\left(u_i+v_i\right)}-v_i^2e^{-\lambda\left(u_i+v_i\right)}+v_i^2e^{-2\lambda
v_i}}{\left(e^{-\lambda u_i}-e^{-\lambda v_i}\right)^2}\\

&amp;=\sum_{i=1}^{n}\frac{-\left(u_i-v_i\right)^2e^{-\lambda\left(u_i+v_i\right)}}{\left(e^{-\lambda
u_i}-e^{-\lambda v_i}\right)^2}&lt;0
\end{align}\]</span></p>
<p>Hence the MLE is the root of <span class="math inline">\(\frac{\partial
l_o\left(\lambda;u,v\right)}{\partial\lambda}=0\)</span>.</p>
<p>(2). EM algorithms</p>
<p><span class="math display">\[\begin{gather}
L_c\left(\lambda;x\right)=\prod_{i=1}^{n}{\lambda e^{-\lambda
x_i}}=\lambda^ne^{-\lambda\sum_{i=1}^{n}x}\\

l_c\left(\lambda;x\right)=nlog\lambda-\lambda\sum_{i=1}^{n}x_i\\

E\left[l_c\left(\lambda;x\right)\middle|x_i\in\left[u_i,v_i\right]\right]=E\left[nlog\lambda-\lambda\sum_{i=1}^{n}x_i\middle|x_i\in\left[u_i,v_i\right]\right]
=nlog\lambda-\lambda
E\left[\sum_{i=1}^{n}x_i\middle|x_i\in\left[u_i,v_i\right]\right]\\

\frac{\partial
E\left[l_c\left(\lambda;x\right)\middle|x_i\in\left[u_i,v_i\right]\right]}{\partial\lambda}=\frac{n}{\lambda}-E\left[\sum_{i=1}^{n}x_i\middle|x_i\in\left[u_i,v_i\right]\right]=0

\end{gather}\]</span></p>
<p>Hence the iteration</p>
<p><span class="math display">\[\frac{n}{\lambda_{(t)}}=E_{\lambda_{(t-1)}}\left[\sum_{i=1}^{n}x_i\middle|x_i\in\left[u_i,v_i\right]\right]\]</span></p>
<p><span class="math display">\[\begin{align}

E_{\lambda}\left[\sum_{i=1}^{n}x_i\middle|x_i\in\left[u_i,v_i\right]\right]&amp;=\sum_{i=1}^{n}{\frac{1}{e^{-\lambda
u_i}-e^{-\lambda v_i}}\int_{u_i}^{v_i}{\lambda x e^{-\lambda x}dx}}\\

&amp;=\sum_{i=1}^{n}\frac{\left[-xe^{-\lambda
x}\right]_{u_i}^{v_i}-\left[\frac{1}{\lambda}e^{-\lambda
x}\right]_{u_i}^{v_i}}{e^{-\lambda u_i}-e^{-\lambda v_i}}\\

&amp;=-\sum_{i=1}^{n}\frac{v_ie^{-\lambda v_i}-u_ie^{-\lambda
u_i}}{e^{-\lambda u_i}-e^{-\lambda
v_i}}+\frac{1}{\lambda}\sum_{i=1}^{n}\frac{-\left[e^{-\lambda
x}\right]_{u_i}^{v_i}}{e^{-\lambda u_i}-e^{-\lambda v_i}}\\

&amp;=-\frac{\partial
l\left(\lambda;u,v\right)}{\partial\lambda}+\frac{n}{\lambda}

\end{align}\]</span></p>
<p>We have</p>
<p><span class="math display">\[\frac{n}{\lambda_{(t)}}=-\frac{\partial
l\left(\lambda;u,v\right)}{\partial\lambda}\bigg|_{\lambda=\lambda_{(t-1)}}+\frac{n}{\lambda_{(t-1)}}\]</span></p>
<p>If <span class="math inline">\(\lambda_{(t)}\)</span> converges to a
limit value <span class="math inline">\(\lambda^*\)</span>, then <span class="math inline">\(\lambda^*\)</span> is the estimator produced by EM
algorithm.</p>
<p>(3). Proof</p>
<p>If the estimator <span class="math inline">\(\lambda^*\)</span> is
also a fixed point, which means</p>
<p><span class="math display">\[\frac{n}{\lambda^*}=-\frac{\partial
l\left(\lambda;u,v\right)}{\partial\lambda}\bigg|_{\lambda=\lambda^*}+\frac{n}{\lambda^*}\]</span></p>
<p>then we have <span class="math display">\[\frac{\partial
l\left(\lambda;u,v\right)}{\partial\lambda}\bigg|_{\lambda=\lambda^*}=0\]</span>
Hence the MLE estimator by observed data likelihood function is also
<span class="math inline">\(\lambda^*\)</span>.</p>
<p>Now, the question comes to prove that Banachâs Fixed Point Theory
holds.</p>
<p>Note that</p>
<p><span class="math display">\[\begin{align}
\frac{n}{\lambda^*}&amp;=-\frac{\partial
l\left(\lambda;u,v\right)}{\partial\lambda}\bigg|_{\lambda=\lambda^*}+\frac{n}{\lambda^*}\\

&amp;=-\sum_{i=1}^{n}\frac{v_ie^{-\lambda^* v_i}-u_ie^{-\lambda^*
u_i}}{e^{-\lambda^* u_i}-e^{-\lambda^* v_i}}+\frac{n}{\lambda^*}\\
\end{align}\]</span></p>
<p>Denote <span class="math inline">\(1/\lambda^*\)</span> by <span class="math inline">\(k\)</span>, we have</p>
<p><span class="math display">\[
k=g(k)=\frac{1}{n}\sum_{i=1}^{n}\frac{u_ie^{- u_i/k}-v_ie^{-
v_i/k}}{e^{-u_i/k}-e^{-v_i/k}}+k
\]</span></p>
<p>If <span class="math inline">\(g(k)\)</span> is both self mapping and
contraction mapping, then Banachâs Fixed Point Theory holds.</p>
<p><strong>A. Self mapping</strong></p>
<p>By Cauchyâs Mean Value Theorem, we have</p>
<p><span class="math display">\[\begin{align}
\frac{ve^{-v/k}-ue^{-u/k}}{e^{-u/k}-e^{-v/k}}

=\frac{e^{-m/k}-m/ke^{-m/k}}{-e^{-m/k}/k}

=-k+m, \quad m\in[u,v]
\end{align}\]</span></p>
<p>hence</p>
<p><span class="math display">\[\begin{equation}
k=g(k)=\frac{1}{n}(-nk+\sum^n_{i=1}m_i)+k=\sum^n_{i=1}m_i/n=\bar{m} \in
[min\{u_i\}_{i=1,\dots,n},max\{v_i\}_{i=1,\dots,n}]\\
\end{equation}\]</span></p>
<p>PS: <span class="math inline">\(m_i\)</span> depends on <span class="math inline">\(\lambda\)</span> which means change of <span class="math inline">\(\lambda\)</span> will force <span class="math inline">\(m_i\)</span> to differ.</p>
<p>It shows that the codomain is the subset of domain <span class="math inline">\(k \in R^+\)</span>, so <span class="math inline">\(g(k)\)</span> is a self mapping.</p>
<p><strong>B. Contraction mapping</strong><span style="color:red">(There
might be a problem here)</span></p>
<p>For all <span class="math inline">\(k_1\)</span> and <span class="math inline">\(k_2\)</span> in domain, we need to prove that
there exists <span class="math inline">\(0\leq a&lt;1\)</span> such
that</p>
<p><span class="math display">\[|g(k_1)-g(k_2)|\leq
a|k_1-k_2|\]</span></p>
<p>By Lagrange mean value theorem, for all <span class="math inline">\(k_1\)</span> and <span class="math inline">\(k_2\)</span> in domain, <span class="math display">\[|g(k_1)-g(k_2)|=g&#39;(\eta)|k_1-k_2|,\quad
\eta\in[k_1,k_2]\]</span></p>
<p>If <span class="math inline">\(|g&#39;(k)|\leq a&lt;1\)</span>, then
<span class="math inline">\(g(k)\)</span> is contraction mapping.</p>
<p><span class="math display">\[\begin{equation}
g&#39;(k)= 1-\frac{1}{n}\sum^n_{i=1}\frac{e^{-(u+v)/k}
\left(\frac{u-v}{k}\right)^2}{(e^{-u/k}-e^{-v/k})^2}
\end{equation}\]</span></p>
<p>For any finite domain <span class="math inline">\(k\in
[k_1,k_2]\supset
[min\{u_i\}_{i=1,\dots,n},max\{v_i\}_{i=1,\dots,n}]\)</span>,</p>
<p>there exists a upper bound <span class="math inline">\(a\)</span>
that is less than 1 such that <span class="math inline">\(g&#39;(k)\leq
a&lt;1\)</span></p>
<p>Now we only need to prove that</p>
<p><span class="math display">\[
\frac{e^{-(u+v)/k}
\left(\frac{u-v}{k}\right)^2}{(e^{-u/k}-e^{-v/k})^2}&lt;=2-\varepsilon,\quad
0&lt;\varepsilon&lt;1
\]</span> <span class="math display">\[\begin{equation}
\frac{e^{-\left(u+v\right)/k}\left(\frac{u-v}{k}\right)^2}{\left(e^{-u/k}-e^{-v/k}\right)^2}=\frac{e^{-\left(u+v\right)/k}\left(\frac{u-v}{k}\right)^2}{e^{-2v/k}\left(e^{-\left(u+v\right)/k}-1\right)^2}=\frac{e^{-\left(u-v\right)/k}\left(\frac{u-v}{k}\right)^2}{\left(e^{-\left(u-v\right)/k}-1\right)^2}
\end{equation}\]</span></p>
<p>Denote <span class="math inline">\(x=-\frac{u-v}{k}&gt;0\)</span>,
then we need to prove <span class="math display">\[
f(x)=\frac{e^xx^2}{\left(e^x-1\right)^2}&lt;2
\]</span> Clearly, <span class="math inline">\(f(x)&gt;0\)</span>, <span class="math inline">\(\lim\limits_{x\to0^+}f(x)=1(x \sim
e^x-1)\)</span>, and <span class="math inline">\(\lim\limits_{x\to+\infty}f(x)=0\)</span></p>
<p>If we can prove that <span class="math inline">\(f(x)\)</span> is
monotonically decreasing, then the proof is complete.</p>
<p><span class="math display">\[\begin{align}
lnf(x)&amp;=x+2lnx+2ln(e^x-1)\\

(lnf(x))&#39;&amp;=\frac{f&#39;(x)}{f(x)}=1+\frac{2}{x}-2\frac{e^x}{e^x-1}\\
&amp;=-1+2\left(\frac{1}{x}-\frac{1}{e^x-1}\right)\\
&amp;=-1+2(\frac{e^x-1-x}{x(e^x-1)})\\
&amp;=-1+2\frac{x^2/2!+x^3/3!+Â·Â·Â·+x^n/n!+Â·Â·Â·}{x^2+x^3/2!+Â·Â·Â·+x^n/(n-1)!+Â·Â·Â·}
\end{align}\]</span></p>
<p>By sugar water inequality that</p>
<p>for any <span class="math inline">\(a&gt;0,b&gt;0,m&gt;0,n&gt;0\)</span>,</p>
<p><span class="math display">\[\begin{equation}
\text{if} \quad
\frac{n}{m}&lt;\frac{a}{b}\\
\text{then},\quad\frac{a+n}{b+m}&lt;\frac{a}{b}\\

\text{if} \quad
\frac{n}{m}&gt;\frac{a}{b}\\
\text{then},\quad\frac{a+n}{b+m}&gt;\frac{a}{b}
\end{equation}\]</span></p>
<p>Therefore,</p>
<p><span class="math display">\[\begin{equation}
\frac{x^2/2!+x^3/3!+Â·Â·Â·+x^n/n!+Â·Â·Â·}{x^2+x^3/2!+Â·Â·Â·+x^n/(n-1)!+Â·Â·Â·}&lt;\frac{x^2/2!}{x^2}=\frac{1}{2}\\

f&#39;(x)&lt;0
\end{equation}\]</span></p>
<p>Thus complete the proof.</p>
<p><strong>Solution 1.2.</strong></p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;*lower bound*</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;*upper bound*</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">9</span>,<span class="dv">28</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">1</span>,<span class="dv">24</span>,<span class="dv">11</span>,<span class="dv">25</span>,<span class="dv">3</span>)</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;*Observed data likelihood*</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>o.likelihood <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda){</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>((v<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v)<span class="sc">-</span>u<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v)))</span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a>solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(o.likelihood,<span class="at">interval =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>),<span class="at">extendInt =</span> <span class="st">&quot;yes&quot;</span>)</span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">unlist</span>(solution),<span class="dv">5</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a>MLE <span class="ot">&lt;-</span> k[<span class="dv">1</span>]</span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-21"><a href="#cb103-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;*EM algorithm*</span></span>
<span id="cb103-22"><a href="#cb103-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-23"><a href="#cb103-23" aria-hidden="true" tabindex="-1"></a>lambda.old <span class="ot">&lt;-</span> <span class="fl">0.0000000001</span></span>
<span id="cb103-24"><a href="#cb103-24" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb103-25"><a href="#cb103-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-26"><a href="#cb103-26" aria-hidden="true" tabindex="-1"></a>tol <span class="ot">&lt;-</span> .Machine<span class="sc">$</span>double.eps</span>
<span id="cb103-27"><a href="#cb103-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-28"><a href="#cb103-28" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits=</span><span class="dv">10</span>)</span>
<span id="cb103-29"><a href="#cb103-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb103-30"><a href="#cb103-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-31"><a href="#cb103-31" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="fu">length</span>(u)<span class="sc">/</span>(<span class="fu">sum</span>((u<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda.old<span class="sc">*</span>u)<span class="sc">-</span>v<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda.old<span class="sc">*</span>v))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda.old<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda.old<span class="sc">*</span>v)))<span class="sc">+</span><span class="fu">length</span>(u)<span class="sc">/</span>lambda.old)</span>
<span id="cb103-32"><a href="#cb103-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-33"><a href="#cb103-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> ((<span class="fu">abs</span>(lambda <span class="sc">-</span> lambda.old)<span class="sc">/</span>lambda.old) <span class="sc">&lt;</span> tol) <span class="cf">break</span></span>
<span id="cb103-34"><a href="#cb103-34" aria-hidden="true" tabindex="-1"></a>  lambda.old <span class="ot">&lt;-</span> lambda</span>
<span id="cb103-35"><a href="#cb103-35" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The MLE is 0.07198.</p>
<p>The EM estimator is 0.07197.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">gc</span>())</span></code></pre></div>
<hr />
</div>
<div id="exercises-2.1.3" class="section level3">
<h3>Exercises 2.1.3</h3>
<p><strong>Problem 4.</strong> Why do you need to use
<code>unlist()</code> to convert a list to an atomic vector? Why doesnât
<code>as.vector()</code> work?</p>
<p><strong>Solution 4.</strong> List and atomic vector are all vectors,
but list can contain different kind of elements. That is,
<font color="Blue">a list is already a vector</font>, so
<code>as.vector</code> wonât work to convert a list to an atomic
vector.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="fu">list</span>(<span class="dv">3</span>, <span class="dv">4</span>))</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(x)</span></code></pre></div>
<pre><code>## List of 2
##  $ : num [1:2] 1 2
##  $ :List of 2
##   ..$ : num 3
##   ..$ : num 4</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(<span class="fu">unlist</span>(x))</span></code></pre></div>
<pre><code>##  num [1:4] 1 2 3 4</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(<span class="fu">as.vector</span>(x))</span></code></pre></div>
<pre><code>## List of 2
##  $ : num [1:2] 1 2
##  $ :List of 2
##   ..$ : num 3
##   ..$ : num 4</code></pre>
<p><strong>Problem 5.</strong> Why is <code>1 == &quot;1&quot;</code> true? Why is
<code>-1 &lt; FALSE</code> true? Why is <code>&quot;one&quot; &lt; 2</code>
false?</p>
<p><strong>Solution 5.</strong> When comparing by operator-functions,
<font color="Blue">the comparison will coerce the arguments to a common
type</font>. According to the order</p>
<center>
logical &lt; integer &lt; double &lt; character,
</center>
<p>we will have</p>
<ul>
<li>In <code>1 == &quot;1&quot;</code>, <code>1</code> will be coerced to
<code>&quot;1&quot;</code>, so it is true.</li>
<li>In <code>-1 &lt; FALSE</code>, <code>FAlSE</code> will be coerced to
<code>0</code>, so it is true.</li>
<li>In <code>&quot;one&quot; &lt; 2</code>, <code>2</code> will be coerced to
<code>&quot;2&quot;</code>, so it is false because the ascii code of
<code>&quot;2&quot;</code> is 50, and <code>&quot;o&quot;</code> is 111.</li>
</ul>
<hr />
</div>
<div id="exercises-2.3.1" class="section level3">
<h3>Exercises 2.3.1</h3>
<p><strong>Problem 1.</strong> What does <code>dim()</code> return when
applied to a vector?</p>
<p><strong>Solution 1.</strong> It will return
<font color="Blue"><code>NULL</code></font>. Below are the examples.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)) <span class="co"># atomic vector</span></span></code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">list</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="fu">list</span>(<span class="dv">3</span>))) <span class="co"># list</span></span></code></pre></div>
<pre><code>## NULL</code></pre>
<p><strong>Problem 2.</strong> If <code>is.matrix(x)</code> is TRUE,
what will <code>is.array(x)</code> return?</p>
<p><strong>Solution 2.</strong> Matrix is a special case of array, which
has two dimensions. But array can be multi-dimensional. So if
<code>is.matrix(x)</code> is TRUE, <code>is.array(x)</code> will return
<font color="Blue">TRUE</font> also.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">is.matrix</span>(x), <span class="fu">is.array</span>(x))</span></code></pre></div>
<pre><code>## [1] TRUE TRUE</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>))</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">is.matrix</span>(y), <span class="fu">is.array</span>(y))</span></code></pre></div>
<pre><code>## [1] FALSE  TRUE</code></pre>
</div>
<div id="exercises-2.4.5" class="section level3">
<h3>Exercises 2.4.5</h3>
<p><strong>Problem 1.</strong> What attributes does a data frame
possess?</p>
<p><strong>Solution 1.</strong> By default, a data frame possess
<font color="Blue"><code>names</code>, <code>class</code>,
<code>row.names</code></font> attributes.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">V1 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">V2 =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>),</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">V3 =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>),</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&quot;X1&quot;</span>, <span class="st">&quot;X2&quot;</span>, <span class="st">&quot;X3&quot;</span>))</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>##    V1 V2    V3
## X1  1  a  TRUE
## X2  2  b FALSE
## X3  3  c FALSE</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(x)</span></code></pre></div>
<pre><code>## $names
## [1] &quot;V1&quot; &quot;V2&quot; &quot;V3&quot;
## 
## $class
## [1] &quot;data.frame&quot;
## 
## $row.names
## [1] &quot;X1&quot; &quot;X2&quot; &quot;X3&quot;</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(x)</span></code></pre></div>
<pre><code>## [1] 3 3</code></pre>
<p><strong>Problem 2.</strong> What does <code>as.matrix()</code> do
when applied to a data frame with columns of different types?</p>
<p><strong>Solution 2.</strong> It <font color="Blue">depends on the types
of columns</font>, following the coercion order</p>
<center>
logical &lt; integer &lt; double &lt; character.
</center>
<p>Below are the examples.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">V1 =</span> <span class="fu">c</span>(1L, 2L),</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">V2 =</span> <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>),</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">V3 =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>)</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(x)</span></code></pre></div>
<pre><code>##      V1  V2      V3 
## [1,] &quot;1&quot; &quot;FALSE&quot; &quot;a&quot;
## [2,] &quot;2&quot; &quot;TRUE&quot;  &quot;b&quot;</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">V1 =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">2.0</span>),</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">V2 =</span> <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>)</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(y)</span></code></pre></div>
<pre><code>##       V1 V2
## [1,] 1.5  0
## [2,] 2.0  1</code></pre>
<p><strong>Problem 3.</strong> Can you have a data frame with 0 rows?
What about 0 columns?</p>
<p><strong>Solution 3.</strong> <font color="Blue">Yes</font>, as long as
you donât give it anything.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0 rows</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">V1 =</span> <span class="fu">numeric</span>())</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">nrow</span>(x), <span class="fu">ncol</span>(x))</span></code></pre></div>
<pre><code>## [1] 0 1</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0 columns</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">row.names =</span> <span class="st">&quot;X1&quot;</span>)</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">nrow</span>(y), <span class="fu">ncol</span>(y))</span></code></pre></div>
<pre><code>## [1] 1 0</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0 rows, 0 columns</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">nrow</span>(z), <span class="fu">ncol</span>(z))</span></code></pre></div>
<pre><code>## [1] 0 0</code></pre>
<hr />
</div>
</div>
<div id="assignment-10" class="section level2">
<h2>Assignment 10</h2>
<hr />
<div id="exercises-2-on-page-204" class="section level3">
<h3>Exercises 2 on Page 204</h3>
<p><strong>Problem.</strong> The function below scales a vector so it
falls in the range <span class="math inline">\([0,1]\)</span>. How would
you apply it to every column of a data frame? How would you apply it to
every numeric column in a data frame?</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>  (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Solution.</strong> First, we generate a data frame.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>), <span class="at">x2 =</span> <span class="fu">rnorm</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>))</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(x)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    4 obs. of  2 variables:
##  $ x1: num  1.5 2.5 3.5 4.5
##  $ x2: num  0.178 5.081 4.58 4.797</code></pre>
<p>The first problem can be solved directly with
<code>lapply()</code>.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">lapply</span>(x, scale01))</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>res1</span></code></pre></div>
<pre><code>##             x1           x2
## 1 0.0000000000 0.0000000000
## 2 0.3333333333 1.0000000000
## 3 0.6666666667 0.8977617874
## 4 1.0000000000 0.9419177736</code></pre>
<p>If we want to apply it only to every numeric column in a data frame,
we can augment a condition in function while conducting
<code>lapply()</code>.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add a non-numeric column</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>x<span class="sc">$</span>x3 <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;A&quot;</span>, <span class="dv">2</span>), <span class="fu">rep</span>(<span class="st">&quot;B&quot;</span>, <span class="dv">2</span>))</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">lapply</span>(x, <span class="cf">function</span>(x) <span class="cf">if</span> (<span class="fu">is.numeric</span>(x)) <span class="fu">scale01</span>(x) <span class="cf">else</span> x))</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>res2</span></code></pre></div>
<pre><code>##             x1           x2 x3
## 1 0.0000000000 0.0000000000  A
## 2 0.3333333333 1.0000000000  A
## 3 0.6666666667 0.8977617874  B
## 4 1.0000000000 0.9419177736  B</code></pre>
<hr />
</div>
<div id="exercises-1-on-page-213" class="section level3">
<h3>Exercises 1 on Page 213</h3>
<p><strong>Problem.</strong> Use <code>vapply()</code> to:</p>
<ol style="list-style-type: lower-alpha">
<li>Compute the standard deviation of every column in a numeric data
frame.</li>
<li>Compute the standard deviation of every column in a mixed data
frame. (Hint: youâll nees to use <code>vapply()</code> twice.)</li>
</ol>
<p><strong>Solution.</strong> This problem is approximately the same to
the previous. First, we generate a numeric data frame.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">1.3</span>, <span class="fl">7.6</span>, <span class="fl">2.4</span>), <span class="at">x2 =</span> <span class="fu">rnorm</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(x)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    4 obs. of  2 variables:
##  $ x1: num  0.6 1.3 7.6 2.4
##  $ x2: num  2.1741 4.6511 0.0274 1.3113</code></pre>
<p>The first problem can be solved directly with
<code>vapply()</code>.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">vapply</span>(x, sd, <span class="dv">1</span>)</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>res1</span></code></pre></div>
<pre><code>##          x1          x2 
## 3.171093397 1.950835451</code></pre>
<p>While in a mixed data frame, we should add a condition.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add a non-numeric column</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>x<span class="sc">$</span>x3 <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;A&quot;</span>, <span class="dv">2</span>), <span class="fu">rep</span>(<span class="st">&quot;B&quot;</span>, <span class="dv">2</span>))</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">vapply</span>(x[<span class="fu">vapply</span>(x, is.numeric, <span class="cn">TRUE</span>)], sd, <span class="dv">1</span>)</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>res2</span></code></pre></div>
<pre><code>##          x1          x2 
## 3.171093397 1.950835451</code></pre>
<hr />
</div>
<div id="c-version-gibbs-sampler" class="section level3">
<h3>C++ Version Gibbs Sampler</h3>
<p><strong>Problem.</strong> Implement a Gibbs sampler to generate a
bivariate normal chain <span class="math inline">\((X_t, Y_t)\)</span>
with zero means, unit standard deviations, and correlation 0.9.</p>
<ul>
<li>Write an Rcpp function.</li>
<li>Compare the corresponding generated random numbers with pure R
language using the function <code>qqplot()</code>.</li>
<li>Compare the computation time of the two functions with the function
<code>microbenchmark()</code>.</li>
</ul>
<p><strong>Solution.</strong> To generate a bivariate normal chain <span class="math inline">\((X_t,Y_t)\)</span> from <span class="math inline">\(N(\mu_1,\mu_2,\sigma_1^2,\sigma_2^2,\rho)\)</span>,
we notice that <span class="math display">\[\begin{align*}
X\mid Y=y&amp;\sim
N\left(\mu_1+\rho\dfrac{\sigma_1}{\sigma_2}(y-\mu_2),(1-\rho^2)\sigma_1^2\right),\\
Y\mid X=x&amp;\sim
N\left(\mu_2+\rho\dfrac{\sigma_2}{\sigma_1}(x-\mu_1),(1-\rho^2)\sigma_2^2\right).
\end{align*}\]</span></p>
<p>So we implement the Gibbs sampler below.</p>
<ul>
<li>Set initial value <span class="math inline">\(X_1\)</span>, <span class="math inline">\(Y_1\)</span>.</li>
<li>Repeat for <span class="math inline">\(t=2,\dots,N\)</span>:
<ul>
<li>Generate <span class="math inline">\(X_t\sim f_{X|Y}(x\mid
Y_{t-1})\)</span>.</li>
<li>Generate <span class="math inline">\(Y_t\sim f_{Y|X}(y\mid
X_t)\)</span>.</li>
<li>Increment <span class="math inline">\(t\)</span>, and back to the
first step in the loop.</li>
</ul></li>
</ul>
<p>The function below generates <span class="math inline">\((X_t,Y_t)\)</span> with pure R language.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clear memory and set seed</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22034</span>)</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>gibbsR <span class="ot">&lt;-</span> <span class="cf">function</span>(mu, sigma, rho, initial, N) {</span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mu, sigma, rho: parameter of bivariate normal distribution.</span></span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># initial: initial value</span></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># N: length of chain</span></span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> Y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> rho<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> sigma</span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>] <span class="ot">&lt;-</span> initial[<span class="dv">1</span>]; Y[<span class="dv">1</span>] <span class="ot">&lt;-</span> initial[<span class="dv">2</span>]</span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb148-14"><a href="#cb148-14" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> Y[i<span class="dv">-1</span>]</span>
<span id="cb148-15"><a href="#cb148-15" aria-hidden="true" tabindex="-1"></a>    m1 <span class="ot">&lt;-</span> mu[<span class="dv">1</span>] <span class="sc">+</span> rho <span class="sc">*</span> (y <span class="sc">-</span> mu[<span class="dv">2</span>]) <span class="sc">*</span> sigma[<span class="dv">1</span>] <span class="sc">/</span> sigma[<span class="dv">2</span>]</span>
<span id="cb148-16"><a href="#cb148-16" aria-hidden="true" tabindex="-1"></a>    X[i] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s[<span class="dv">1</span>])</span>
<span id="cb148-17"><a href="#cb148-17" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> X[i]</span>
<span id="cb148-18"><a href="#cb148-18" aria-hidden="true" tabindex="-1"></a>    m2 <span class="ot">&lt;-</span> mu[<span class="dv">2</span>] <span class="sc">+</span> rho <span class="sc">*</span> (x <span class="sc">-</span> mu[<span class="dv">1</span>]) <span class="sc">*</span> sigma[<span class="dv">2</span>] <span class="sc">/</span> sigma[<span class="dv">1</span>]</span>
<span id="cb148-19"><a href="#cb148-19" aria-hidden="true" tabindex="-1"></a>    Y[i] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s[<span class="dv">2</span>])</span>
<span id="cb148-20"><a href="#cb148-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb148-21"><a href="#cb148-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">X =</span> X, <span class="at">Y =</span> Y))</span>
<span id="cb148-22"><a href="#cb148-22" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The function below is a Rcpp function (but saved in file
<code>gibbsC.cpp</code> in <code>src</code> folder actually).</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="pp"># include </span><span class="im">&lt;Rcpp.h&gt;</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>using namespace Rcpp<span class="op">;</span></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a><span class="co">// [[Rcpp::export]]</span></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>NumericMatrix gibbsC<span class="op">(</span>NumericVector mu<span class="op">,</span> NumericVector sigma<span class="op">,</span> <span class="dt">double</span> rho<span class="op">,</span></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>                     NumericVector initial<span class="op">,</span> <span class="dt">int</span> N<span class="op">)</span> <span class="op">{</span></span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">// mu, sigma, rho: parameter of bivariate normal distribution.</span></span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">// initial: initial value</span></span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">// N: length of chain</span></span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a>  NumericMatrix XY<span class="op">(</span>N<span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a>  <span class="dt">double</span> x<span class="op">,</span> y<span class="op">;</span></span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a>  XY<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">)</span> <span class="op">=</span> initial<span class="op">(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a>  XY<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">)</span> <span class="op">=</span> initial<span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> N<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> mat<span class="op">(</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb149-17"><a href="#cb149-17" aria-hidden="true" tabindex="-1"></a>    m1 <span class="op">=</span> mu<span class="op">(</span><span class="dv">0</span><span class="op">)</span> <span class="op">+</span> rho <span class="op">*</span> <span class="op">(</span>y <span class="op">-</span> mu<span class="op">(</span><span class="dv">1</span><span class="op">))</span> <span class="op">*</span> sigma<span class="op">(</span><span class="dv">0</span><span class="op">)</span> <span class="op">/</span> sigma<span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb149-18"><a href="#cb149-18" aria-hidden="true" tabindex="-1"></a>    mat<span class="op">(</span>i<span class="op">,</span> <span class="dv">0</span><span class="op">)</span> <span class="op">=</span> rnorm<span class="op">(</span><span class="dv">1</span><span class="op">,</span> m1<span class="op">,</span> sqrt<span class="op">(</span><span class="dv">1</span> <span class="op">-</span> rho<span class="op">^</span><span class="dv">2</span><span class="op">)</span> <span class="op">*</span> sigma<span class="op">(</span><span class="dv">0</span><span class="op">));</span></span>
<span id="cb149-19"><a href="#cb149-19" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> mat<span class="op">(</span>i<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb149-20"><a href="#cb149-20" aria-hidden="true" tabindex="-1"></a>    m2 <span class="op">=</span> mu<span class="op">(</span><span class="dv">1</span><span class="op">)</span> <span class="op">+</span> rho <span class="op">*</span> <span class="op">(</span>x <span class="op">-</span> mu<span class="op">(</span><span class="dv">0</span><span class="op">))</span> <span class="op">*</span> sigma<span class="op">(</span><span class="dv">1</span><span class="op">)</span> <span class="op">/</span> sigma<span class="op">(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb149-21"><a href="#cb149-21" aria-hidden="true" tabindex="-1"></a>    mat<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">)</span> <span class="op">=</span> rnorm<span class="op">(</span><span class="dv">1</span><span class="op">,</span> m2<span class="op">,</span> sqrt<span class="op">(</span><span class="dv">1</span> <span class="op">-</span> rho<span class="op">^</span><span class="dv">2</span><span class="op">)</span> <span class="op">*</span> sigma<span class="op">(</span><span class="dv">1</span><span class="op">));</span></span>
<span id="cb149-22"><a href="#cb149-22" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb149-23"><a href="#cb149-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span><span class="op">(</span>mat<span class="op">);</span></span>
<span id="cb149-24"><a href="#cb149-24" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Next, we generate the bivariate normal chain and compare them.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import package</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(StatComp22035)</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a><span class="co"># generate chains</span></span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a>XYR <span class="ot">&lt;-</span> <span class="fu">gibbsR</span>(mu, sigma, rho, mu, N)</span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a>XR <span class="ot">&lt;-</span> XYR<span class="sc">$</span>X[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)]; YR <span class="ot">&lt;-</span> XYR<span class="sc">$</span>Y[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)]</span>
<span id="cb150-13"><a href="#cb150-13" aria-hidden="true" tabindex="-1"></a>XYC <span class="ot">&lt;-</span> <span class="fu">gibbsC</span>(mu, sigma, rho, mu, N)</span>
<span id="cb150-14"><a href="#cb150-14" aria-hidden="true" tabindex="-1"></a>XC <span class="ot">&lt;-</span> XYC[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b), <span class="dv">1</span>]; YC <span class="ot">&lt;-</span> XYC[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b), <span class="dv">2</span>]</span>
<span id="cb150-15"><a href="#cb150-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-16"><a href="#cb150-16" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb150-17"><a href="#cb150-17" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(XR, XC, <span class="at">plot.it =</span> <span class="cn">TRUE</span>)</span>
<span id="cb150-18"><a href="#cb150-18" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb150-19"><a href="#cb150-19" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(YR, YC, <span class="at">plot.it =</span> <span class="cn">TRUE</span>)</span>
<span id="cb150-20"><a href="#cb150-20" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>With the qqplot, the results of two methods are approximately the
same. Besides, we can draw the scatter plot of each.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(XR, YR, <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(XC, YC, <span class="at">cex =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Next, we compare the computation time of the two functions.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import package</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">gibbsR =</span> <span class="fu">gibbsR</span>(mu, sigma, rho, mu, N),</span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">gibbsC =</span> <span class="fu">gibbsC</span>(mu, sigma, rho, mu, N))</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##     expr         lq     median         uq
## 1 gibbsR 37.9459500 38.5692015 39.3248005
## 2 gibbsC  3.7325005  3.8124005  3.8684515</code></pre>
<p>As we can see, the Rcpp function runs faster than pure R
language.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
